 Container cauth-container  Running
 Container sp-container  Running
[CO][INFO][CAuth-1_FAKE_CAUTH] Waiting for CAuth, SP, and HO to start...
[CO][INFO][CAuth-1_FAKE_CAUTH] 
=== Car Owner (CO) Starting ===
[CO][INFO][CAuth-1_FAKE_CAUTH] Found existing certificate, loading from keystore...
[CO][INFO][CAuth-1_FAKE_CAUTH] ...
[CO][INFO][CAuth-1_FAKE_CAUTH] 
╔═══════════════════════════════════════════╗
[CO][INFO][CAuth-1_FAKE_CAUTH] ║   CO CRYPTOGRAPHIC IDENTITY ESTABLISHED   ║
[CO][INFO][CAuth-1_FAKE_CAUTH] ╚═══════════════════════════════════════════╝
[CO][INFO][CAuth-1_FAKE_CAUTH] Subject: C=BE,O=Parking System,CN=CarOwner
[CO][INFO][CAuth-1_FAKE_CAUTH] Issuer: CN=172.20.0.10,O=Private Parking,C=BE
[CO][INFO][CAuth-1_FAKE_CAUTH] Valid from: Wed Dec 24 22:22:58 UTC 2025
[CO][INFO][CAuth-1_FAKE_CAUTH] Valid until: Thu Dec 24 22:23:58 UTC 2026
[CO][INFO][CAuth-1_FAKE_CAUTH] 
═══════════════════════════════════════════════════════════════
[CO][INFO][CAuth-1_FAKE_CAUTH]   [CAuth-1] NEGATIVE TEST MODE: FAKE_CAUTH
[CO][INFO][CAuth-1_FAKE_CAUTH] ═══════════════════════════════════════════════════════════════
[CO][INFO][CAuth-1_FAKE_CAUTH] [CAuth-1] Testing rejection of rogue intermediate CA certificate
[CO][INFO][CAuth-1_FAKE_CAUTH] [CAuth-1] Enrolled with: fake-cauth:8443
[CO][INFO][CAuth-1_FAKE_CAUTH] [CAuth-1] Certificate Details:
[CO][INFO][CAuth-1_FAKE_CAUTH]   Subject: C=BE, O=Parking System, CN=CarOwner
[CO][INFO][CAuth-1_FAKE_CAUTH]   Issuer:  CN=172.20.0.10, O=Private Parking, C=BE
[CO][INFO][CAuth-1_FAKE_CAUTH]   Serial:  299592398077867007541382707856640362155
[CO][INFO][CAuth-1_FAKE_CAUTH] [CAuth-1] NOTE: Issuer DN: CN=172.20.0.10,O=Private Parking,C=BE
[CO][INFO][CAuth-1_FAKE_CAUTH] 
[CAuth-1] Attempting mTLS connection to SP...
[CO][INFO][CAuth-1_FAKE_CAUTH] [CAuth-1] EXPECTED: Connection should FAIL with PKIX validation error
[CO][INFO][CAuth-1_FAKE_CAUTH] [CAuth-1] REASON: SP truststore only contains real Root CA, not rogue CA

[CO][INFO][CAuth-1_FAKE_CAUTH] Establishing hardened mTLS connection to SP for authenticated discovery...
[CO][INFO][CAuth-1_FAKE_CAUTH] ...
[CO][INFO][CAuth-1_FAKE_CAUTH]   Protocol: TLSv1.3
[CO][INFO][CAuth-1_FAKE_CAUTH]   Cipher suite: TLS_AES_256_GCM_SHA384
[CO][INFO][CAuth-1_FAKE_CAUTH]   SP certificate subject: C=BE,O=Parking System,CN=ServiceProvider
[CO][INFO][CAuth-1_FAKE_CAUTH]   SP certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
[CO][INFO][CAuth-1_FAKE_CAUTH] ...
[CO][INFO][CAuth-1_FAKE_CAUTH] 
→ Requesting parking availabilities from SP...
[CO][INFO][CAuth-1_FAKE_CAUTH] ← Received availability list from SP

[CO][INFO][CAuth-1_FAKE_CAUTH] ╔═══════════════════════════════════════════════════════════╗
[CO][INFO][CAuth-1_FAKE_CAUTH] ║   AUTHENTICATED AVAILABILITY DISCOVERY SUCCESSFUL         ║
[CO][INFO][CAuth-1_FAKE_CAUTH] ╚═══════════════════════════════════════════════════════════╝
[CO][INFO][CAuth-1_FAKE_CAUTH] Discovered 4 parking availability record(s)

[CO][INFO][CAuth-1_FAKE_CAUTH] ════════════════════════════════════════════════════════════
[CO][INFO][CAuth-1_FAKE_CAUTH] Availability #1
[CO][INFO][CAuth-1_FAKE_CAUTH] ════════════════════════════════════════════════════════════
[CO][INFO][CAuth-1_FAKE_CAUTH] Availability ID: 191001f5-0052-4ce1-ad30-d01579fb3c63
[CO][INFO][CAuth-1_FAKE_CAUTH] Spot ID: SPOT-A1
[CO][INFO][CAuth-1_FAKE_CAUTH] Price: 5 tokens
[CO][INFO][CAuth-1_FAKE_CAUTH] Valid: 2025-12-24T22:33:28.828315429Z to 2025-12-25T06:33:28.828315429Z
[CO][INFO][CAuth-1_FAKE_CAUTH] Location: Downtown-North
[CO][INFO][CAuth-1_FAKE_CAUTH] Home Owner ID: HO-001
[CO][INFO][CAuth-1_FAKE_CAUTH] 
[CO][INFO][CAuth-1_FAKE_CAUTH] ─ HO Certificate Identity Verification ─
[CO][INFO][CAuth-1_FAKE_CAUTH] ...
[CO][INFO][CAuth-1_FAKE_CAUTH]   Valid from: Wed Dec 24 22:22:43 UTC 2025
[CO][INFO][CAuth-1_FAKE_CAUTH]   Valid until: Thu Dec 24 22:23:43 UTC 2026
[CO][INFO][CAuth-1_FAKE_CAUTH] ...
[CO][INFO][CAuth-1_FAKE_CAUTH] ...
[CO][INFO][CAuth-1_FAKE_CAUTH] ✓ HO Identity (CN): HomeOwner
[CO][INFO][CAuth-1_FAKE_CAUTH]   Full Subject: CN=HomeOwner,O=Parking System,C=BE
[CO][INFO][CAuth-1_FAKE_CAUTH]   Issuer: CN=172.20.0.10,O=Private Parking,C=BE
[CO][INFO][CAuth-1_FAKE_CAUTH] ✓ Certificate fingerprint verified: 8349A96A416D8E51...
[CO][INFO][CAuth-1_FAKE_CAUTH] ✓ Identity binding persisted to ./keystore/ho_identity_bindings.txt
[CO][INFO][CAuth-1_FAKE_CAUTH] 
...
[CO][INFO][CAuth-1_FAKE_CAUTH]   Spot: SPOT-A1 ⟷ HO: HomeOwner
[CO][INFO][CAuth-1_FAKE_CAUTH]   Fingerprint: 8349A96A416D8E51B9B9AED4B9C2D2E6...
[CO][INFO][CAuth-1_FAKE_CAUTH] 
[CO][INFO][CAuth-1_FAKE_CAUTH] ...
[CO][INFO][CAuth-1_FAKE_CAUTH] ════════════════════════════════════════════════════════════
[CO][INFO][CAuth-1_FAKE_CAUTH] Availability #2
[CO][INFO][CAuth-1_FAKE_CAUTH] ════════════════════════════════════════════════════════════
[CO][INFO][CAuth-1_FAKE_CAUTH] Availability ID: 7bfbd12d-35c2-46ed-9c1e-982ae992c08e
[CO][INFO][CAuth-1_FAKE_CAUTH] Spot ID: SPOT-A1
[CO][INFO][CAuth-1_FAKE_CAUTH] Price: 5 tokens
[CO][INFO][CAuth-1_FAKE_CAUTH] Valid: 2025-12-24T22:33:47.917031188Z to 2025-12-25T06:33:47.917031188Z
[CO][INFO][CAuth-1_FAKE_CAUTH] Location: Downtown-North
[CO][INFO][CAuth-1_FAKE_CAUTH] Home Owner ID: HO-001
[CO][INFO][CAuth-1_FAKE_CAUTH] 
[CO][INFO][CAuth-1_FAKE_CAUTH] ─ HO Certificate Identity Verification ─
[CO][INFO][CAuth-1_FAKE_CAUTH] ...
[CO][INFO][CAuth-1_FAKE_CAUTH]   Valid from: Wed Dec 24 22:22:43 UTC 2025
[CO][INFO][CAuth-1_FAKE_CAUTH]   Valid until: Thu Dec 24 22:23:43 UTC 2026
[CO][INFO][CAuth-1_FAKE_CAUTH] ...
[CO][INFO][CAuth-1_FAKE_CAUTH] ...
[CO][INFO][CAuth-1_FAKE_CAUTH] ✓ HO Identity (CN): HomeOwner
[CO][INFO][CAuth-1_FAKE_CAUTH]   Full Subject: CN=HomeOwner,O=Parking System,C=BE
[CO][INFO][CAuth-1_FAKE_CAUTH]   Issuer: CN=172.20.0.10,O=Private Parking,C=BE
[CO][INFO][CAuth-1_FAKE_CAUTH] ✓ Certificate fingerprint verified: 8349A96A416D8E51...
[CO][INFO][CAuth-1_FAKE_CAUTH] ✓ Identity binding persisted to ./keystore/ho_identity_bindings.txt
[CO][INFO][CAuth-1_FAKE_CAUTH] 
...
[CO][INFO][CAuth-1_FAKE_CAUTH]   Spot: SPOT-A1 ⟷ HO: HomeOwner
[CO][INFO][CAuth-1_FAKE_CAUTH]   Fingerprint: 8349A96A416D8E51B9B9AED4B9C2D2E6...
[CO][INFO][CAuth-1_FAKE_CAUTH] 
[CO][INFO][CAuth-1_FAKE_CAUTH] ════════════════════════════════════════════════════════════
[CO][INFO][CAuth-1_FAKE_CAUTH] Availability #3
[CO][INFO][CAuth-1_FAKE_CAUTH] ════════════════════════════════════════════════════════════
[CO][INFO][CAuth-1_FAKE_CAUTH] Availability ID: 7b5bd83b-8265-4a98-a3ec-443517355fa2
[CO][INFO][CAuth-1_FAKE_CAUTH] Spot ID: SPOT-A1
[CO][INFO][CAuth-1_FAKE_CAUTH] Price: 5 tokens
[CO][INFO][CAuth-1_FAKE_CAUTH] Valid: 2025-12-24T22:34:06.518863155Z to 2025-12-25T06:34:06.518863155Z
[CO][INFO][CAuth-1_FAKE_CAUTH] Location: Downtown-North
[CO][INFO][CAuth-1_FAKE_CAUTH] Home Owner ID: HO-001
[CO][INFO][CAuth-1_FAKE_CAUTH] 
[CO][INFO][CAuth-1_FAKE_CAUTH] ─ HO Certificate Identity Verification ─
[CO][INFO][CAuth-1_FAKE_CAUTH] ...
[CO][INFO][CAuth-1_FAKE_CAUTH]   Valid from: Wed Dec 24 22:22:43 UTC 2025
[CO][INFO][CAuth-1_FAKE_CAUTH]   Valid until: Thu Dec 24 22:23:43 UTC 2026
[CO][INFO][CAuth-1_FAKE_CAUTH] ...
[CO][INFO][CAuth-1_FAKE_CAUTH] ...
[CO][INFO][CAuth-1_FAKE_CAUTH] ✓ HO Identity (CN): HomeOwner
[CO][INFO][CAuth-1_FAKE_CAUTH]   Full Subject: CN=HomeOwner,O=Parking System,C=BE
[CO][INFO][CAuth-1_FAKE_CAUTH]   Issuer: CN=172.20.0.10,O=Private Parking,C=BE
[CO][INFO][CAuth-1_FAKE_CAUTH] ✓ Certificate fingerprint verified: 8349A96A416D8E51...
[CO][INFO][CAuth-1_FAKE_CAUTH] ✓ Identity binding persisted to ./keystore/ho_identity_bindings.txt
[CO][INFO][CAuth-1_FAKE_CAUTH] 
...
[CO][INFO][CAuth-1_FAKE_CAUTH]   Spot: SPOT-A1 ⟷ HO: HomeOwner
[CO][INFO][CAuth-1_FAKE_CAUTH]   Fingerprint: 8349A96A416D8E51B9B9AED4B9C2D2E6...
[CO][INFO][CAuth-1_FAKE_CAUTH] 
[CO][INFO][CAuth-1_FAKE_CAUTH] ════════════════════════════════════════════════════════════
[CO][INFO][CAuth-1_FAKE_CAUTH] Availability #4
[CO][INFO][CAuth-1_FAKE_CAUTH] ════════════════════════════════════════════════════════════
[CO][INFO][CAuth-1_FAKE_CAUTH] Availability ID: 631f02f1-c3de-45e1-8356-4024642d5e2f
[CO][INFO][CAuth-1_FAKE_CAUTH] Spot ID: SPOT-A1
[CO][INFO][CAuth-1_FAKE_CAUTH] Price: 5 tokens
[CO][INFO][CAuth-1_FAKE_CAUTH] Valid: 2025-12-24T22:33:15.876009381Z to 2025-12-25T06:33:15.876009381Z
[CO][INFO][CAuth-1_FAKE_CAUTH] Location: Downtown-North
[CO][INFO][CAuth-1_FAKE_CAUTH] Home Owner ID: HO-001
[CO][INFO][CAuth-1_FAKE_CAUTH] 
[CO][INFO][CAuth-1_FAKE_CAUTH] ─ HO Certificate Identity Verification ─
[CO][INFO][CAuth-1_FAKE_CAUTH] ...
[CO][INFO][CAuth-1_FAKE_CAUTH]   Valid from: Wed Dec 24 22:22:43 UTC 2025
[CO][INFO][CAuth-1_FAKE_CAUTH]   Valid until: Thu Dec 24 22:23:43 UTC 2026
[CO][INFO][CAuth-1_FAKE_CAUTH] ...
[CO][INFO][CAuth-1_FAKE_CAUTH] ...
[CO][INFO][CAuth-1_FAKE_CAUTH] ✓ HO Identity (CN): HomeOwner
[CO][INFO][CAuth-1_FAKE_CAUTH]   Full Subject: CN=HomeOwner,O=Parking System,C=BE
[CO][INFO][CAuth-1_FAKE_CAUTH]   Issuer: CN=172.20.0.10,O=Private Parking,C=BE
[CO][INFO][CAuth-1_FAKE_CAUTH] ✓ Certificate fingerprint verified: 8349A96A416D8E51...
[CO][INFO][CAuth-1_FAKE_CAUTH] ✓ Identity binding persisted to ./keystore/ho_identity_bindings.txt
[CO][INFO][CAuth-1_FAKE_CAUTH] 
...
[CO][INFO][CAuth-1_FAKE_CAUTH]   Spot: SPOT-A1 ⟷ HO: HomeOwner
[CO][INFO][CAuth-1_FAKE_CAUTH]   Fingerprint: 8349A96A416D8E51B9B9AED4B9C2D2E6...
[CO][INFO][CAuth-1_FAKE_CAUTH] 
[CO][INFO][CAuth-1_FAKE_CAUTH] ════════════════════════════════════════════════════════════
[CO][INFO][CAuth-1_FAKE_CAUTH] ✓✓✓ AVAILABILITY DISCOVERY COMPLETE ✓✓...
[CO][INFO][CAuth-1_FAKE_CAUTH] ════════════════════════════════════════════════════════════
[CO][INFO][CAuth-1_FAKE_CAUTH] All HO identities verified and bound to availabilities
[CO][INFO][CAuth-1_FAKE_CAUTH] Identity bindings persisted for future interaction verification
[CO][ERR][CAuth-1_FAKE_CAUTH] 
╔═══════════════════════════════════════════════════════════════╗
[CO][ERR][CAuth-1_FAKE_CAUTH] ║ [CAuth-1] ✗ TEST FAILED: SP ACCEPTED UNTRUSTED CERTIFICATE!  ║
[CO][ERR][CAuth-1_FAKE_CAUTH] ╚═══════════════════════════════════════════════════════════════╝
[CO][ERR][CAuth-1_FAKE_CAUTH] [CAuth-1] CRITICAL SECURITY FAILURE:
[CO][ERR][CAuth-1_FAKE_CAUTH] [CAuth-1] SP should have rejected the rogue CA certificate!
[CO][ERR][CAuth-1_FAKE_CAUTH] [CAuth-1] The certificate chain does NOT terminate at Root CA.
[CO][ERR][CAuth-1_FAKE_CAUTH] [CAuth-1] This indicates a trust validation bypass vulnerability!


