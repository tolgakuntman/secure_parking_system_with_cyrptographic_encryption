sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  5E1C09951680F9EA76109D48D18E5A33
sp-container  | [SP]   SHA-256: 7AAF33BEAD7E3C114B2D2482AC52BD2C...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: HomeOwner
sp-container  | Client address: /172.20.0.12:39944
sp-container  | Client certificate subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 5E1C09951680F9EA76109D48D18E5A33
sp-container  | Certificate valid from: Fri Dec 26 10:12:15 UTC 2025
sp-container  | Certificate valid until: Sat Dec 26 10:13:15 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: D7BA869EFA39C72C...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from HomeOwner: {
sp-container  |   "priceTokens": 5,
sp-container  |   "metadata": {
sp-container  |     "spotType": "residential",
sp-container  |     "autoRenewal": false,
sp-container  |     "maxDuration": "8h"
sp-container  |   },
sp-container  |   "method": "publishAvailability",
sp-container  |   "spotId": "SPOT-A1",
sp-container  |   "locationZone": "Downtown-North",
sp-container  |   "homeOwnerId": "HO-001",
sp-container  |   "validFrom": "2025-12-26T10:13:58.463721521Z",
sp-container  |   "validTo": "2025-12-26T18:13:58.463721521Z"
sp-container  | }
sp-container  | 
sp-container  | === Publishing Parking Availability from HomeOwner ===
sp-container  |   Home Owner: HO-001
sp-container  |   Spot ID: SPOT-A1
sp-container  |   Valid: 2025-12-26T10:13:58.463721521Z to 2025-12-26T18:13:58.463721521Z
sp-container  |   Price: 5 tokens
sp-container  |   Location: Downtown-North
sp-container  | ✓ Availability stored with ID: 4bf837a3-e218-4557-87e9-da4416697723
sp-container  | ✓ Total availabilities in system: 3
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "publishedAt": "2025-12-26T10:13:58.479981646Z",
sp-container  |   "availabilityId": "4bf837a3-e218-4557-87e9-da4416697723",
sp-container  |   "spotId": "SPOT-A1",
sp-container  |   "message": "Parking availability published successfully",
sp-container  |   "status": "success"
sp-container  | }
sp-container  | 
sp-container  | HomeOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  E4DB9AF26D5A82F6014787DB530F67F9
sp-container  | [SP]   SHA-256: F65DFBBA109A9D7E80312454928B1A61...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: CarOwner
sp-container  | Client address: /172.20.0.13:46958
sp-container  | Client certificate subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: E4DB9AF26D5A82F6014787DB530F67F9
sp-container  | Certificate valid from: Fri Dec 26 10:12:19 UTC 2025
sp-container  | Certificate valid until: Sat Dec 26 10:13:19 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: E423B914172C964C...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from CarOwner: {"method": "getAvailability"}
sp-container  | 
sp-container  | === Availability Discovery Request from CarOwner ===
sp-container  |   Total availabilities in system: 3
sp-container  |   [65cb0872-654f-4702-947d-d902d6d0e59d] SPOT-A1 - 5 tokens (HO: HomeOwner)
sp-container  |   [4bf837a3-e218-4557-87e9-da4416697723] SPOT-A1 - 5 tokens (HO: HomeOwner)
sp-container  |   [1b242401-a9a4-43b2-af48-0646a64b7650] SPOT-A1 - 5 tokens (HO: HomeOwner)
sp-container  | ✓ Returned 3 availability record(s) to CarOwner
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "availabilities": [
sp-container  |     {
sp-container  |       "priceTokens": 5,
sp-container  |       "hoIdentity": "HomeOwner",
sp-container  |       "hoCertFingerprint": "7AAF33BEAD7E3C114B2D2482AC52BD2CA680453BD5334DDE8F01FB11261CA907",
sp-container  |       "availabilityId": "65cb0872-654f-4702-947d-d902d6d0e59d",
sp-container  |       "spotId": "SPOT-A1",
sp-container  |       "locationZone": "Downtown-North",
sp-container  |       "homeOwnerId": "HO-001",
sp-container  |       "hoCertificate": "-----BEGIN CERTIFICATE-----\nMIIEgDCCAmigAwIBAgIQXhwJlRaA+ep2EJ1I0Y5aMzANBgkqhkiG9w0BAQsFADA9\nMQswCQYDVQQGEwJCRTEYMBYGA1UEChMPUHJpdmF0ZSBQYXJraW5nMRQwEgYDVQQD\nEwsxNzIuMjAuMC4xMDAeFw0yNTEyMjYxMDEyMTVaFw0yNjEyMjYxMDEzMTVaMDox\nCzAJBgNVBAYTAkJFMRcwFQYDVQQKDA5QYXJraW5nIFN5c3RlbTESMBAGA1UEAwwJ\nSG9tZU93bmVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAt1poDyRy\nizvtpasiTP1ZBzpNXYSVwM6PEXc+RqhcMRtouq0ewwuGm4d5g+j3Vlng2RlROUf2\neIBEe6nRu2nL5ZwKFQsNDhNDDVAYkXxt+bp9WLlzlcIP0U3b+zHVPVaOPJhyKPLs\nEfwCNc+5+ZkITUeSnxEovCiRUUcVWz4vIaeB/aZkUjPWbcSe1z6tZ9c4n7y65kMA\nyaEbyvgU81o84FU9l3Y3O24LiFAKQ8tMYKGaZA1Hue5uVDwVBTwOh1E/pMbSmkl6\nUZW3x8ZL3CJybM0ldgXq9pjEK0B9qEk4hSurjp3nYSQ4h35blme39yzIN3PNTeaG\nZpm+GC5GCgol3QIDAQABo38wfTAMBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIF\noDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwHQYDVR0OBBYEFHYmtwC7\nVp5huRs6Qz0go1/LUWqOMB8GA1UdIwQYMBaAFMkcn65FDxCLoejj3tyrE1Khh6KK\nMA0GCSqGSIb3DQEBCwUAA4ICAQBV9F/EatyzuPhlLn1tXRttWy09R3Eg3ThLhWGJ\nU2vWXegUNQUPOiDGIGoD5VXr7tuAL3RNw7DlXEk9RC6l5F1mUDBdTAt2Act6R6jh\nvs/NDfz/I2jbQ76r9Y5VAsj6GZQK9osnowf6YyOmn+Phe0zkfru81klKATvkJUCo\nsnltgHvNb3Mn6I669Yijch600sA7riToBldoqCP48kxyMRCLVQYzDAjOgN/wTqfE\nsPRyOOfTtlteJw9VXKnegj6cA9hF1XZfq6dQZ1itMa1R4LHbb/g4EKidfa0PtWZX\nnrvA2jLt1zovGn+aPtAOKb09kNRYm95qZozANV50Fl7ag1YVraSmD0PgWcijaBVX\nRzRxFGrRPUl/TjZPbHJRz8fuFiQz1MEWJvt3THVtpvNQhuqyw+DMsTP/bLxmBnnl\nl0pGteC/B2LYBvnIyevD9FDPRRwqODzk7+bzU9jXVFJnSU+jW3F9J3CkeXmQBARp\nXskuWtItwU3QTnUfzyUSDq7R2J6tNsrZ/xEcecOZAWYU0DyKiSCnvp35V5/hDK8R\n7BmoMFEpEjijvssJasyylxLBV1qbL4CD4pBeFY6eROB6K2hrRAQYHfvIoQybTlBj\n8rE7XmyIoFOgd+f4wzyxFddzWg6SWE6/+x0nm83aax5ZY+X7MUdYo575ec/vMQKe\n6cKIBg==\n-----END CERTIFICATE-----\n",
sp-container  |       "validFrom": "2025-12-26T10:13:15.281856542Z",
sp-container  |       "validTo": "2025-12-26T18:13:15.281856542Z"
sp-container  |     },
sp-container  |     {
sp-container  |       "priceTokens": 5,
sp-container  |       "hoIdentity": "HomeOwner",
sp-container  |       "hoCertFingerprint": "7AAF33BEAD7E3C114B2D2482AC52BD2CA680453BD5334DDE8F01FB11261CA907",
sp-container  |       "availabilityId": "4bf837a3-e218-4557-87e9-da4416697723",
sp-container  |       "spotId": "SPOT-A1",
sp-container  |       "locationZone": "Downtown-North",
sp-container  |       "homeOwnerId": "HO-001",
sp-container  |       "hoCertificate": "-----BEGIN CERTIFICATE-----\nMIIEgDCCAmigAwIBAgIQXhwJlRaA+ep2EJ1I0Y5aMzANBgkqhkiG9w0BAQsFADA9\nMQswCQYDVQQGEwJCRTEYMBYGA1UEChMPUHJpdmF0ZSBQYXJraW5nMRQwEgYDVQQD\nEwsxNzIuMjAuMC4xMDAeFw0yNTEyMjYxMDEyMTVaFw0yNjEyMjYxMDEzMTVaMDox\nCzAJBgNVBAYTAkJFMRcwFQYDVQQKDA5QYXJraW5nIFN5c3RlbTESMBAGA1UEAwwJ\nSG9tZU93bmVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAt1poDyRy\nizvtpasiTP1ZBzpNXYSVwM6PEXc+RqhcMRtouq0ewwuGm4d5g+j3Vlng2RlROUf2\neIBEe6nRu2nL5ZwKFQsNDhNDDVAYkXxt+bp9WLlzlcIP0U3b+zHVPVaOPJhyKPLs\nEfwCNc+5+ZkITUeSnxEovCiRUUcVWz4vIaeB/aZkUjPWbcSe1z6tZ9c4n7y65kMA\nyaEbyvgU81o84FU9l3Y3O24LiFAKQ8tMYKGaZA1Hue5uVDwVBTwOh1E/pMbSmkl6\nUZW3x8ZL3CJybM0ldgXq9pjEK0B9qEk4hSurjp3nYSQ4h35blme39yzIN3PNTeaG\nZpm+GC5GCgol3QIDAQABo38wfTAMBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIF\noDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwHQYDVR0OBBYEFHYmtwC7\nVp5huRs6Qz0go1/LUWqOMB8GA1UdIwQYMBaAFMkcn65FDxCLoejj3tyrE1Khh6KK\nMA0GCSqGSIb3DQEBCwUAA4ICAQBV9F/EatyzuPhlLn1tXRttWy09R3Eg3ThLhWGJ\nU2vWXegUNQUPOiDGIGoD5VXr7tuAL3RNw7DlXEk9RC6l5F1mUDBdTAt2Act6R6jh\nvs/NDfz/I2jbQ76r9Y5VAsj6GZQK9osnowf6YyOmn+Phe0zkfru81klKATvkJUCo\nsnltgHvNb3Mn6I669Yijch600sA7riToBldoqCP48kxyMRCLVQYzDAjOgN/wTqfE\nsPRyOOfTtlteJw9VXKnegj6cA9hF1XZfq6dQZ1itMa1R4LHbb/g4EKidfa0PtWZX\nnrvA2jLt1zovGn+aPtAOKb09kNRYm95qZozANV50Fl7ag1YVraSmD0PgWcijaBVX\nRzRxFGrRPUl/TjZPbHJRz8fuFiQz1MEWJvt3THVtpvNQhuqyw+DMsTP/bLxmBnnl\nl0pGteC/B2LYBvnIyevD9FDPRRwqODzk7+bzU9jXVFJnSU+jW3F9J3CkeXmQBARp\nXskuWtItwU3QTnUfzyUSDq7R2J6tNsrZ/xEcecOZAWYU0DyKiSCnvp35V5/hDK8R\n7BmoMFEpEjijvssJasyylxLBV1qbL4CD4pBeFY6eROB6K2hrRAQYHfvIoQybTlBj\n8rE7XmyIoFOgd+f4wzyxFddzWg6SWE6/+x0nm83aax5ZY+X7MUdYo575ec/vMQKe\n6cKIBg==\n-----END CERTIFICATE-----\n",
sp-container  |       "validFrom": "2025-12-26T10:13:58.463721521Z",
sp-container  |       "validTo": "2025-12-26T18:13:58.463721521Z"
sp-container  |     },
sp-container  |     {
sp-container  |       "priceTokens": 5,
sp-container  |       "hoIdentity": "HomeOwner",
sp-container  |       "hoCertFingerprint": "7AAF33BEAD7E3C114B2D2482AC52BD2CA680453BD5334DDE8F01FB11261CA907",
sp-container  |       "availabilityId": "1b242401-a9a4-43b2-af48-0646a64b7650",
sp-container  |       "spotId": "SPOT-A1",
sp-container  |       "locationZone": "Downtown-North",
sp-container  |       "homeOwnerId": "HO-001",
sp-container  |       "hoCertificate": "-----BEGIN CERTIFICATE-----\nMIIEgDCCAmigAwIBAgIQXhwJlRaA+ep2EJ1I0Y5aMzANBgkqhkiG9w0BAQsFADA9\nMQswCQYDVQQGEwJCRTEYMBYGA1UEChMPUHJpdmF0ZSBQYXJraW5nMRQwEgYDVQQD\nEwsxNzIuMjAuMC4xMDAeFw0yNTEyMjYxMDEyMTVaFw0yNjEyMjYxMDEzMTVaMDox\nCzAJBgNVBAYTAkJFMRcwFQYDVQQKDA5QYXJraW5nIFN5c3RlbTESMBAGA1UEAwwJ\nSG9tZU93bmVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAt1poDyRy\nizvtpasiTP1ZBzpNXYSVwM6PEXc+RqhcMRtouq0ewwuGm4d5g+j3Vlng2RlROUf2\neIBEe6nRu2nL5ZwKFQsNDhNDDVAYkXxt+bp9WLlzlcIP0U3b+zHVPVaOPJhyKPLs\nEfwCNc+5+ZkITUeSnxEovCiRUUcVWz4vIaeB/aZkUjPWbcSe1z6tZ9c4n7y65kMA\nyaEbyvgU81o84FU9l3Y3O24LiFAKQ8tMYKGaZA1Hue5uVDwVBTwOh1E/pMbSmkl6\nUZW3x8ZL3CJybM0ldgXq9pjEK0B9qEk4hSurjp3nYSQ4h35blme39yzIN3PNTeaG\nZpm+GC5GCgol3QIDAQABo38wfTAMBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIF\noDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwHQYDVR0OBBYEFHYmtwC7\nVp5huRs6Qz0go1/LUWqOMB8GA1UdIwQYMBaAFMkcn65FDxCLoejj3tyrE1Khh6KK\nMA0GCSqGSIb3DQEBCwUAA4ICAQBV9F/EatyzuPhlLn1tXRttWy09R3Eg3ThLhWGJ\nU2vWXegUNQUPOiDGIGoD5VXr7tuAL3RNw7DlXEk9RC6l5F1mUDBdTAt2Act6R6jh\nvs/NDfz/I2jbQ76r9Y5VAsj6GZQK9osnowf6YyOmn+Phe0zkfru81klKATvkJUCo\nsnltgHvNb3Mn6I669Yijch600sA7riToBldoqCP48kxyMRCLVQYzDAjOgN/wTqfE\nsPRyOOfTtlteJw9VXKnegj6cA9hF1XZfq6dQZ1itMa1R4LHbb/g4EKidfa0PtWZX\nnrvA2jLt1zovGn+aPtAOKb09kNRYm95qZozANV50Fl7ag1YVraSmD0PgWcijaBVX\nRzRxFGrRPUl/TjZPbHJRz8fuFiQz1MEWJvt3THVtpvNQhuqyw+DMsTP/bLxmBnnl\nl0pGteC/B2LYBvnIyevD9FDPRRwqODzk7+bzU9jXVFJnSU+jW3F9J3CkeXmQBARp\nXskuWtItwU3QTnUfzyUSDq7R2J6tNsrZ/xEcecOZAWYU0DyKiSCnvp35V5/hDK8R\n7BmoMFEpEjijvssJasyylxLBV1qbL4CD4pBeFY6eROB6K2hrRAQYHfvIoQybTlBj\n8rE7XmyIoFOgd+f4wzyxFddzWg6SWE6/+x0nm83aax5ZY+X7MUdYo575ec/vMQKe\n6cKIBg==\n-----END CERTIFICATE-----\n",
sp-container  |       "validFrom": "2025-12-26T10:13:43.162952764Z",
sp-container  |       "validTo": "2025-12-26T18:13:43.162952764Z"
sp-container  |     }
sp-container  |   ],
sp-container  |   "count": 3,
sp-container  |   "status": "success",
sp-container  |   "timestamp": "2025-12-26T10:14:02.709192398Z"
sp-container  | }
sp-container  | 
sp-container  | CarOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  E4DB9AF26D5A82F6014787DB530F67F9
sp-container  | [SP]   SHA-256: F65DFBBA109A9D7E80312454928B1A61...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: CarOwner
sp-container  | Client address: /172.20.0.13:46964
sp-container  | Client certificate subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: E4DB9AF26D5A82F6014787DB530F67F9
sp-container  | Certificate valid from: Fri Dec 26 10:12:19 UTC 2025
sp-container  | Certificate valid until: Sat Dec 26 10:13:19 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: B7E60EBB59A3406B...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from CarOwner: {
sp-container  |   "method": "requestTokens",
sp-container  |   "count": 5
sp-container  | }
sp-container  | 
sp-container  | === Generating 5 payment tokens for CarOwner ===
sp-container  | ✓ Generated secret s (32 bytes)
sp-container  | ✓ Generated hash chain of length 5
sp-container  |   Root H^5(s): B70AA174800272A8...
sp-container  | ✓ Signed root with SP private key (256 bytes)
sp-container  | ✓ Stored chain metadata (ID: f98a95c0-7ace-4135-a5b6-1c9bd2b0c1dd)
sp-container  | ✓ Token batch ready to send to CarOwner
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "tokenHashAlg": "SHA-256",
sp-container  |   "signatureAlg": "SHA256withRSA",
sp-container  |   "chainId": "f98a95c0-7ace-4135-a5b6-1c9bd2b0c1dd",
sp-container  |   "rootSignature": "QR/pattvC8fNMIPn5xsTnQbLzv//+Yk4sYMYbS9scuKkETi5ryZVlF7WF5WIpQNk3vVOqDRCo/K+ldxT941kCG4jrdlICqoKO8uUprMumFggz1DzBaY3FhtSY5FyphE3cjqFh3Bn3eH3ZhCJXwxJtfyJtIxpyhZKRmuRMV9YBdxiPY1xha6rtkVae82up7nhIYJFNj/h1cNCJlAV4+4PS7W5cdngDPPJibmDJmnqY8tOeUGp5Kh6UO/FA2nFCsJSsAMPxJVcWAUELW3aMaRGMyj/4slXjg+FiF6Dvw69GobjgtQodd0Ga1onPwg/zQZ9u+l1ADNlExrLHA1Dt9ddbA==",
sp-container  |   "root": "twqhdIACcqiOJuBkC29Ro3wbzMp8tv8El8sb8SX9f1Y=",
sp-container  |   "x": 5,
sp-container  |   "tokens": [
sp-container  |     "g8XfRLU721YzaT4JsmsmY1Q7t6JmaxVE6z9304iiF0c=",
sp-container  |     "Xqb2I78ZjgRlAt+OZYjQTEMOrxTBBUpdXM+YKmq0mio=",
sp-container  |     "t66CxuewBJT8qqbbGiwZCdtdfQuZY37/Xbu+tjKDFb4=",
sp-container  |     "jg+blP90aMwr6XhykVvitpmZ6iHMSnjjO0EV6HDFDic=",
sp-container  |     "twqhdIACcqiOJuBkC29Ro3wbzMp8tv8El8sb8SX9f1Y="
sp-container  |   ],
sp-container  |   "status": "success"
sp-container  | }
sp-container  | 
sp-container  | CarOwner disconnected
