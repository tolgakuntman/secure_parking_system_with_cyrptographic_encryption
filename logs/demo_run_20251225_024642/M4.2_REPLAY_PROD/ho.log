ho-container  | 23:49:01 [HO][INFO] Waiting for CAuth and SP to start...
ho-container  | 23:49:09 [HO][INFO] HO starting - initializing crypto
ho-container  | 23:49:10 [HO][AUDIT] Identity established: HomeOwner Serial=45D11FC5...
ho-container  | 23:49:10 [HO][INFO] Publishing parking availability to SP
ho-container  | 23:49:10 [HO][INFO] Publishing availability: spot=SPOT-A1 price=5 tokens
ho-container  | 23:49:10 [HO][AUDIT] Availability published: 32acda5e...
ho-container  | 23:49:10 [HO][INFO] Starting HO Reservation & Payment Server on port 8445
ho-container  | 23:49:10 [HO][INFO] Reservation server ready on :8445 TLS=TLSv1.3,TLSv1.2
ho-container  | 23:49:10 [HO][AUDIT] mTLS enforcement=REQUIRED for CO
ho-container  | 23:49:20 [HO][AUDIT] mTLS peer CN=CarOwner fp=CCAAFC5A37A94C14 tls=TLSv1.3 suite=TLS_AES_256_GCM_SHA384
ho-container  | 23:49:20 [HO][INFO] Reservation: avail=32acda5e... spot=SPOT-A1 price=5
ho-container  | 23:49:20 [HO][AUDIT] RESERVATION OK resv=89caa62c... co=CarOwner
ho-container  | 23:49:20 [HO][INFO] Sent reservation response to CarOwner
ho-container  | 23:49:20 [HO][AUDIT] mTLS peer CN=CarOwner fp=CCAAFC5A37A94C14 tls=TLSv1.3 suite=TLS_AES_256_GCM_SHA384
ho-container  | 23:49:20 [HO][INFO] Payment: chain=2ca97447... resv=89caa62c... tokens=5
ho-container  | 23:49:20 [HO][INFO] Payment verified: chain=2ca97447... tokens=5 start=0
ho-container  | 23:49:20 [HO][INFO] Settlement request: chain=2ca97447... y=5 newLastIdx=5
ho-container  | 23:49:20 [HO][AUDIT] SP SETTLEMENT ACCEPTED chain=2ca97447...
ho-container  | 23:49:20 [HO][INFO] Verifying SP payment receipt
ho-container  | 23:49:20 [HO][AUDIT] RECEIPT VERIFIED id=e92cac2f...
ho-container  | 23:49:20 [HO][AUDIT] PAYMENT ACCEPTED chain=2ca97447... lastIdx=4
ho-container  | 23:49:20 [HO][INFO] Sent pay response to CarOwner
ho-container  | 23:49:21 [HO][AUDIT] mTLS peer CN=CarOwner fp=CCAAFC5A37A94C14 tls=TLSv1.3 suite=TLS_AES_256_GCM_SHA384
ho-container  | 23:49:21 [HO][INFO] Payment: chain=2ca97447... resv=89caa62c... tokens=5
ho-container  | 23:49:21 [HO][SEC_ERR] Payment security failure: Double-spend detected: startIndex=0 <= lastSpentIndex=4
ho-container  | 23:49:21 [HO][INFO] Sent pay response to CarOwner
ho-container  | 23:49:23 [HO][INFO] NEGATIVE TEST: Attempting double-spend replay
ho-container  | 23:49:23 [HO][INFO] Settlement request: chain=2ca97447... y=5 newLastIdx=5
ho-container  | 23:49:24 [HO][SEC_ERR] SP SETTLEMENT REJECTED: double_spend - DOUBLE_SPEND_DETECTED: attempting to reuse already-spent tokens
ho-container  | 23:49:24 [HO][AUDIT] SECURITY SUCCESS: SP rejected double-spend
ho-container  | 23:49:24 [HO][SEC_ERR] DOUBLE_SPEND detected by SP: currentIdx=5 rejectedIdx=5
