sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  684582B0E8773D4DCAF598AC0FE74E80
sp-container  | [SP]   SHA-256: B229A59688B10B7CABBC6BE54D3EB7B5...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: HomeOwner
sp-container  | Client address: /172.20.0.12:58968
sp-container  | Client certificate subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 684582B0E8773D4DCAF598AC0FE74E80
sp-container  | Certificate valid from: Thu Dec 25 23:01:16 UTC 2025
sp-container  | Certificate valid until: Fri Dec 25 23:02:16 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: 49ACDC5891C820F7...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from HomeOwner: {
sp-container  |   "priceTokens": 5,
sp-container  |   "metadata": {
sp-container  |     "spotType": "residential",
sp-container  |     "autoRenewal": false,
sp-container  |     "maxDuration": "8h"
sp-container  |   },
sp-container  |   "method": "publishAvailability",
sp-container  |   "spotId": "SPOT-A1",
sp-container  |   "locationZone": "Downtown-North",
sp-container  |   "homeOwnerId": "HO-001",
sp-container  |   "validFrom": "2025-12-25T23:03:14.580187807Z",
sp-container  |   "validTo": "2025-12-26T07:03:14.580187807Z"
sp-container  | }
sp-container  | 
sp-container  | === Publishing Parking Availability from HomeOwner ===
sp-container  |   Home Owner: HO-001
sp-container  |   Spot ID: SPOT-A1
sp-container  |   Valid: 2025-12-25T23:03:14.580187807Z to 2025-12-26T07:03:14.580187807Z
sp-container  |   Price: 5 tokens
sp-container  |   Location: Downtown-North
sp-container  | ✓ Availability stored with ID: ebd07e23-aee1-451a-bf79-ab88cf89b2ab
sp-container  | ✓ Total availabilities in system: 3
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "publishedAt": "2025-12-25T23:03:14.604172046Z",
sp-container  |   "availabilityId": "ebd07e23-aee1-451a-bf79-ab88cf89b2ab",
sp-container  |   "spotId": "SPOT-A1",
sp-container  |   "message": "Parking availability published successfully",
sp-container  |   "status": "success"
sp-container  | }
sp-container  | 
sp-container  | HomeOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  362E632A2925EB78FAD22FC30B34187A
sp-container  | [SP]   SHA-256: 7E5EBCCE3FFA616A8F400F899EDB52C4...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: CarOwner
sp-container  | Client address: /172.20.0.13:35942
sp-container  | Client certificate subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 362E632A2925EB78FAD22FC30B34187A
sp-container  | Certificate valid from: Thu Dec 25 23:01:22 UTC 2025
sp-container  | Certificate valid until: Fri Dec 25 23:02:22 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: 948E22F142AC5E61...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from CarOwner: {"method": "getAvailability"}
sp-container  | 
sp-container  | === Availability Discovery Request from CarOwner ===
sp-container  |   Total availabilities in system: 3
sp-container  |   [ebd07e23-aee1-451a-bf79-ab88cf89b2ab] SPOT-A1 - 5 tokens (HO: HomeOwner)
sp-container  |   [49f048b8-6297-4bbe-bebf-f5f8d9e868e5] SPOT-A1 - 5 tokens (HO: HomeOwner)
sp-container  |   [340f449d-d405-49ec-b2e4-9606f78a2a69] SPOT-A1 - 5 tokens (HO: HomeOwner)
sp-container  | ✓ Returned 3 availability record(s) to CarOwner
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "availabilities": [
sp-container  |     {
sp-container  |       "priceTokens": 5,
sp-container  |       "hoIdentity": "HomeOwner",
sp-container  |       "hoCertFingerprint": "B229A59688B10B7CABBC6BE54D3EB7B55D4377AC6AD0CA8131AC5E4E1D489A6D",
sp-container  |       "availabilityId": "ebd07e23-aee1-451a-bf79-ab88cf89b2ab",
sp-container  |       "spotId": "SPOT-A1",
sp-container  |       "locationZone": "Downtown-North",
sp-container  |       "homeOwnerId": "HO-001",
sp-container  |       "hoCertificate": "-----BEGIN CERTIFICATE-----\nMIIEgDCCAmigAwIBAgIQaEWCsOh3PU3K9ZisD+dOgDANBgkqhkiG9w0BAQsFADA9\nMQswCQYDVQQGEwJCRTEYMBYGA1UEChMPUHJpdmF0ZSBQYXJraW5nMRQwEgYDVQQD\nEwsxNzIuMjAuMC4xMDAeFw0yNTEyMjUyMzAxMTZaFw0yNjEyMjUyMzAyMTZaMDox\nCzAJBgNVBAYTAkJFMRcwFQYDVQQKDA5QYXJraW5nIFN5c3RlbTESMBAGA1UEAwwJ\nSG9tZU93bmVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsa8NWMN3\noYVYGjVISiFEVUISo1njiGJlda8kbT4X2mUXVf1GQ9KC7WDNQvkpLEsxDsLm89U9\nOXxo+eQwCVIPIGdHZPBGG1MDghhFz/V571wg97i7NdirTnpLI9WLGMxyq17RtuHH\nlVOPsd2Nwc9/cHXSbnQniLeMJ/mM8KI/L7W0ocY+qoBE0Bf84Ny/9A7adEvAJ9Em\nNKh2liNRKs5zcchuVDXhAUtgPL/1B9flbUPdp6R5Xhsody5t8D0MO1SW4W2LN7/B\nmY2rOUXmoBHfIfDEcHM6MO7qKFfMN1yvk5MjmB+BtNGpso5udHQGZPRpNkdbDB6B\nDURBO50fEliINQIDAQABo38wfTAMBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIF\noDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwHQYDVR0OBBYEFJfSnj0U\nTiU6axXFdSh/K0TkQdKfMB8GA1UdIwQYMBaAFMkcn65FDxCLoejj3tyrE1Khh6KK\nMA0GCSqGSIb3DQEBCwUAA4ICAQCWjKUyCYOPfaSGgtZmn667v2Sph85dSN+bQVUa\n/7hcjfJF7JqBPWOSsQq6un4fiaJ1gARIDc1Ho3SF8xNpdepS4wfMRoaewDDKFoHm\ndxj8xnt+xFKPLgjE49RnJvilfaO/qCqZ/YohteXshKgXq4shE6nvSvH/RIN1qP2s\nsxL+a8yvIGYgaQtIMPul/Oca9/qcL76k2bnXHpeCBoaP/xlKvBGyntZ1LqAj2WKa\nFPr5h+RD7VjTzVW0DVMej/Kvhrrl6hg+lr/+LlJwuFVkXgwjLOhqrq0mO3Za1kiT\n/rfl7/sqI29wDioRar1thfi4oFuuGP+KJAONpEsKthIYLvAeoyk2Gxfl0aixY6Op\net6byCKj0DKe1HZziqT0HgRzdvlAmT1JHifTkucgLMz4OhdAYJXekxvGQR5wrBYF\n/Dqc//GJNbhMYMrJRKxukuaQHWiPf8YnVQbPD1byjsqS0yHmT4CuK7dWG9qpYXj9\nvYqTC7/Uwc+yYMPIiJ5p+2mBqcPGMOZ6hIM4bnIuq5LuY1meynSXXwjbXhcGISCa\n6xJb2SZuWn6ZtvWX0pTNsR9tUTGpmkJgJXrRMzz8jC7egDojuYev7DlYVRADXgJT\n4v5TBurGvIyNblo1j2LBI8rgyR8+OKm1sOLg9KRkGnS3NIuxfolKjn+M9YkxvcUI\nHfLxEg==\n-----END CERTIFICATE-----\n",
sp-container  |       "validFrom": "2025-12-25T23:03:14.580187807Z",
sp-container  |       "validTo": "2025-12-26T07:03:14.580187807Z"
sp-container  |     },
sp-container  |     {
sp-container  |       "priceTokens": 5,
sp-container  |       "hoIdentity": "HomeOwner",
sp-container  |       "hoCertFingerprint": "B229A59688B10B7CABBC6BE54D3EB7B55D4377AC6AD0CA8131AC5E4E1D489A6D",
sp-container  |       "availabilityId": "49f048b8-6297-4bbe-bebf-f5f8d9e868e5",
sp-container  |       "spotId": "SPOT-A1",
sp-container  |       "locationZone": "Downtown-North",
sp-container  |       "homeOwnerId": "HO-001",
sp-container  |       "hoCertificate": "-----BEGIN CERTIFICATE-----\nMIIEgDCCAmigAwIBAgIQaEWCsOh3PU3K9ZisD+dOgDANBgkqhkiG9w0BAQsFADA9\nMQswCQYDVQQGEwJCRTEYMBYGA1UEChMPUHJpdmF0ZSBQYXJraW5nMRQwEgYDVQQD\nEwsxNzIuMjAuMC4xMDAeFw0yNTEyMjUyMzAxMTZaFw0yNjEyMjUyMzAyMTZaMDox\nCzAJBgNVBAYTAkJFMRcwFQYDVQQKDA5QYXJraW5nIFN5c3RlbTESMBAGA1UEAwwJ\nSG9tZU93bmVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsa8NWMN3\noYVYGjVISiFEVUISo1njiGJlda8kbT4X2mUXVf1GQ9KC7WDNQvkpLEsxDsLm89U9\nOXxo+eQwCVIPIGdHZPBGG1MDghhFz/V571wg97i7NdirTnpLI9WLGMxyq17RtuHH\nlVOPsd2Nwc9/cHXSbnQniLeMJ/mM8KI/L7W0ocY+qoBE0Bf84Ny/9A7adEvAJ9Em\nNKh2liNRKs5zcchuVDXhAUtgPL/1B9flbUPdp6R5Xhsody5t8D0MO1SW4W2LN7/B\nmY2rOUXmoBHfIfDEcHM6MO7qKFfMN1yvk5MjmB+BtNGpso5udHQGZPRpNkdbDB6B\nDURBO50fEliINQIDAQABo38wfTAMBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIF\noDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwHQYDVR0OBBYEFJfSnj0U\nTiU6axXFdSh/K0TkQdKfMB8GA1UdIwQYMBaAFMkcn65FDxCLoejj3tyrE1Khh6KK\nMA0GCSqGSIb3DQEBCwUAA4ICAQCWjKUyCYOPfaSGgtZmn667v2Sph85dSN+bQVUa\n/7hcjfJF7JqBPWOSsQq6un4fiaJ1gARIDc1Ho3SF8xNpdepS4wfMRoaewDDKFoHm\ndxj8xnt+xFKPLgjE49RnJvilfaO/qCqZ/YohteXshKgXq4shE6nvSvH/RIN1qP2s\nsxL+a8yvIGYgaQtIMPul/Oca9/qcL76k2bnXHpeCBoaP/xlKvBGyntZ1LqAj2WKa\nFPr5h+RD7VjTzVW0DVMej/Kvhrrl6hg+lr/+LlJwuFVkXgwjLOhqrq0mO3Za1kiT\n/rfl7/sqI29wDioRar1thfi4oFuuGP+KJAONpEsKthIYLvAeoyk2Gxfl0aixY6Op\net6byCKj0DKe1HZziqT0HgRzdvlAmT1JHifTkucgLMz4OhdAYJXekxvGQR5wrBYF\n/Dqc//GJNbhMYMrJRKxukuaQHWiPf8YnVQbPD1byjsqS0yHmT4CuK7dWG9qpYXj9\nvYqTC7/Uwc+yYMPIiJ5p+2mBqcPGMOZ6hIM4bnIuq5LuY1meynSXXwjbXhcGISCa\n6xJb2SZuWn6ZtvWX0pTNsR9tUTGpmkJgJXrRMzz8jC7egDojuYev7DlYVRADXgJT\n4v5TBurGvIyNblo1j2LBI8rgyR8+OKm1sOLg9KRkGnS3NIuxfolKjn+M9YkxvcUI\nHfLxEg==\n-----END CERTIFICATE-----\n",
sp-container  |       "validFrom": "2025-12-25T23:02:53.955280335Z",
sp-container  |       "validTo": "2025-12-26T07:02:53.955280335Z"
sp-container  |     },
sp-container  |     {
sp-container  |       "priceTokens": 5,
sp-container  |       "hoIdentity": "HomeOwner",
sp-container  |       "hoCertFingerprint": "B229A59688B10B7CABBC6BE54D3EB7B55D4377AC6AD0CA8131AC5E4E1D489A6D",
sp-container  |       "availabilityId": "340f449d-d405-49ec-b2e4-9606f78a2a69",
sp-container  |       "spotId": "SPOT-A1",
sp-container  |       "locationZone": "Downtown-North",
sp-container  |       "homeOwnerId": "HO-001",
sp-container  |       "hoCertificate": "-----BEGIN CERTIFICATE-----\nMIIEgDCCAmigAwIBAgIQaEWCsOh3PU3K9ZisD+dOgDANBgkqhkiG9w0BAQsFADA9\nMQswCQYDVQQGEwJCRTEYMBYGA1UEChMPUHJpdmF0ZSBQYXJraW5nMRQwEgYDVQQD\nEwsxNzIuMjAuMC4xMDAeFw0yNTEyMjUyMzAxMTZaFw0yNjEyMjUyMzAyMTZaMDox\nCzAJBgNVBAYTAkJFMRcwFQYDVQQKDA5QYXJraW5nIFN5c3RlbTESMBAGA1UEAwwJ\nSG9tZU93bmVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsa8NWMN3\noYVYGjVISiFEVUISo1njiGJlda8kbT4X2mUXVf1GQ9KC7WDNQvkpLEsxDsLm89U9\nOXxo+eQwCVIPIGdHZPBGG1MDghhFz/V571wg97i7NdirTnpLI9WLGMxyq17RtuHH\nlVOPsd2Nwc9/cHXSbnQniLeMJ/mM8KI/L7W0ocY+qoBE0Bf84Ny/9A7adEvAJ9Em\nNKh2liNRKs5zcchuVDXhAUtgPL/1B9flbUPdp6R5Xhsody5t8D0MO1SW4W2LN7/B\nmY2rOUXmoBHfIfDEcHM6MO7qKFfMN1yvk5MjmB+BtNGpso5udHQGZPRpNkdbDB6B\nDURBO50fEliINQIDAQABo38wfTAMBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIF\noDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwHQYDVR0OBBYEFJfSnj0U\nTiU6axXFdSh/K0TkQdKfMB8GA1UdIwQYMBaAFMkcn65FDxCLoejj3tyrE1Khh6KK\nMA0GCSqGSIb3DQEBCwUAA4ICAQCWjKUyCYOPfaSGgtZmn667v2Sph85dSN+bQVUa\n/7hcjfJF7JqBPWOSsQq6un4fiaJ1gARIDc1Ho3SF8xNpdepS4wfMRoaewDDKFoHm\ndxj8xnt+xFKPLgjE49RnJvilfaO/qCqZ/YohteXshKgXq4shE6nvSvH/RIN1qP2s\nsxL+a8yvIGYgaQtIMPul/Oca9/qcL76k2bnXHpeCBoaP/xlKvBGyntZ1LqAj2WKa\nFPr5h+RD7VjTzVW0DVMej/Kvhrrl6hg+lr/+LlJwuFVkXgwjLOhqrq0mO3Za1kiT\n/rfl7/sqI29wDioRar1thfi4oFuuGP+KJAONpEsKthIYLvAeoyk2Gxfl0aixY6Op\net6byCKj0DKe1HZziqT0HgRzdvlAmT1JHifTkucgLMz4OhdAYJXekxvGQR5wrBYF\n/Dqc//GJNbhMYMrJRKxukuaQHWiPf8YnVQbPD1byjsqS0yHmT4CuK7dWG9qpYXj9\nvYqTC7/Uwc+yYMPIiJ5p+2mBqcPGMOZ6hIM4bnIuq5LuY1meynSXXwjbXhcGISCa\n6xJb2SZuWn6ZtvWX0pTNsR9tUTGpmkJgJXrRMzz8jC7egDojuYev7DlYVRADXgJT\n4v5TBurGvIyNblo1j2LBI8rgyR8+OKm1sOLg9KRkGnS3NIuxfolKjn+M9YkxvcUI\nHfLxEg==\n-----END CERTIFICATE-----\n",
sp-container  |       "validFrom": "2025-12-25T23:02:17.066938417Z",
sp-container  |       "validTo": "2025-12-26T07:02:17.066938417Z"
sp-container  |     }
sp-container  |   ],
sp-container  |   "count": 3,
sp-container  |   "status": "success",
sp-container  |   "timestamp": "2025-12-25T23:03:19.863837337Z"
sp-container  | }
sp-container  | 
sp-container  | CarOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  362E632A2925EB78FAD22FC30B34187A
sp-container  | [SP]   SHA-256: 7E5EBCCE3FFA616A8F400F899EDB52C4...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: CarOwner
sp-container  | Client address: /172.20.0.13:35948
sp-container  | Client certificate subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 362E632A2925EB78FAD22FC30B34187A
sp-container  | Certificate valid from: Thu Dec 25 23:01:22 UTC 2025
sp-container  | Certificate valid until: Fri Dec 25 23:02:22 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: 338CC6392B095B7D...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from CarOwner: {
sp-container  |   "method": "requestTokens",
sp-container  |   "count": 5
sp-container  | }
sp-container  | 
sp-container  | === Generating 5 payment tokens for CarOwner ===
sp-container  | ✓ Generated secret s (32 bytes)
sp-container  | ✓ Generated hash chain of length 5
sp-container  |   Root H^5(s): 2DAB4B0FFBB0213E...
sp-container  | ✓ Signed root with SP private key (256 bytes)
sp-container  | ✓ Stored chain metadata (ID: 3419e9c1-77ed-4056-83d6-30fabdfa44b0)
sp-container  | ✓ Token batch ready to send to CarOwner
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "tokenHashAlg": "SHA-256",
sp-container  |   "signatureAlg": "SHA256withRSA",
sp-container  |   "chainId": "3419e9c1-77ed-4056-83d6-30fabdfa44b0",
sp-container  |   "rootSignature": "dbQcbfxjlRcdLW9zJ6cltY3+aWAUtmyeYrwZid6+RyvAbPcwn9gMk1DMpohS/Vstwyb2fMHmbzHzo+pQka7BBX9m0vU+x49urfpidOyaQP5ucdItk+FitRprqOXh/q7e2Snxfs4Bmd/HcYK5BKjBJTYLn5Ht3cinEf1pSUCAFA7bjj6Y8fQqVL5ks3GiVHEChfp7jlmuibxb/WjbYOoyuWNkhyH4p/CZhzI8lGLtGeWxx5vjLZK5JN5WNwpBZS1cGSD4xHyNMQV9NCqzIAPpyafRE695Iht6rLhO28rq8Do7oY+gMEBIg+GWXbvVOc3kdC/EhQoDBRHSA6mleJ0Xyg==",
sp-container  |   "root": "LatLD/uwIT6iRceBHhwqm9QQwEuQDCkyPaRpuVg/5GA=",
sp-container  |   "x": 5,
sp-container  |   "tokens": [
sp-container  |     "l9vNJlutsj7zrBZbIqJc+Co1gwtqmoGuzm0A9pKTAso=",
sp-container  |     "OYuuyjWqDN0FeTwd1o/Mln90tieyMKBVoMq6RvYkHow=",
sp-container  |     "oaiEkN7uU+8PjRNK3Xlft/0b+7/lZ1q4eq5cEuWAhSU=",
sp-container  |     "i3ypIfdals3dSAz4pmX57dB3xwfZPQPJXd7dVUI62pI=",
sp-container  |     "LatLD/uwIT6iRceBHhwqm9QQwEuQDCkyPaRpuVg/5GA="
sp-container  |   ],
sp-container  |   "status": "success"
sp-container  | }
sp-container  | 
sp-container  | CarOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  684582B0E8773D4DCAF598AC0FE74E80
sp-container  | [SP]   SHA-256: B229A59688B10B7CABBC6BE54D3EB7B5...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: HomeOwner
sp-container  | Client address: /172.20.0.12:58978
sp-container  | Client certificate subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 684582B0E8773D4DCAF598AC0FE74E80
sp-container  | Certificate valid from: Thu Dec 25 23:01:16 UTC 2025
sp-container  | Certificate valid until: Fri Dec 25 23:02:16 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: 55B41A0DD235023E...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from HomeOwner: {
sp-container  |   "startIndex": 0,
sp-container  |   "lastTokenSpent": "LatLD/uwIT6iRceBHhwqm9QQwEuQDCkyPaRpuVg/5GA=",
sp-container  |   "method": "settle",
sp-container  |   "reservationId": "987e2e81-886a-4a32-af8d-41286b1e64ac",
sp-container  |   "chainId": "3419e9c1-77ed-4056-83d6-30fabdfa44b0",
sp-container  |   "availabilityId": "ebd07e23-aee1-451a-bf79-ab88cf89b2ab",
sp-container  |   "rootSignature": "dbQcbfxjlRcdLW9zJ6cltY3+aWAUtmyeYrwZid6+RyvAbPcwn9gMk1DMpohS/Vstwyb2fMHmbzHzo+pQka7BBX9m0vU+x49urfpidOyaQP5ucdItk+FitRprqOXh/q7e2Snxfs4Bmd/HcYK5BKjBJTYLn5Ht3cinEf1pSUCAFA7bjj6Y8fQqVL5ks3GiVHEChfp7jlmuibxb/WjbYOoyuWNkhyH4p/CZhzI8lGLtGeWxx5vjLZK5JN5WNwpBZS1cGSD4xHyNMQV9NCqzIAPpyafRE695Iht6rLhO28rq8Do7oY+gMEBIg+GWXbvVOc3kdC/EhQoDBRHSA6mleJ0Xyg==",
sp-container  |   "root": "LatLD/uwIT6iRceBHhwqm9QQwEuQDCkyPaRpuVg/5GA=",
sp-container  |   "newLastSpentIndex": 5,
sp-container  |   "x": 5,
sp-container  |   "y": 5,
sp-container  |   "firstTokenSpent": "l9vNJlutsj7zrBZbIqJc+Co1gwtqmoGuzm0A9pKTAso="
sp-container  | }
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] Settlement Request Received from HomeOwner
sp-container  | [SETTLE]   chainId: 3419e9c1-77ed-4056-83d6-30fabdfa44b0
sp-container  | [SETTLE]   reservationId: 987e2e81-886a-4a32-af8d-41286b1e64ac
sp-container  | [SETTLE]   availabilityId: ebd07e23-aee1-451a-bf79-ab88cf89b2ab
sp-container  | [SETTLE]   y (tokens spent): 5
sp-container  | [SETTLE]   newLastSpentIndex: 5
sp-container  | [SETTLE]   x (chain length): 5
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] ✓ Cryptographic proof verified: token hashes to root
sp-container  | [SETTLE]   (hashed 0 times from last spent token to reach root)
sp-container  | [SETTLE] ✓✓✓ SETTLEMENT ACCEPTED ✓✓✓
sp-container  | [SETTLE]   chainId: 3419e9c1-77ed-4056-83d6-30fabdfa44b0
sp-container  | [SETTLE]   reservationId: 987e2e81-886a-4a32-af8d-41286b1e64ac
sp-container  | [SETTLE]   Previous lastSpentIndex: 0
sp-container  | [SETTLE]   Updated lastSpentIndex: 5
sp-container  | [SETTLE]   Tokens consumed: 5
sp-container  | [SETTLE]   Remaining tokens: 0
sp-container  | [AUDIT] SETTLEMENT_ACCEPTED{chainId=3419e9c1-77ed-4056-83d6-30fabdfa44b0, oldIndex=0, newIndex=5, tokensSpent=5, reservationId=987e2e81-886a-4a32-af8d-41286b1e64ac}
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] M3.4: Generating Cryptographically Verifiable Receipt
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] Canonical Receipt Data:
sp-container  | [SETTLE]   receiptId=399f4116-9786-4fb7-8c1e-d3767c65c406|chainId=3419e9c1-77ed-4056-83d6-30fabdfa44b0|reservationId=987e2e81-886a-4a32-af8d-41286b1e64ac|availabilityId=ebd07e23-aee1-451a-bf79-ab88cf89b2ab|y=5|newLastSpentIndex=5|timestamp=2025-12-25T23:03:20.646787475Z|hoIdentity=HomeOwner
sp-container  | [SETTLE] ✓ Receipt signed with SP private key (RSA-2048)
sp-container  | [SETTLE]   Algorithm: SHA256withRSA
sp-container  | [SETTLE]   Signature length: 256 bytes
sp-container  | [SETTLE] ✓ SP certificate fingerprint: 964EF3CA95A091FFFAB1632C031D6F1F...
sp-container  | [SETTLE] ✓✓✓ PAYMENT RECEIPT GENERATED ✓✓✓
sp-container  | [SETTLE]   Receipt ID: 399f4116-9786-4fb7-8c1e-d3767c65c406
sp-container  | [SETTLE]   Non-repudiation: SP signature binds finality to payment
sp-container  | [SETTLE]   Auditability: Receipt enables offline third-party verification
sp-container  | [AUDIT] RECEIPT_GENERATED{receiptId=399f4116-9786-4fb7-8c1e-d3767c65c406, chainId=3419e9c1-77ed-4056-83d6-30fabdfa44b0, reservationId=987e2e81-886a-4a32-af8d-41286b1e64ac}
sp-container  | Sent response: {
sp-container  |   "reservationId": "987e2e81-886a-4a32-af8d-41286b1e64ac",
sp-container  |   "chainId": "3419e9c1-77ed-4056-83d6-30fabdfa44b0",
sp-container  |   "remainingTokens": 0,
sp-container  |   "acceptedLastSpentIndex": 5,
sp-container  |   "tokensConsumed": 5,
sp-container  |   "paymentReceipt": {
sp-container  |     "hoIdentity": "HomeOwner",
sp-container  |     "reservationId": "987e2e81-886a-4a32-af8d-41286b1e64ac",
sp-container  |     "signatureAlg": "SHA256withRSA",
sp-container  |     "chainId": "3419e9c1-77ed-4056-83d6-30fabdfa44b0",
sp-container  |     "availabilityId": "ebd07e23-aee1-451a-bf79-ab88cf89b2ab",
sp-container  |     "newLastSpentIndex": 5,
sp-container  |     "spCertFingerprint": "964EF3CA95A091FFFAB1632C031D6F1FDD957539DBAFCF361A7B265A2B2D4961",
sp-container  |     "y": 5,
sp-container  |     "receiptId": "399f4116-9786-4fb7-8c1e-d3767c65c406",
sp-container  |     "canonicalReceipt": "receiptId=399f4116-9786-4fb7-8c1e-d3767c65c406|chainId=3419e9c1-77ed-4056-83d6-30fabdfa44b0|reservationId=987e2e81-886a-4a32-af8d-41286b1e64ac|availabilityId=ebd07e23-aee1-451a-bf79-ab88cf89b2ab|y=5|newLastSpentIndex=5|timestamp=2025-12-25T23:03:20.646787475Z|hoIdentity=HomeOwner",
sp-container  |     "receiptSignature": "bboxRKx2g+uuigRSrTe9YgmUV3I3j7JoB2S0LHFiho88qobnBiIT145ulqNYV/dLXJgfOg0ab6ksEzFpOJnUgCRBiTR3+MzMbJtzARVfn1SGmpe1MIAVF0Z8BoMh1fy2lpKVX7Tnreq4iw80dhDh7KKZpVaeaVsgqMVWjAaiFDJ+SpPEsD2pWASb2nfDXO3h2LCTIpA5UmrwrDNI/ew+OtM2UHeYasyiEEsx0Xkl1Ylj9j6egGj6dJV2mdRexZHpWOd69e7dCoMFlpmBlIgDDJGQ702G2gcUdQDFq7uwe+uLUH4gYixY8FrZF5ycVWnIP3uDzr/nDwf2MgxPX/Rj3Q==",
sp-container  |     "timestamp": "2025-12-25T23:03:20.646787475Z"
sp-container  |   },
sp-container  |   "message": "Settlement accepted",
sp-container  |   "status": "success",
sp-container  |   "timestamp": "2025-12-25T23:03:20.646787475Z"
sp-container  | }
sp-container  | 
sp-container  | HomeOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  684582B0E8773D4DCAF598AC0FE74E80
sp-container  | [SP]   SHA-256: B229A59688B10B7CABBC6BE54D3EB7B5...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: HomeOwner
sp-container  | Client address: /172.20.0.12:58980
sp-container  | Client certificate subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 684582B0E8773D4DCAF598AC0FE74E80
sp-container  | Certificate valid from: Thu Dec 25 23:01:16 UTC 2025
sp-container  | Certificate valid until: Fri Dec 25 23:02:16 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: 866A168FA3EEE720...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | [SETTLE] ❌❌❌ DOUBLE_SPEND_DETECTED ❌❌❌
sp-container  | [SETTLE]   chainId: 3419e9c1-77ed-4056-83d6-30fabdfa44b0
sp-container  | [SETTLE]   currentLastSpentIndex: 5
sp-container  | [SETTLE]   attemptedNewIndex: 5
sp-container  | [SETTLE]   reservationId: 987e2e81-886a-4a32-af8d-41286b1e64ac
sp-container  | [AUDIT] DOUBLE_SPEND_DETECTED{chainId=3419e9c1-77ed-4056-83d6-30fabdfa44b0, oldIndex=5, newIndex=5, reservationId=987e2e81-886a-4a32-af8d-41286b1e64ac}
sp-container  | 
sp-container  | Received from HomeOwner: {
sp-container  |   "startIndex": 0,
sp-container  |   "lastTokenSpent": "LatLD/uwIT6iRceBHhwqm9QQwEuQDCkyPaRpuVg/5GA=",
sp-container  |   "method": "settle",
sp-container  |   "reservationId": "987e2e81-886a-4a32-af8d-41286b1e64ac",
sp-container  |   "chainId": "3419e9c1-77ed-4056-83d6-30fabdfa44b0",
sp-container  |   "availabilityId": "ebd07e23-aee1-451a-bf79-ab88cf89b2ab",
sp-container  |   "rootSignature": "dbQcbfxjlRcdLW9zJ6cltY3+aWAUtmyeYrwZid6+RyvAbPcwn9gMk1DMpohS/Vstwyb2fMHmbzHzo+pQka7BBX9m0vU+x49urfpidOyaQP5ucdItk+FitRprqOXh/q7e2Snxfs4Bmd/HcYK5BKjBJTYLn5Ht3cinEf1pSUCAFA7bjj6Y8fQqVL5ks3GiVHEChfp7jlmuibxb/WjbYOoyuWNkhyH4p/CZhzI8lGLtGeWxx5vjLZK5JN5WNwpBZS1cGSD4xHyNMQV9NCqzIAPpyafRE695Iht6rLhO28rq8Do7oY+gMEBIg+GWXbvVOc3kdC/EhQoDBRHSA6mleJ0Xyg==",
sp-container  |   "root": "LatLD/uwIT6iRceBHhwqm9QQwEuQDCkyPaRpuVg/5GA=",
sp-container  |   "newLastSpentIndex": 5,
sp-container  |   "x": 5,
sp-container  |   "y": 5,
sp-container  |   "firstTokenSpent": "l9vNJlutsj7zrBZbIqJc+Co1gwtqmoGuzm0A9pKTAso="
sp-container  | }
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] Settlement Request Received from HomeOwner
sp-container  | [SETTLE]   chainId: 3419e9c1-77ed-4056-83d6-30fabdfa44b0
sp-container  | [SETTLE]   reservationId: 987e2e81-886a-4a32-af8d-41286b1e64ac
sp-container  | [SETTLE]   availabilityId: ebd07e23-aee1-451a-bf79-ab88cf89b2ab
sp-container  | [SETTLE]   y (tokens spent): 5
sp-container  | [SETTLE]   newLastSpentIndex: 5
sp-container  | [SETTLE]   x (chain length): 5
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "reason": "double_spend",
sp-container  |   "reservationId": "987e2e81-886a-4a32-af8d-41286b1e64ac",
sp-container  |   "chainId": "3419e9c1-77ed-4056-83d6-30fabdfa44b0",
sp-container  |   "message": "DOUBLE_SPEND_DETECTED: attempting to reuse already-spent tokens",
sp-container  |   "status": "error",
sp-container  |   "currentLastSpentIndex": 5,
sp-container  |   "rejectedNewIndex": 5
sp-container  | }
sp-container  | 
sp-container  | HomeOwner disconnected
