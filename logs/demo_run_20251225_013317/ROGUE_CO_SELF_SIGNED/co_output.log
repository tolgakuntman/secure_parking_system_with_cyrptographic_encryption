 Container cauth-container  Running
 Container sp-container  Running
[CO][INFO][ROGUE_CO_SELF_SIGNED] Waiting for CAuth, SP, and HO to start...
[CO][INFO][ROGUE_CO_SELF_SIGNED] 
=== Car Owner (CO) Starting ===
[CO][INFO][ROGUE_CO_SELF_SIGNED] 
═══════════════════════════════════════════════════════════════
[CO][INFO][ROGUE_CO_SELF_SIGNED]   [ROGUE_CO] NEGATIVE TEST MODE: BAD_CERT
[CO][INFO][ROGUE_CO_SELF_SIGNED]   Sub-mode: SELF_SIGNED
[CO][INFO][ROGUE_CO_SELF_SIGNED] ═══════════════════════════════════════════════════════════════
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Testing rejection of CO without valid certificate
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Mode: SELF_SIGNED
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] SELF_SIGNED mode: Generating untrusted self-signed certificate
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Generating RSA-2048 keypair for self-signed certificate...
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Self-signed certificate created:
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO]   BasicConstraints: CA=false
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO]   KeyUsage: digitalSignature, keyEncipherment
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO]   ExtendedKeyUsage: clientAuth
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Certificate stored in keystore as PrivateKeyEntry
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Keystore path: ./keystore/co_keystore.p12
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Generated self-signed certificate:
[CO][INFO][ROGUE_CO_SELF_SIGNED]   Subject: C=XX, O=Unauthorized, CN=ROGUE-CO-UNTRUSTED
[CO][INFO][ROGUE_CO_SELF_SIGNED]   Issuer:  C=XX, O=Unauthorized, CN=ROGUE-CO-UNTRUSTED
[CO][INFO][ROGUE_CO_SELF_SIGNED]   Serial:  61203707904850193768113019380152192887
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] ⚠ This certificate is NOT chained to trusted Root CA
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] ⚠ It is self-signed and will be rejected by services
[CO][INFO][ROGUE_CO_SELF_SIGNED] 
[ROGUE_CO] Attempting mTLS connection to SP...
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] EXPECTED: Connection should FAIL
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] REASON: Self-signed cert not chained to Root CA (PKIX validation fails)
[CO][INFO][ROGUE_CO_SELF_SIGNED] 
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Creating SSLContext WITH self-signed certificate
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Loading keystore to verify certificate availability...
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Keystore loaded successfully:
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO]   Type: PKCS12
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO]   Path: ./keystore/co_keystore.p12
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO]   Alias [1]: co_key
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO]     Entry type: PrivateKeyEntry (has private key)
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO]     Subject: C=XX,O=Unauthorized,CN=ROGUE-CO-UNTRUSTED
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO]     Issuer: C=XX,O=Unauthorized,CN=ROGUE-CO-UNTRUSTED
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO]     SHA-256: 3B9CB8F227CD77CF7D51CE8E331210F8...
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Certificate is available and ready to be sent during TLS handshake
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] KeyManagers created: 1 manager(s)
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] KeyManager wrapped to force alias selection: co_key
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] SSLContext initialized with wrapped KeyManagers
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Connecting to SP at sp:8444
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Starting TLS handshake...
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] chooseClientAlias called - forcing alias: co_key
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] TLS negotiation completed; validating mTLS acceptance...
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Server authenticated: C=BE,O=Parking System,CN=ServiceProvider
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Performing post-handshake proof (send request)...
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Reading response to confirm mTLS acceptance...
[CO][INFO][ROGUE_CO_SELF_SIGNED] 
╔═══════════════════════════════════════════════════════════════╗
[CO][INFO][ROGUE_CO_SELF_SIGNED] ║   [ROGUE_CO] ...
[CO][INFO][ROGUE_CO_SELF_SIGNED] ╚═══════════════════════════════════════════════════════════════╝
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] mTLS rejected by peer during client certificate validation!
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Error type: SSLHandshakeException
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] Error message: Received fatal alert: certificate_unknown
[CO][INFO][ROGUE_CO_SELF_SIGNED] 
[ROGUE_CO] VERIFICATION COMPLETE:
[CO][INFO][ROGUE_CO_SELF_SIGNED]   ...
[CO][INFO][ROGUE_CO_SELF_SIGNED]   ...
[CO][INFO][ROGUE_CO_SELF_SIGNED]   ...
[CO][INFO][ROGUE_CO_SELF_SIGNED]   ...
[CO][INFO][ROGUE_CO_SELF_SIGNED]   ...
[CO][INFO][ROGUE_CO_SELF_SIGNED]   ...
[CO][INFO][ROGUE_CO_SELF_SIGNED] 
[ROGUE_CO] CONCLUSION: Rogue CO properly rejected!
[CO][INFO][ROGUE_CO_SELF_SIGNED] [ROGUE_CO] The system is SECURE against unauthorized clients.

