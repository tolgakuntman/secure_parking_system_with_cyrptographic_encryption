sp-container  | Waiting for CAuth to start...
sp-container  | 
sp-container  | === Service Provider Starting ===
sp-container  | Initializing cryptographic baseline...
sp-container  | 
sp-container  | No existing certificate found, enrolling with CAuth...
sp-container  | Step 1: Generating RSA key pair...
sp-container  | ✓ RSA-2048 key pair generated successfully
sp-container  | 
sp-container  | Step 2: Creating Certificate Signing Request (CSR)...
sp-container  | ✓ CSR created with subject: CN=ServiceProvider, O=Parking System, C=BE
sp-container  | 
sp-container  | Step 3: Connecting to CAuth server over TLS...
sp-container  | ✓ TLS connection established to CAuth
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   CAuth certificate verified:
sp-container  |     Subject: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  |     Issuer: CN=Root CA,O=National Authority,C=Country Code
sp-container  | 
sp-container  | → Sending CSR to CAuth for signing...
sp-container  | Received CA certificate from CAuth.
sp-container  | Received Root CA certificate from CAuth.
sp-container  | Certificate signed by CAuth!
sp-container  | ✓ Certificate received from CAuth
sp-container  | 
sp-container  | Step 4: Validating received certificate...
sp-container  |   ✓ Certificate is within validity period
sp-container  |     Valid from: Thu Dec 25 22:53:08 UTC 2025
sp-container  |     Valid until: Fri Dec 25 22:54:08 UTC 2026
sp-container  |   ✓ Certificate public key matches generated key pair
sp-container  |   Validating certificate chain (3 certificates):
sp-container  |     [0] C=BE,O=Parking System,CN=ServiceProvider
sp-container  |         Issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  |         ✓ Signature verified by issuer
sp-container  |     [1] CN=172.20.0.10,O=Private Parking,C=BE
sp-container  |         Issuer: CN=Root CA,O=National Authority,C=Country Code
sp-container  |         ✓ Signature verified by issuer
sp-container  |     [2] CN=Root CA,O=National Authority,C=Country Code
sp-container  |         Issuer: CN=Root CA,O=National Authority,C=Country Code
sp-container  |   ✓ Chain terminates at trusted Root CA: root_ca
sp-container  |   ✓ Certificate chain validation complete
sp-container  | ✓ Certificate chain validation successful
sp-container  | 
sp-container  | Step 5: Storing certificate and private key securely...
sp-container  | Storing certificate chain with 3 certificate(s)
sp-container  |   [0] C=BE,O=Parking System,CN=ServiceProvider
sp-container  |   [1] CN=172.20.0.10,O=Private Parking,C=BE
sp-container  |   [2] CN=Root CA,O=National Authority,C=Country Code
sp-container  | ✓ Credentials stored in ./keystore/sp_keystore.p12
sp-container  | 
sp-container  | ╔═══════════════════════════════════════════╗
sp-container  | ║   CRYPTOGRAPHIC IDENTITY ESTABLISHED     ║
sp-container  | ╚═══════════════════════════════════════════╝
sp-container  | Subject: C=BE,O=Parking System,CN=ServiceProvider
sp-container  | Issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Valid from: Thu Dec 25 22:53:08 UTC 2025
sp-container  | Valid until: Fri Dec 25 22:54:08 UTC 2026
sp-container  | Serial: 6F97840736A8AFA1C311083EA76B7321
sp-container  | ✓ Certificate and private key verified
sp-container  | 
sp-container  | === Starting SP Server ===
sp-container  | 
sp-container  | === SP CRYPTOGRAPHIC BASELINE ESTABLISHED ===
sp-container  | Version: 2025-12-22 (Hardened TLS with mTLS enforcement)
sp-container  | ✓ Enabled TLS protocols: [TLSv1.3, TLSv1.2]
sp-container  | ✓ Strong cipher suites configured: 9 suites
sp-container  |  Mutual TLS (mTLS) REQUIRED - client certificates enforced
sp-container  | 
sp-container  | === TLS Server Configuration ===
sp-container  | Server listening on port: 8444
sp-container  | Server certificate subject: C=BE,O=Parking System,CN=ServiceProvider
sp-container  | Server certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Certificate serial: 6F97840736A8AFA1C311083EA76B7321
sp-container  | Certificate algorithm: SHA256withRSA
sp-container  | Public key algorithm: RSA
sp-container  | RSA key size: 2048 bits
sp-container  | mTLS enforcement: ENABLED (client certificates REQUIRED)
sp-container  | 
sp-container  | ✓ SP Server ready to accept secure connections
sp-container  | ==========================================
sp-container  | 
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  6A009FDD44A0B54B2EBECBE1D3DEE71B
sp-container  | [SP]   SHA-256: AAB9D74CC14D252F2E92169D386BB399...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: HomeOwner
sp-container  | Client address: /172.20.0.12:38536
sp-container  | Client certificate subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 6A009FDD44A0B54B2EBECBE1D3DEE71B
sp-container  | Certificate valid from: Thu Dec 25 22:53:11 UTC 2025
sp-container  | Certificate valid until: Fri Dec 25 22:54:11 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: E343F8202AB25D11...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from HomeOwner: {
sp-container  |   "priceTokens": 5,
sp-container  |   "metadata": {
sp-container  |     "spotType": "residential",
sp-container  |     "autoRenewal": false,
sp-container  |     "maxDuration": "8h"
sp-container  |   },
sp-container  |   "method": "publishAvailability",
sp-container  |   "spotId": "SPOT-A1",
sp-container  |   "locationZone": "Downtown-North",
sp-container  |   "homeOwnerId": "HO-001",
sp-container  |   "validFrom": "2025-12-25T22:54:11.920735980Z",
sp-container  |   "validTo": "2025-12-26T06:54:11.920735980Z"
sp-container  | }
sp-container  | 
sp-container  | === Publishing Parking Availability from HomeOwner ===
sp-container  |   Home Owner: HO-001
sp-container  |   Spot ID: SPOT-A1
sp-container  |   Valid: 2025-12-25T22:54:11.920735980Z to 2025-12-26T06:54:11.920735980Z
sp-container  |   Price: 5 tokens
sp-container  |   Location: Downtown-North
sp-container  | ✓ Availability stored with ID: 4de265e1-73a6-473e-8ff0-9e927153a2d4
sp-container  | ✓ Total availabilities in system: 1
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "publishedAt": "2025-12-25T22:54:11.995972215Z",
sp-container  |   "availabilityId": "4de265e1-73a6-473e-8ff0-9e927153a2d4",
sp-container  |   "spotId": "SPOT-A1",
sp-container  |   "message": "Parking availability published successfully",
sp-container  |   "status": "success"
sp-container  | }
sp-container  | 
sp-container  | HomeOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  566F389741FA013C23384A518B2EC6F8
sp-container  | [SP]   SHA-256: 3906104EE42D650B12D8E02749969F56...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: CarOwner
sp-container  | Client address: /172.20.0.13:52834
sp-container  | Client certificate subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 566F389741FA013C23384A518B2EC6F8
sp-container  | Certificate valid from: Thu Dec 25 22:53:16 UTC 2025
sp-container  | Certificate valid until: Fri Dec 25 22:54:16 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: 8F2543DFAF7535A9...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from CarOwner: {"method": "getAvailability"}
sp-container  | 
sp-container  | === Availability Discovery Request from CarOwner ===
sp-container  |   Total availabilities in system: 1
sp-container  |   [4de265e1-73a6-473e-8ff0-9e927153a2d4] SPOT-A1 - 5 tokens (HO: HomeOwner)
sp-container  | ✓ Returned 1 availability record(s) to CarOwner
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "availabilities": [{
sp-container  |     "priceTokens": 5,
sp-container  |     "hoIdentity": "HomeOwner",
sp-container  |     "hoCertFingerprint": "AAB9D74CC14D252F2E92169D386BB3996BE85D44FC4637FB09644E07283E0B91",
sp-container  |     "availabilityId": "4de265e1-73a6-473e-8ff0-9e927153a2d4",
sp-container  |     "spotId": "SPOT-A1",
sp-container  |     "locationZone": "Downtown-North",
sp-container  |     "homeOwnerId": "HO-001",
sp-container  |     "hoCertificate": "-----BEGIN CERTIFICATE-----\nMIIEgDCCAmigAwIBAgIQagCf3USgtUsuvsvh097nGzANBgkqhkiG9w0BAQsFADA9\nMQswCQYDVQQGEwJCRTEYMBYGA1UEChMPUHJpdmF0ZSBQYXJraW5nMRQwEgYDVQQD\nEwsxNzIuMjAuMC4xMDAeFw0yNTEyMjUyMjUzMTFaFw0yNjEyMjUyMjU0MTFaMDox\nCzAJBgNVBAYTAkJFMRcwFQYDVQQKDA5QYXJraW5nIFN5c3RlbTESMBAGA1UEAwwJ\nSG9tZU93bmVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAt+sFZsAt\na36Osnb4KsUwOWfTx54BJlJBb/nCaLiiXB7BAK7orVvYdxZDvRfXrnlMRp2ihp1K\nUFrP1Ab0H8aczeJFy5fby9v5GVHBrMVwToRMhrPIDkQNDJiDPEtAVIEByWCFgaMT\nM3EYh8PwHcP4P1YrLwn9LXdChZvAkE5TgVmtnZCTN3/QP5ivtu3W/mpxT9RlQKzt\n0txRumQpKFuqrLdJSa8TbKZqxVvHhwbLmSqTIz1QW3PIudREf4b3WpdDOUutG67+\nW9tSW6zRzWpNe3+0DwcB00kM70F5yaDDNPyVesXKSIn1Z+ElO/HjEcDyXZcK90kv\nfn0fy4LTx9xNjQIDAQABo38wfTAMBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIF\noDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwHQYDVR0OBBYEFKvVlAgs\ncDheLu+CJL/+0QKJNcktMB8GA1UdIwQYMBaAFMkcn65FDxCLoejj3tyrE1Khh6KK\nMA0GCSqGSIb3DQEBCwUAA4ICAQA9kyszsEAkzD4sWMC5+yrbrmc559QHEiRmAikF\nA4+LaQOdkIleyc4gzxjEbFq7PFtaBqqdKaprtVkrCLNspYmm9AuGp3FYF15C8zcH\n3wSK5ElTvHrmmqrpEp/szWs3cbkjWqJBd4BJzKTQnKC4CHEoduEQOGL9YuJ0k5f9\nESGx4RDVJ4nh4AKvpEtlnCwBOXkY+vFO4RLvDo0TZdB/uqvR+YpCWuZMJJaK3MZs\nYlV5QiBd5IOQVg2NMQFF/0SsCxZw5Mr+iGdvM4mr9yeXHYUKU4V6QxCtskFUgcwY\nL6u9zkocJU3dAo/uV9cZZ35n+VeHqSZBmN+0oRsPJQH5Kg1eEif9Hu0cg/0+jkP9\nwQ/QlSXoAypZKFawdtjH3YdrLxugZF62Dmcqg6Aecii6mHUlO2DHr/71PPpXCHqU\npbPzCe3hcojpIjv9KqfivqadEWZvhF7jK7sXgYj6E+/3bN4QSKEKJ/QiTZx2PrcW\nI/Zc4HD2cic+xHNh0vZdbHSuX5BKPP90JL7GxdwozV6DReL5dzRxWe3Y8t0wLQAm\nA2hdDSWLd93hsHaIOsfz2IoxNRyHgLQ8JYKWgGgQUoFhxgpsIeapqB+BdIaM/fz6\no2UEPAytAlPQPTzqgtn4KXUqY+LLe5Sux72b2cvW3yLYas0mjRcklPVa85FwRE5N\nqls0yA==\n-----END CERTIFICATE-----\n",
sp-container  |     "validFrom": "2025-12-25T22:54:11.920735980Z",
sp-container  |     "validTo": "2025-12-26T06:54:11.920735980Z"
sp-container  |   }],
sp-container  |   "count": 1,
sp-container  |   "status": "success",
sp-container  |   "timestamp": "2025-12-25T22:54:16.960755632Z"
sp-container  | }
sp-container  | 
sp-container  | CarOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  566F389741FA013C23384A518B2EC6F8
sp-container  | [SP]   SHA-256: 3906104EE42D650B12D8E02749969F56...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: CarOwner
sp-container  | Client address: /172.20.0.13:52838
sp-container  | Client certificate subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 566F389741FA013C23384A518B2EC6F8
sp-container  | Certificate valid from: Thu Dec 25 22:53:16 UTC 2025
sp-container  | Certificate valid until: Fri Dec 25 22:54:16 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: 78098445EEF4182E...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from CarOwner: {
sp-container  |   "method": "requestTokens",
sp-container  |   "count": 5
sp-container  | }
sp-container  | 
sp-container  | === Generating 5 payment tokens for CarOwner ===
sp-container  | ✓ Generated secret s (32 bytes)
sp-container  | ✓ Generated hash chain of length 5
sp-container  |   Root H^5(s): 84B3306217902EA5...
sp-container  | ✓ Signed root with SP private key (256 bytes)
sp-container  | ✓ Stored chain metadata (ID: a9983879-e6c8-4740-a245-0be261694b1f)
sp-container  | ✓ Token batch ready to send to CarOwner
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "tokenHashAlg": "SHA-256",
sp-container  |   "signatureAlg": "SHA256withRSA",
sp-container  |   "chainId": "a9983879-e6c8-4740-a245-0be261694b1f",
sp-container  |   "rootSignature": "iwiDPnZ1C9VWgA5P8++wUxyGaNCYEHNc1ZdgKQAFqgbw9b06mGqC7UPblVp7SkMVZOHhVlil4W70sfNQ6SlR0qx4B8BzloxaCRDhFhNDZKcqzBayPmMom4zOHcs4kCQ8Z59F1LQHJkw3sGsmkxbwzT5+xzGCM6eW2zgfdENfIw/Q2tguCgDtpjzUI8Olg7Egp84+6/UjVvEpiJa/odiPgHRHo+JAy4D7cDYB/j7/AEdnjoEI2dVuKniEFm4PRttL70T0PZ8Sg5qjd4bp5uIWBFR0O1jk0nUlYp+w3GTA4O0ppSwpaPgHGfSrkRvtzvjdQdyTQ4fiKQvJ2ERJ36U65g==",
sp-container  |   "root": "hLMwYheQLqUCGgOsL0n82+kqsZNMPgV72DZ1RIVRCGo=",
sp-container  |   "x": 5,
sp-container  |   "tokens": [
sp-container  |     "skBrFoElWs7gxTmD6FQCTKMxQY8kXGFTDowWq3+2zRk=",
sp-container  |     "8KPvjYvG80JfDVwZstKpnYMxJ2Cgh/yQe5MsSgVq5Pg=",
sp-container  |     "/l3N09zdDlM0e8SpYVwxz4bibKeNX+JcylR1ho3WZ34=",
sp-container  |     "QZwErkLZpO2ICqTCf+QW2SOFIFj0WN/HEkYDpg393LQ=",
sp-container  |     "hLMwYheQLqUCGgOsL0n82+kqsZNMPgV72DZ1RIVRCGo="
sp-container  |   ],
sp-container  |   "status": "success"
sp-container  | }
sp-container  | 
sp-container  | CarOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  6A009FDD44A0B54B2EBECBE1D3DEE71B
sp-container  | [SP]   SHA-256: AAB9D74CC14D252F2E92169D386BB399...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: HomeOwner
sp-container  | Client address: /172.20.0.12:36882
sp-container  | Client certificate subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 6A009FDD44A0B54B2EBECBE1D3DEE71B
sp-container  | Certificate valid from: Thu Dec 25 22:53:11 UTC 2025
sp-container  | Certificate valid until: Fri Dec 25 22:54:11 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: 2968EDAA7F240852...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from HomeOwner: {
sp-container  |   "startIndex": 0,
sp-container  |   "lastTokenSpent": "hLMwYheQLqUCGgOsL0n82+kqsZNMPgV72DZ1RIVRCGo=",
sp-container  |   "method": "settle",
sp-container  |   "reservationId": "517b5f93-6d8e-497d-8cb0-cb661ed6d397",
sp-container  |   "chainId": "a9983879-e6c8-4740-a245-0be261694b1f",
sp-container  |   "availabilityId": "4de265e1-73a6-473e-8ff0-9e927153a2d4",
sp-container  |   "rootSignature": "iwiDPnZ1C9VWgA5P8++wUxyGaNCYEHNc1ZdgKQAFqgbw9b06mGqC7UPblVp7SkMVZOHhVlil4W70sfNQ6SlR0qx4B8BzloxaCRDhFhNDZKcqzBayPmMom4zOHcs4kCQ8Z59F1LQHJkw3sGsmkxbwzT5+xzGCM6eW2zgfdENfIw/Q2tguCgDtpjzUI8Olg7Egp84+6/UjVvEpiJa/odiPgHRHo+JAy4D7cDYB/j7/AEdnjoEI2dVuKniEFm4PRttL70T0PZ8Sg5qjd4bp5uIWBFR0O1jk0nUlYp+w3GTA4O0ppSwpaPgHGfSrkRvtzvjdQdyTQ4fiKQvJ2ERJ36U65g==",
sp-container  |   "root": "hLMwYheQLqUCGgOsL0n82+kqsZNMPgV72DZ1RIVRCGo=",
sp-container  |   "newLastSpentIndex": 5,
sp-container  |   "x": 5,
sp-container  |   "y": 5,
sp-container  |   "firstTokenSpent": "skBrFoElWs7gxTmD6FQCTKMxQY8kXGFTDowWq3+2zRk="
sp-container  | }
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] Settlement Request Received from HomeOwner
sp-container  | [SETTLE]   chainId: a9983879-e6c8-4740-a245-0be261694b1f
sp-container  | [SETTLE]   reservationId: 517b5f93-6d8e-497d-8cb0-cb661ed6d397
sp-container  | [SETTLE]   availabilityId: 4de265e1-73a6-473e-8ff0-9e927153a2d4
sp-container  | [SETTLE]   y (tokens spent): 5
sp-container  | [SETTLE]   newLastSpentIndex: 5
sp-container  | [SETTLE]   x (chain length): 5
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] ✓ Cryptographic proof verified: token hashes to root
sp-container  | [SETTLE]   (hashed 0 times from last spent token to reach root)
sp-container  | [SETTLE] ✓✓✓ SETTLEMENT ACCEPTED ✓✓✓
sp-container  | [SETTLE]   chainId: a9983879-e6c8-4740-a245-0be261694b1f
sp-container  | [SETTLE]   reservationId: 517b5f93-6d8e-497d-8cb0-cb661ed6d397
sp-container  | [SETTLE]   Previous lastSpentIndex: 0
sp-container  | [SETTLE]   Updated lastSpentIndex: 5
sp-container  | [SETTLE]   Tokens consumed: 5
sp-container  | [SETTLE]   Remaining tokens: 0
sp-container  | [AUDIT] SETTLEMENT_ACCEPTED{chainId=a9983879-e6c8-4740-a245-0be261694b1f, oldIndex=0, newIndex=5, tokensSpent=5, reservationId=517b5f93-6d8e-497d-8cb0-cb661ed6d397}
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] M3.4: Generating Cryptographically Verifiable Receipt
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] Canonical Receipt Data:
sp-container  | [SETTLE]   receiptId=2f2b59ec-f305-4e40-90bd-21091897a189|chainId=a9983879-e6c8-4740-a245-0be261694b1f|reservationId=517b5f93-6d8e-497d-8cb0-cb661ed6d397|availabilityId=4de265e1-73a6-473e-8ff0-9e927153a2d4|y=5|newLastSpentIndex=5|timestamp=2025-12-25T22:54:17.665169703Z|hoIdentity=HomeOwner
sp-container  | [SETTLE] ✓ Receipt signed with SP private key (RSA-2048)
sp-container  | [SETTLE]   Algorithm: SHA256withRSA
sp-container  | [SETTLE]   Signature length: 256 bytes
sp-container  | [SETTLE] ✓ SP certificate fingerprint: 92804F53851DED8FAD2989EC57023F45...
sp-container  | [SETTLE] ✓✓✓ PAYMENT RECEIPT GENERATED ✓✓✓
sp-container  | [SETTLE]   Receipt ID: 2f2b59ec-f305-4e40-90bd-21091897a189
sp-container  | [SETTLE]   Non-repudiation: SP signature binds finality to payment
sp-container  | [SETTLE]   Auditability: Receipt enables offline third-party verification
sp-container  | [AUDIT] RECEIPT_GENERATED{receiptId=2f2b59ec-f305-4e40-90bd-21091897a189, chainId=a9983879-e6c8-4740-a245-0be261694b1f, reservationId=517b5f93-6d8e-497d-8cb0-cb661ed6d397}
sp-container  | Sent response: {
sp-container  |   "reservationId": "517b5f93-6d8e-497d-8cb0-cb661ed6d397",
sp-container  |   "chainId": "a9983879-e6c8-4740-a245-0be261694b1f",
sp-container  |   "remainingTokens": 0,
sp-container  |   "acceptedLastSpentIndex": 5,
sp-container  |   "tokensConsumed": 5,
sp-container  |   "paymentReceipt": {
sp-container  |     "hoIdentity": "HomeOwner",
sp-container  |     "reservationId": "517b5f93-6d8e-497d-8cb0-cb661ed6d397",
sp-container  |     "signatureAlg": "SHA256withRSA",
sp-container  |     "chainId": "a9983879-e6c8-4740-a245-0be261694b1f",
sp-container  |     "availabilityId": "4de265e1-73a6-473e-8ff0-9e927153a2d4",
sp-container  |     "newLastSpentIndex": 5,
sp-container  |     "spCertFingerprint": "92804F53851DED8FAD2989EC57023F4577AD3D0268D3E7D7A861828E3A28DDAD",
sp-container  |     "y": 5,
sp-container  |     "receiptId": "2f2b59ec-f305-4e40-90bd-21091897a189",
sp-container  |     "canonicalReceipt": "receiptId=2f2b59ec-f305-4e40-90bd-21091897a189|chainId=a9983879-e6c8-4740-a245-0be261694b1f|reservationId=517b5f93-6d8e-497d-8cb0-cb661ed6d397|availabilityId=4de265e1-73a6-473e-8ff0-9e927153a2d4|y=5|newLastSpentIndex=5|timestamp=2025-12-25T22:54:17.665169703Z|hoIdentity=HomeOwner",
sp-container  |     "receiptSignature": "G7+yL4+NzhsyUrUkoPBiYAQy7eVyaVx4YMV38mixNzzegjDzZbsYwPyF4B3BoPUEuUDKdhcdcDU4XhOTAGAepiJrWED7vJc4R8AAijhYcRVehWu5218YuK+Df7x/6r/y1vujnC3DOxseQYS8EJEUrzMvRz35rHifQaXzf/oxZa8205LdcLdlqtcwr8B/kH+fy4AhUwC5mcf2GlXuDmuNMyWOOh12qiOJ3k+Ea5hfzvuV+4PjJVbAAQZ1/q831E8QOypoGkr+puNUUYdLJFLYTK3vRyYfpPHZh6l4/bIkOrELDO8SRw3KDHM4FS2GX0bZ4JkW6Jf6UKH69ClBSD1Cug==",
sp-container  |     "timestamp": "2025-12-25T22:54:17.665169703Z"
sp-container  |   },
sp-container  |   "message": "Settlement accepted",
sp-container  |   "status": "success",
sp-container  |   "timestamp": "2025-12-25T22:54:17.665169703Z"
sp-container  | }
sp-container  | 
sp-container  | HomeOwner disconnected
