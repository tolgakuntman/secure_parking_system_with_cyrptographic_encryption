sp-container  | Waiting for CAuth to start...
sp-container  | 
sp-container  | === Service Provider Starting ===
sp-container  | Initializing cryptographic baseline...
sp-container  | 
sp-container  | No existing certificate found, enrolling with CAuth...
sp-container  | Step 1: Generating RSA key pair...
sp-container  | ✓ RSA-2048 key pair generated successfully
sp-container  | 
sp-container  | Step 2: Creating Certificate Signing Request (CSR)...
sp-container  | ✓ CSR created with subject: CN=ServiceProvider, O=Parking System, C=BE
sp-container  | 
sp-container  | Step 3: Connecting to CAuth server over TLS...
sp-container  | ✓ TLS connection established to CAuth
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   CAuth certificate verified:
sp-container  |     Subject: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  |     Issuer: CN=Root CA,O=National Authority,C=Country Code
sp-container  | 
sp-container  | → Sending CSR to CAuth for signing...
sp-container  | Received CA certificate from CAuth.
sp-container  | Received Root CA certificate from CAuth.
sp-container  | Certificate signed by CAuth!
sp-container  | ✓ Certificate received from CAuth
sp-container  | 
sp-container  | Step 4: Validating received certificate...
sp-container  |   ✓ Certificate is within validity period
sp-container  |     Valid from: Thu Dec 25 23:06:49 UTC 2025
sp-container  |     Valid until: Fri Dec 25 23:07:49 UTC 2026
sp-container  |   ✓ Certificate public key matches generated key pair
sp-container  |   Validating certificate chain (3 certificates):
sp-container  |     [0] C=BE,O=Parking System,CN=ServiceProvider
sp-container  |         Issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  |         ✓ Signature verified by issuer
sp-container  |     [1] CN=172.20.0.10,O=Private Parking,C=BE
sp-container  |         Issuer: CN=Root CA,O=National Authority,C=Country Code
sp-container  |         ✓ Signature verified by issuer
sp-container  |     [2] CN=Root CA,O=National Authority,C=Country Code
sp-container  |         Issuer: CN=Root CA,O=National Authority,C=Country Code
sp-container  |   ✓ Chain terminates at trusted Root CA: root_ca
sp-container  |   ✓ Certificate chain validation complete
sp-container  | ✓ Certificate chain validation successful
sp-container  | 
sp-container  | Step 5: Storing certificate and private key securely...
sp-container  | Storing certificate chain with 3 certificate(s)
sp-container  |   [0] C=BE,O=Parking System,CN=ServiceProvider
sp-container  |   [1] CN=172.20.0.10,O=Private Parking,C=BE
sp-container  |   [2] CN=Root CA,O=National Authority,C=Country Code
sp-container  | ✓ Credentials stored in ./keystore/sp_keystore.p12
sp-container  | 
sp-container  | ╔═══════════════════════════════════════════╗
sp-container  | ║   CRYPTOGRAPHIC IDENTITY ESTABLISHED     ║
sp-container  | ╚═══════════════════════════════════════════╝
sp-container  | Subject: C=BE,O=Parking System,CN=ServiceProvider
sp-container  | Issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Valid from: Thu Dec 25 23:06:49 UTC 2025
sp-container  | Valid until: Fri Dec 25 23:07:49 UTC 2026
sp-container  | Serial: 9989133C8438B9C1E3978B228864D53A
sp-container  | ✓ Certificate and private key verified
sp-container  | 
sp-container  | === Starting SP Server ===
sp-container  | 
sp-container  | === SP CRYPTOGRAPHIC BASELINE ESTABLISHED ===
sp-container  | Version: 2025-12-22 (Hardened TLS with mTLS enforcement)
sp-container  | ✓ Enabled TLS protocols: [TLSv1.3, TLSv1.2]
sp-container  | ✓ Strong cipher suites configured: 9 suites
sp-container  |  Mutual TLS (mTLS) REQUIRED - client certificates enforced
sp-container  | 
sp-container  | === TLS Server Configuration ===
sp-container  | Server listening on port: 8444
sp-container  | Server certificate subject: C=BE,O=Parking System,CN=ServiceProvider
sp-container  | Server certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Certificate serial: 9989133C8438B9C1E3978B228864D53A
sp-container  | Certificate algorithm: SHA256withRSA
sp-container  | Public key algorithm: RSA
sp-container  | RSA key size: 2048 bits
sp-container  | mTLS enforcement: ENABLED (client certificates REQUIRED)
sp-container  | 
sp-container  | ✓ SP Server ready to accept secure connections
sp-container  | ==========================================
sp-container  | 
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  C8C55CC4C2A176621D4DDD1A75E04A60
sp-container  | [SP]   SHA-256: 22016D2223C5DF720929361A9270F35C...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: HomeOwner
sp-container  | Client address: /172.20.0.12:51792
sp-container  | Client certificate subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: C8C55CC4C2A176621D4DDD1A75E04A60
sp-container  | Certificate valid from: Thu Dec 25 23:06:52 UTC 2025
sp-container  | Certificate valid until: Fri Dec 25 23:07:52 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: C0071FEF58F7F225...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from HomeOwner: {
sp-container  |   "priceTokens": 5,
sp-container  |   "metadata": {
sp-container  |     "spotType": "residential",
sp-container  |     "autoRenewal": false,
sp-container  |     "maxDuration": "8h"
sp-container  |   },
sp-container  |   "method": "publishAvailability",
sp-container  |   "spotId": "SPOT-A1",
sp-container  |   "locationZone": "Downtown-North",
sp-container  |   "homeOwnerId": "HO-001",
sp-container  |   "validFrom": "2025-12-25T23:07:53.013632803Z",
sp-container  |   "validTo": "2025-12-26T07:07:53.013632803Z"
sp-container  | }
sp-container  | 
sp-container  | === Publishing Parking Availability from HomeOwner ===
sp-container  |   Home Owner: HO-001
sp-container  |   Spot ID: SPOT-A1
sp-container  |   Valid: 2025-12-25T23:07:53.013632803Z to 2025-12-26T07:07:53.013632803Z
sp-container  |   Price: 5 tokens
sp-container  |   Location: Downtown-North
sp-container  | ✓ Availability stored with ID: d0c617e5-f301-43e9-8f0c-58181f1f3bf7
sp-container  | ✓ Total availabilities in system: 1
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "publishedAt": "2025-12-25T23:07:53.076446525Z",
sp-container  |   "availabilityId": "d0c617e5-f301-43e9-8f0c-58181f1f3bf7",
sp-container  |   "spotId": "SPOT-A1",
sp-container  |   "message": "Parking availability published successfully",
sp-container  |   "status": "success"
sp-container  | }
sp-container  | 
sp-container  | HomeOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  6AE783F864223402E287AE385FB49FFF
sp-container  | [SP]   SHA-256: 059035A27C24E1F0E65A5431DE3BEBB0...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: CarOwner
sp-container  | Client address: /172.20.0.13:53254
sp-container  | Client certificate subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 6AE783F864223402E287AE385FB49FFF
sp-container  | Certificate valid from: Thu Dec 25 23:06:57 UTC 2025
sp-container  | Certificate valid until: Fri Dec 25 23:07:57 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: BF18E6BA30388549...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from CarOwner: {"method": "getAvailability"}
sp-container  | 
sp-container  | === Availability Discovery Request from CarOwner ===
sp-container  |   Total availabilities in system: 1
sp-container  |   [d0c617e5-f301-43e9-8f0c-58181f1f3bf7] SPOT-A1 - 5 tokens (HO: HomeOwner)
sp-container  | ✓ Returned 1 availability record(s) to CarOwner
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "availabilities": [{
sp-container  |     "priceTokens": 5,
sp-container  |     "hoIdentity": "HomeOwner",
sp-container  |     "hoCertFingerprint": "22016D2223C5DF720929361A9270F35C6A32B5C20A4B8E20E58EE729FA2E6AAB",
sp-container  |     "availabilityId": "d0c617e5-f301-43e9-8f0c-58181f1f3bf7",
sp-container  |     "spotId": "SPOT-A1",
sp-container  |     "locationZone": "Downtown-North",
sp-container  |     "homeOwnerId": "HO-001",
sp-container  |     "hoCertificate": "-----BEGIN CERTIFICATE-----\nMIIEgTCCAmmgAwIBAgIRAMjFXMTCoXZiHU3dGnXgSmAwDQYJKoZIhvcNAQELBQAw\nPTELMAkGA1UEBhMCQkUxGDAWBgNVBAoTD1ByaXZhdGUgUGFya2luZzEUMBIGA1UE\nAxMLMTcyLjIwLjAuMTAwHhcNMjUxMjI1MjMwNjUyWhcNMjYxMjI1MjMwNzUyWjA6\nMQswCQYDVQQGEwJCRTEXMBUGA1UECgwOUGFya2luZyBTeXN0ZW0xEjAQBgNVBAMM\nCUhvbWVPd25lcjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANdqa2D7\nkgwbUJFEg+PD9+IfC/8cwIRxgeqL/DrBsDer4sTgf6lm39oEIPgtU4SRMY7lIKrF\nsh42kXFjFg3IjjjezmcL9L7BJiG2OeMLS3/lIl8jPqFmk7O8p1MDIyiXi6vKq4UP\na/rQpi6INj+J05N3AQ/PlkXppGk2XAg2Rs1KkTV8dfkpeaX+aKJAEVJdaY/UQWdE\n16dVfjoB71vl72xOCtGBt5B7nMWafctG7KLGS5bgqie4PJJVM6rxyex3WSQcxcqG\nR4en/RLVo3XM7j5m7cg1VQ74u52SNqvGG62RcsIV0jPRbMQKKhnGyZtn7w5FWkLQ\nBS5THNJQPR3qTD0CAwEAAaN/MH0wDAYDVR0TAQH/BAIwADAOBgNVHQ8BAf8EBAMC\nBaAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMB0GA1UdDgQWBBTb8q3R\nOnlcePrPYQcCY4ZigNQxDzAfBgNVHSMEGDAWgBTJHJ+uRQ8Qi6Ho497cqxNSoYei\nijANBgkqhkiG9w0BAQsFAAOCAgEAZsHG+KykCSztr2vLK+GPKm7LXGr7axiRODYP\nC2racC44LP6vDhaN6vSeRjvmcr4foukMm/tvV+y2AdFBxgOf4GG1XCAWstXgSjDF\ny1/WFs/kCY5zzh8ONqWhODa5snPGEhfSYL9+lqWRGU+BpKvD0amW8llgxQyEI0w6\nglGgSMWNI+J8le2x+79EZ1JL7l93XJMvruBUdon7cLUxUXW/hk3xyFCDR1n2meap\npiWdcAC0EZneUkD0wv5Oz4T4DWfVwKy0+3saXNRXEQirS3+vHVLPuUYF9IG6NEiS\nAiin4eE4TglyAb8myzCGC9RcyXqOdjHxyqbmCbnckE/6VCEss94RVS1OmQPo/Q1w\n18MbEOJjOloR+t9pZOl0c3iKGcLtpl0der1WrJRn0kfakP7MSaN2F5YH2oSZ+Z8R\nS2BiE2WyDOfEosWU7ZxLfoou8VJjnGNeTcu/ot2zgjtdJC2xmaD9aAGeQ7hlR0oX\nyI9mp30rE2Rtf8L3a/S5f6Z4EbBMydWUR1krUtDeiku5SCu6BpDqV2YQPnbKL8H7\nOAkC52CAC7phuF3w8fgQvg1AviUl7hNuuZT3wD2mPDGhu40YOakbvtRGw+Zv/MDc\nPUwkYxbWlmxSxFGbb34mkRlvuGj+iTsOdA+N3VTDo1aNzkdsi5HK+RuUJ28Yv3Vc\nazq6vEQ=\n-----END CERTIFICATE-----\n",
sp-container  |     "validFrom": "2025-12-25T23:07:53.013632803Z",
sp-container  |     "validTo": "2025-12-26T07:07:53.013632803Z"
sp-container  |   }],
sp-container  |   "count": 1,
sp-container  |   "status": "success",
sp-container  |   "timestamp": "2025-12-25T23:07:57.731272576Z"
sp-container  | }
sp-container  | 
sp-container  | CarOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  6AE783F864223402E287AE385FB49FFF
sp-container  | [SP]   SHA-256: 059035A27C24E1F0E65A5431DE3BEBB0...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: CarOwner
sp-container  | Client address: /172.20.0.13:53258
sp-container  | Client certificate subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 6AE783F864223402E287AE385FB49FFF
sp-container  | Certificate valid from: Thu Dec 25 23:06:57 UTC 2025
sp-container  | Certificate valid until: Fri Dec 25 23:07:57 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: 5040658E5B9F9B54...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from CarOwner: {
sp-container  |   "method": "requestTokens",
sp-container  |   "count": 5
sp-container  | }
sp-container  | 
sp-container  | === Generating 5 payment tokens for CarOwner ===
sp-container  | ✓ Generated secret s (32 bytes)
sp-container  | ✓ Generated hash chain of length 5
sp-container  |   Root H^5(s): C6AC9DBBD64A62A9...
sp-container  | ✓ Signed root with SP private key (256 bytes)
sp-container  | ✓ Stored chain metadata (ID: 085bcc71-ceb2-46d3-82b6-4e734bd74d82)
sp-container  | ✓ Token batch ready to send to CarOwner
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "tokenHashAlg": "SHA-256",
sp-container  |   "signatureAlg": "SHA256withRSA",
sp-container  |   "chainId": "085bcc71-ceb2-46d3-82b6-4e734bd74d82",
sp-container  |   "rootSignature": "XyiQGoiPIv8GoR6oIN6hiPXh/bV7xGODplkIso5ir8qlwzHZMyGlUwBVxQTn78nRklPMxaO227jIXXRO1AHuQoPAUH+Vdrj0GzBmJl4fYyXg+Ymtwq0L+xSs0eSBYEuM9VwSx9lyTsaYF4w0oEsMF5+ABi0k3WA3pn3cQjiydy6FGagborkkKdSSKlRYwSH5kKjncYDhIvtCsidcQA5kaDYiR0ph49cAHVC7srtoekHLdF3KOior7nXJZmK9V52eWJw1SIDx3+WaghGLBrxy+kSu6qebHd0LHso9g8DeIVQmv4FXDdHrwj8XdXhoRSEonsu9MlnVm9Hwh5hwUA0cgQ==",
sp-container  |   "root": "xqydu9ZKYqnd6y56T6pPcSISYHiCkkEwYJhwY7l6B3w=",
sp-container  |   "x": 5,
sp-container  |   "tokens": [
sp-container  |     "5+/zd7dz1nQuy8GeQYypwezHVolbP7sxjQByPd+kL30=",
sp-container  |     "6p3cyV+gZQEcN1UrtIPNxr53rMC5fC9e05gh3KO0wNc=",
sp-container  |     "J0Gaqunr28KXB/U/j7j4Iim6bRrToSWx9zPMEkFstEw=",
sp-container  |     "bS1Udkqm7rE16vaPyRzhgLY913+r3yi2TQbr62a91oY=",
sp-container  |     "xqydu9ZKYqnd6y56T6pPcSISYHiCkkEwYJhwY7l6B3w="
sp-container  |   ],
sp-container  |   "status": "success"
sp-container  | }
sp-container  | 
sp-container  | CarOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  C8C55CC4C2A176621D4DDD1A75E04A60
sp-container  | [SP]   SHA-256: 22016D2223C5DF720929361A9270F35C...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: HomeOwner
sp-container  | Client address: /172.20.0.12:51806
sp-container  | Client certificate subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: C8C55CC4C2A176621D4DDD1A75E04A60
sp-container  | Certificate valid from: Thu Dec 25 23:06:52 UTC 2025
sp-container  | Certificate valid until: Fri Dec 25 23:07:52 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: 13CEE03651996312...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from HomeOwner: {
sp-container  |   "startIndex": 0,
sp-container  |   "lastTokenSpent": "xqydu9ZKYqnd6y56T6pPcSISYHiCkkEwYJhwY7l6B3w=",
sp-container  |   "method": "settle",
sp-container  |   "reservationId": "6bc2b777-ad95-4c36-a69e-9944c5831c01",
sp-container  |   "chainId": "085bcc71-ceb2-46d3-82b6-4e734bd74d82",
sp-container  |   "availabilityId": "d0c617e5-f301-43e9-8f0c-58181f1f3bf7",
sp-container  |   "rootSignature": "XyiQGoiPIv8GoR6oIN6hiPXh/bV7xGODplkIso5ir8qlwzHZMyGlUwBVxQTn78nRklPMxaO227jIXXRO1AHuQoPAUH+Vdrj0GzBmJl4fYyXg+Ymtwq0L+xSs0eSBYEuM9VwSx9lyTsaYF4w0oEsMF5+ABi0k3WA3pn3cQjiydy6FGagborkkKdSSKlRYwSH5kKjncYDhIvtCsidcQA5kaDYiR0ph49cAHVC7srtoekHLdF3KOior7nXJZmK9V52eWJw1SIDx3+WaghGLBrxy+kSu6qebHd0LHso9g8DeIVQmv4FXDdHrwj8XdXhoRSEonsu9MlnVm9Hwh5hwUA0cgQ==",
sp-container  |   "root": "xqydu9ZKYqnd6y56T6pPcSISYHiCkkEwYJhwY7l6B3w=",
sp-container  |   "newLastSpentIndex": 5,
sp-container  |   "x": 5,
sp-container  |   "y": 5,
sp-container  |   "firstTokenSpent": "5+/zd7dz1nQuy8GeQYypwezHVolbP7sxjQByPd+kL30="
sp-container  | }
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] Settlement Request Received from HomeOwner
sp-container  | [SETTLE]   chainId: 085bcc71-ceb2-46d3-82b6-4e734bd74d82
sp-container  | [SETTLE]   reservationId: 6bc2b777-ad95-4c36-a69e-9944c5831c01
sp-container  | [SETTLE]   availabilityId: d0c617e5-f301-43e9-8f0c-58181f1f3bf7
sp-container  | [SETTLE]   y (tokens spent): 5
sp-container  | [SETTLE]   newLastSpentIndex: 5
sp-container  | [SETTLE]   x (chain length): 5
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] ✓ Cryptographic proof verified: token hashes to root
sp-container  | [SETTLE]   (hashed 0 times from last spent token to reach root)
sp-container  | [SETTLE] ✓✓✓ SETTLEMENT ACCEPTED ✓✓✓
sp-container  | [SETTLE]   chainId: 085bcc71-ceb2-46d3-82b6-4e734bd74d82
sp-container  | [SETTLE]   reservationId: 6bc2b777-ad95-4c36-a69e-9944c5831c01
sp-container  | [SETTLE]   Previous lastSpentIndex: 0
sp-container  | [SETTLE]   Updated lastSpentIndex: 5
sp-container  | [SETTLE]   Tokens consumed: 5
sp-container  | [SETTLE]   Remaining tokens: 0
sp-container  | [AUDIT] SETTLEMENT_ACCEPTED{chainId=085bcc71-ceb2-46d3-82b6-4e734bd74d82, oldIndex=0, newIndex=5, tokensSpent=5, reservationId=6bc2b777-ad95-4c36-a69e-9944c5831c01}
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] M3.4: Generating Cryptographically Verifiable Receipt
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] Canonical Receipt Data:
sp-container  | [SETTLE]   receiptId=beec5e6b-4399-4f83-b139-dbebc2a1dab1|chainId=085bcc71-ceb2-46d3-82b6-4e734bd74d82|reservationId=6bc2b777-ad95-4c36-a69e-9944c5831c01|availabilityId=d0c617e5-f301-43e9-8f0c-58181f1f3bf7|y=5|newLastSpentIndex=5|timestamp=2025-12-25T23:07:58.435047136Z|hoIdentity=HomeOwner
sp-container  | [SETTLE] ✓ Receipt signed with SP private key (RSA-2048)
sp-container  | [SETTLE]   Algorithm: SHA256withRSA
sp-container  | [SETTLE]   Signature length: 256 bytes
sp-container  | [SETTLE] ✓ SP certificate fingerprint: BEDC8C1EF9331B374782D1AE5D11D40E...
sp-container  | [SETTLE] ✓✓✓ PAYMENT RECEIPT GENERATED ✓✓✓
sp-container  | [SETTLE]   Receipt ID: beec5e6b-4399-4f83-b139-dbebc2a1dab1
sp-container  | [SETTLE]   Non-repudiation: SP signature binds finality to payment
sp-container  | [SETTLE]   Auditability: Receipt enables offline third-party verification
sp-container  | [AUDIT] RECEIPT_GENERATED{receiptId=beec5e6b-4399-4f83-b139-dbebc2a1dab1, chainId=085bcc71-ceb2-46d3-82b6-4e734bd74d82, reservationId=6bc2b777-ad95-4c36-a69e-9944c5831c01}
sp-container  | Sent response: {
sp-container  |   "reservationId": "6bc2b777-ad95-4c36-a69e-9944c5831c01",
sp-container  |   "chainId": "085bcc71-ceb2-46d3-82b6-4e734bd74d82",
sp-container  |   "remainingTokens": 0,
sp-container  |   "acceptedLastSpentIndex": 5,
sp-container  |   "tokensConsumed": 5,
sp-container  |   "paymentReceipt": {
sp-container  |     "hoIdentity": "HomeOwner",
sp-container  |     "reservationId": "6bc2b777-ad95-4c36-a69e-9944c5831c01",
sp-container  |     "signatureAlg": "SHA256withRSA",
sp-container  |     "chainId": "085bcc71-ceb2-46d3-82b6-4e734bd74d82",
sp-container  |     "availabilityId": "d0c617e5-f301-43e9-8f0c-58181f1f3bf7",
sp-container  |     "newLastSpentIndex": 5,
sp-container  |     "spCertFingerprint": "BEDC8C1EF9331B374782D1AE5D11D40EF1079CC3038644E72E33CCF2B1AB7AF4",
sp-container  |     "y": 5,
sp-container  |     "receiptId": "beec5e6b-4399-4f83-b139-dbebc2a1dab1",
sp-container  |     "canonicalReceipt": "receiptId=beec5e6b-4399-4f83-b139-dbebc2a1dab1|chainId=085bcc71-ceb2-46d3-82b6-4e734bd74d82|reservationId=6bc2b777-ad95-4c36-a69e-9944c5831c01|availabilityId=d0c617e5-f301-43e9-8f0c-58181f1f3bf7|y=5|newLastSpentIndex=5|timestamp=2025-12-25T23:07:58.435047136Z|hoIdentity=HomeOwner",
sp-container  |     "receiptSignature": "GV5l+M3u9wcJUQQz/Ar7ort3ZG/1iixxNDv1KRz4anmKhYCQw+4j5ZlQfE9CaGCW9EY8yp1rvZqdBSjSQH3BfJ3aNGPiWUL6WExcMrj+SJZ/1y9q/mrHLn4EelWEta/qkn4gmmvJ02NeNHzacxARIuX2zwDYcOaHfnmPtestV6iqtcp/vkxD58w3KvlbbTFNXb1ZSx0lVEHJCGKn30bFK6b+jJObBONW+yxZPZRkTAD5/yr/S9K8zjKBmqCeKVvHqiNJc0uky7CUEEzYrgq6RrV8Ej0rn5vwjoVPVj8bM72H4WdZstHFlXIwvL0zbbzAv0j3vMiYKIGu7bkLFGDfbA==",
sp-container  |     "timestamp": "2025-12-25T23:07:58.435047136Z"
sp-container  |   },
sp-container  |   "message": "Settlement accepted",
sp-container  |   "status": "success",
sp-container  |   "timestamp": "2025-12-25T23:07:58.435047136Z"
sp-container  | }
sp-container  | 
sp-container  | HomeOwner disconnected
