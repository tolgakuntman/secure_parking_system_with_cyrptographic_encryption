sp-container  | 
sp-container  | === Service Provider Starting ===
sp-container  | Initializing cryptographic baseline...
sp-container  | 
sp-container  | No existing certificate found, enrolling with CAuth...
sp-container  | Step 1: Generating RSA key pair...
sp-container  | ✓ RSA-2048 key pair generated successfully
sp-container  | 
sp-container  | Step 2: Creating Certificate Signing Request (CSR)...
sp-container  | ✓ CSR created with subject: CN=ServiceProvider, O=Parking System, C=BE
sp-container  | 
sp-container  | Step 3: Connecting to CAuth server over TLS...
sp-container  | ✓ TLS connection established to CAuth
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   CAuth certificate verified:
sp-container  |     Subject: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  |     Issuer: CN=Root CA,O=National Authority,C=Country Code
sp-container  | 
sp-container  | → Sending CSR to CAuth for signing...
sp-container  | Received CA certificate from CAuth.
sp-container  | Received Root CA certificate from CAuth.
sp-container  | Certificate signed by CAuth!
sp-container  | ✓ Certificate received from CAuth
sp-container  | 
sp-container  | Step 4: Validating received certificate...
sp-container  |   ✓ Certificate is within validity period
sp-container  |     Valid from: Thu Dec 25 23:01:13 UTC 2025
sp-container  |     Valid until: Fri Dec 25 23:02:13 UTC 2026
sp-container  |   ✓ Certificate public key matches generated key pair
sp-container  |   Validating certificate chain (3 certificates):
sp-container  |     [0] C=BE,O=Parking System,CN=ServiceProvider
sp-container  |         Issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  |         ✓ Signature verified by issuer
sp-container  |     [1] CN=172.20.0.10,O=Private Parking,C=BE
sp-container  |         Issuer: CN=Root CA,O=National Authority,C=Country Code
sp-container  |         ✓ Signature verified by issuer
sp-container  |     [2] CN=Root CA,O=National Authority,C=Country Code
sp-container  |         Issuer: CN=Root CA,O=National Authority,C=Country Code
sp-container  |   ✓ Chain terminates at trusted Root CA: root_ca
sp-container  |   ✓ Certificate chain validation complete
sp-container  | ✓ Certificate chain validation successful
sp-container  | 
sp-container  | Step 5: Storing certificate and private key securely...
sp-container  | Storing certificate chain with 3 certificate(s)
sp-container  |   [0] C=BE,O=Parking System,CN=ServiceProvider
sp-container  |   [1] CN=172.20.0.10,O=Private Parking,C=BE
sp-container  |   [2] CN=Root CA,O=National Authority,C=Country Code
sp-container  | ✓ Credentials stored in ./keystore/sp_keystore.p12
sp-container  | 
sp-container  | ╔═══════════════════════════════════════════╗
sp-container  | ║   CRYPTOGRAPHIC IDENTITY ESTABLISHED     ║
sp-container  | ╚═══════════════════════════════════════════╝
sp-container  | Subject: C=BE,O=Parking System,CN=ServiceProvider
sp-container  | Issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Valid from: Thu Dec 25 23:01:13 UTC 2025
sp-container  | Valid until: Fri Dec 25 23:02:13 UTC 2026
sp-container  | Serial: 9848A4BD73CEFC330E6D8E9425B94DCE
sp-container  | ✓ Certificate and private key verified
sp-container  | 
sp-container  | === Starting SP Server ===
sp-container  | 
sp-container  | === SP CRYPTOGRAPHIC BASELINE ESTABLISHED ===
sp-container  | Version: 2025-12-22 (Hardened TLS with mTLS enforcement)
sp-container  | ✓ Enabled TLS protocols: [TLSv1.3, TLSv1.2]
sp-container  | ✓ Strong cipher suites configured: 9 suites
sp-container  |  Mutual TLS (mTLS) REQUIRED - client certificates enforced
sp-container  | 
sp-container  | === TLS Server Configuration ===
sp-container  | Server listening on port: 8444
sp-container  | Server certificate subject: C=BE,O=Parking System,CN=ServiceProvider
sp-container  | Server certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Certificate serial: 9848A4BD73CEFC330E6D8E9425B94DCE
sp-container  | Certificate algorithm: SHA256withRSA
sp-container  | Public key algorithm: RSA
sp-container  | RSA key size: 2048 bits
sp-container  | mTLS enforcement: ENABLED (client certificates REQUIRED)
sp-container  | 
sp-container  | ✓ SP Server ready to accept secure connections
sp-container  | ==========================================
sp-container  | 
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  684582B0E8773D4DCAF598AC0FE74E80
sp-container  | [SP]   SHA-256: B229A59688B10B7CABBC6BE54D3EB7B5...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: HomeOwner
sp-container  | Client address: /172.20.0.12:36466
sp-container  | Client certificate subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 684582B0E8773D4DCAF598AC0FE74E80
sp-container  | Certificate valid from: Thu Dec 25 23:01:16 UTC 2025
sp-container  | Certificate valid until: Fri Dec 25 23:02:16 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: E599595E7854B296...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from HomeOwner: {
sp-container  |   "priceTokens": 5,
sp-container  |   "metadata": {
sp-container  |     "spotType": "residential",
sp-container  |     "autoRenewal": false,
sp-container  |     "maxDuration": "8h"
sp-container  |   },
sp-container  |   "method": "publishAvailability",
sp-container  |   "spotId": "SPOT-A1",
sp-container  |   "locationZone": "Downtown-North",
sp-container  |   "homeOwnerId": "HO-001",
sp-container  |   "validFrom": "2025-12-25T23:02:17.066938417Z",
sp-container  |   "validTo": "2025-12-26T07:02:17.066938417Z"
sp-container  | }
sp-container  | 
sp-container  | === Publishing Parking Availability from HomeOwner ===
sp-container  |   Home Owner: HO-001
sp-container  |   Spot ID: SPOT-A1
sp-container  |   Valid: 2025-12-25T23:02:17.066938417Z to 2025-12-26T07:02:17.066938417Z
sp-container  |   Price: 5 tokens
sp-container  |   Location: Downtown-North
sp-container  | ✓ Availability stored with ID: 340f449d-d405-49ec-b2e4-9606f78a2a69
sp-container  | ✓ Total availabilities in system: 1
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "publishedAt": "2025-12-25T23:02:17.127442853Z",
sp-container  |   "availabilityId": "340f449d-d405-49ec-b2e4-9606f78a2a69",
sp-container  |   "spotId": "SPOT-A1",
sp-container  |   "message": "Parking availability published successfully",
sp-container  |   "status": "success"
sp-container  | }
sp-container  | 
sp-container  | HomeOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  362E632A2925EB78FAD22FC30B34187A
sp-container  | [SP]   SHA-256: 7E5EBCCE3FFA616A8F400F899EDB52C4...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: CarOwner
sp-container  | Client address: /172.20.0.13:45302
sp-container  | Client certificate subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 362E632A2925EB78FAD22FC30B34187A
sp-container  | Certificate valid from: Thu Dec 25 23:01:22 UTC 2025
sp-container  | Certificate valid until: Fri Dec 25 23:02:22 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: 2A620606B024848A...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from CarOwner: {"method": "getAvailability"}
sp-container  | 
sp-container  | === Availability Discovery Request from CarOwner ===
sp-container  |   Total availabilities in system: 1
sp-container  |   [340f449d-d405-49ec-b2e4-9606f78a2a69] SPOT-A1 - 5 tokens (HO: HomeOwner)
sp-container  | ✓ Returned 1 availability record(s) to CarOwner
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "availabilities": [{
sp-container  |     "priceTokens": 5,
sp-container  |     "hoIdentity": "HomeOwner",
sp-container  |     "hoCertFingerprint": "B229A59688B10B7CABBC6BE54D3EB7B55D4377AC6AD0CA8131AC5E4E1D489A6D",
sp-container  |     "availabilityId": "340f449d-d405-49ec-b2e4-9606f78a2a69",
sp-container  |     "spotId": "SPOT-A1",
sp-container  |     "locationZone": "Downtown-North",
sp-container  |     "homeOwnerId": "HO-001",
sp-container  |     "hoCertificate": "-----BEGIN CERTIFICATE-----\nMIIEgDCCAmigAwIBAgIQaEWCsOh3PU3K9ZisD+dOgDANBgkqhkiG9w0BAQsFADA9\nMQswCQYDVQQGEwJCRTEYMBYGA1UEChMPUHJpdmF0ZSBQYXJraW5nMRQwEgYDVQQD\nEwsxNzIuMjAuMC4xMDAeFw0yNTEyMjUyMzAxMTZaFw0yNjEyMjUyMzAyMTZaMDox\nCzAJBgNVBAYTAkJFMRcwFQYDVQQKDA5QYXJraW5nIFN5c3RlbTESMBAGA1UEAwwJ\nSG9tZU93bmVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAsa8NWMN3\noYVYGjVISiFEVUISo1njiGJlda8kbT4X2mUXVf1GQ9KC7WDNQvkpLEsxDsLm89U9\nOXxo+eQwCVIPIGdHZPBGG1MDghhFz/V571wg97i7NdirTnpLI9WLGMxyq17RtuHH\nlVOPsd2Nwc9/cHXSbnQniLeMJ/mM8KI/L7W0ocY+qoBE0Bf84Ny/9A7adEvAJ9Em\nNKh2liNRKs5zcchuVDXhAUtgPL/1B9flbUPdp6R5Xhsody5t8D0MO1SW4W2LN7/B\nmY2rOUXmoBHfIfDEcHM6MO7qKFfMN1yvk5MjmB+BtNGpso5udHQGZPRpNkdbDB6B\nDURBO50fEliINQIDAQABo38wfTAMBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIF\noDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwHQYDVR0OBBYEFJfSnj0U\nTiU6axXFdSh/K0TkQdKfMB8GA1UdIwQYMBaAFMkcn65FDxCLoejj3tyrE1Khh6KK\nMA0GCSqGSIb3DQEBCwUAA4ICAQCWjKUyCYOPfaSGgtZmn667v2Sph85dSN+bQVUa\n/7hcjfJF7JqBPWOSsQq6un4fiaJ1gARIDc1Ho3SF8xNpdepS4wfMRoaewDDKFoHm\ndxj8xnt+xFKPLgjE49RnJvilfaO/qCqZ/YohteXshKgXq4shE6nvSvH/RIN1qP2s\nsxL+a8yvIGYgaQtIMPul/Oca9/qcL76k2bnXHpeCBoaP/xlKvBGyntZ1LqAj2WKa\nFPr5h+RD7VjTzVW0DVMej/Kvhrrl6hg+lr/+LlJwuFVkXgwjLOhqrq0mO3Za1kiT\n/rfl7/sqI29wDioRar1thfi4oFuuGP+KJAONpEsKthIYLvAeoyk2Gxfl0aixY6Op\net6byCKj0DKe1HZziqT0HgRzdvlAmT1JHifTkucgLMz4OhdAYJXekxvGQR5wrBYF\n/Dqc//GJNbhMYMrJRKxukuaQHWiPf8YnVQbPD1byjsqS0yHmT4CuK7dWG9qpYXj9\nvYqTC7/Uwc+yYMPIiJ5p+2mBqcPGMOZ6hIM4bnIuq5LuY1meynSXXwjbXhcGISCa\n6xJb2SZuWn6ZtvWX0pTNsR9tUTGpmkJgJXrRMzz8jC7egDojuYev7DlYVRADXgJT\n4v5TBurGvIyNblo1j2LBI8rgyR8+OKm1sOLg9KRkGnS3NIuxfolKjn+M9YkxvcUI\nHfLxEg==\n-----END CERTIFICATE-----\n",
sp-container  |     "validFrom": "2025-12-25T23:02:17.066938417Z",
sp-container  |     "validTo": "2025-12-26T07:02:17.066938417Z"
sp-container  |   }],
sp-container  |   "count": 1,
sp-container  |   "status": "success",
sp-container  |   "timestamp": "2025-12-25T23:02:22.414625429Z"
sp-container  | }
sp-container  | 
sp-container  | CarOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  362E632A2925EB78FAD22FC30B34187A
sp-container  | [SP]   SHA-256: 7E5EBCCE3FFA616A8F400F899EDB52C4...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: CarOwner
sp-container  | Client address: /172.20.0.13:45312
sp-container  | Client certificate subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 362E632A2925EB78FAD22FC30B34187A
sp-container  | Certificate valid from: Thu Dec 25 23:01:22 UTC 2025
sp-container  | Certificate valid until: Fri Dec 25 23:02:22 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: 47797635021BF26F...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from CarOwner: {
sp-container  |   "method": "requestTokens",
sp-container  |   "count": 5
sp-container  | }
sp-container  | 
sp-container  | === Generating 5 payment tokens for CarOwner ===
sp-container  | ✓ Generated secret s (32 bytes)
sp-container  | ✓ Generated hash chain of length 5
sp-container  |   Root H^5(s): DF8E27A5866463A9...
sp-container  | ✓ Signed root with SP private key (256 bytes)
sp-container  | ✓ Stored chain metadata (ID: a4f67f53-f8e3-47eb-b402-c3545de80f55)
sp-container  | ✓ Token batch ready to send to CarOwner
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "tokenHashAlg": "SHA-256",
sp-container  |   "signatureAlg": "SHA256withRSA",
sp-container  |   "chainId": "a4f67f53-f8e3-47eb-b402-c3545de80f55",
sp-container  |   "rootSignature": "FAUAERmTrIbxerzH07+iaVQ3zHdWIU5ebvKxBL/3duD4AKU6uK/FsRjHGEj0Vle4aAoKw6cRzDalVyiqkO6Qa8Q9SoxRoEexdntbfKd7noR+B4dugI1yQBAYzoELGY8sEnbpEHFlOBgpjtgd34Pj7whhSOgTizz4SftxJF0k/biVB5N96e8rrkGZbAexEQJRv0KJFOWEEQd6x0y3kqRRL3PMWPWdXtFGw6u3JnccTzGyq0PV5dk0py9fuJLMvGBgZ0OL0O7ZMWFs6i+Wd4YuPgCf/FQ5l8cNe3M3vdjz/UFGcmUlGT4++UwYQib/Xuu2Uv2DIcbvw+vD/0DfEOH8Fw==",
sp-container  |   "root": "344npYZkY6lxJXVULdEGyDYhzZa24X9s6rrBY08A8XY=",
sp-container  |   "x": 5,
sp-container  |   "tokens": [
sp-container  |     "yvT8zPVBrGaCE3HEpvVvSJbRB7jAsqAhd95R6K8FIKw=",
sp-container  |     "VJn2ZRsOde8tbSKYrGfgzD0UQ3rFQByG0B19bJqZLBY=",
sp-container  |     "Dk62S8IoQWMBH6GLLRbmGcgMkDJlDONGbGc8yTkRkSs=",
sp-container  |     "Do2UY9oi2v59ca28iuhtjlMJ2pmhwscwzcW5ZY0Xup0=",
sp-container  |     "344npYZkY6lxJXVULdEGyDYhzZa24X9s6rrBY08A8XY="
sp-container  |   ],
sp-container  |   "status": "success"
sp-container  | }
sp-container  | 
sp-container  | CarOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  684582B0E8773D4DCAF598AC0FE74E80
sp-container  | [SP]   SHA-256: B229A59688B10B7CABBC6BE54D3EB7B5...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: HomeOwner
sp-container  | Client address: /172.20.0.12:49234
sp-container  | Client certificate subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 684582B0E8773D4DCAF598AC0FE74E80
sp-container  | Certificate valid from: Thu Dec 25 23:01:16 UTC 2025
sp-container  | Certificate valid until: Fri Dec 25 23:02:16 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: 8F3EB69CD74A203A...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from HomeOwner: {
sp-container  |   "startIndex": 0,
sp-container  |   "lastTokenSpent": "344npYZkY6lxJXVULdEGyDYhzZa24X9s6rrBY08A8XY=",
sp-container  |   "method": "settle",
sp-container  |   "reservationId": "916ebf59-372b-4441-8549-9ec3a67720f9",
sp-container  |   "chainId": "a4f67f53-f8e3-47eb-b402-c3545de80f55",
sp-container  |   "availabilityId": "340f449d-d405-49ec-b2e4-9606f78a2a69",
sp-container  |   "rootSignature": "FAUAERmTrIbxerzH07+iaVQ3zHdWIU5ebvKxBL/3duD4AKU6uK/FsRjHGEj0Vle4aAoKw6cRzDalVyiqkO6Qa8Q9SoxRoEexdntbfKd7noR+B4dugI1yQBAYzoELGY8sEnbpEHFlOBgpjtgd34Pj7whhSOgTizz4SftxJF0k/biVB5N96e8rrkGZbAexEQJRv0KJFOWEEQd6x0y3kqRRL3PMWPWdXtFGw6u3JnccTzGyq0PV5dk0py9fuJLMvGBgZ0OL0O7ZMWFs6i+Wd4YuPgCf/FQ5l8cNe3M3vdjz/UFGcmUlGT4++UwYQib/Xuu2Uv2DIcbvw+vD/0DfEOH8Fw==",
sp-container  |   "root": "344npYZkY6lxJXVULdEGyDYhzZa24X9s6rrBY08A8XY=",
sp-container  |   "newLastSpentIndex": 5,
sp-container  |   "x": 5,
sp-container  |   "y": 5,
sp-container  |   "firstTokenSpent": "yvT8zPVBrGaCE3HEpvVvSJbRB7jAsqAhd95R6K8FIKw="
sp-container  | }
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] Settlement Request Received from HomeOwner
sp-container  | [SETTLE]   chainId: a4f67f53-f8e3-47eb-b402-c3545de80f55
sp-container  | [SETTLE]   reservationId: 916ebf59-372b-4441-8549-9ec3a67720f9
sp-container  | [SETTLE]   availabilityId: 340f449d-d405-49ec-b2e4-9606f78a2a69
sp-container  | [SETTLE]   y (tokens spent): 5
sp-container  | [SETTLE]   newLastSpentIndex: 5
sp-container  | [SETTLE]   x (chain length): 5
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] ✓ Cryptographic proof verified: token hashes to root
sp-container  | [SETTLE]   (hashed 0 times from last spent token to reach root)
sp-container  | [SETTLE] ✓✓✓ SETTLEMENT ACCEPTED ✓✓✓
sp-container  | [SETTLE]   chainId: a4f67f53-f8e3-47eb-b402-c3545de80f55
sp-container  | [SETTLE]   reservationId: 916ebf59-372b-4441-8549-9ec3a67720f9
sp-container  | [SETTLE]   Previous lastSpentIndex: 0
sp-container  | [SETTLE]   Updated lastSpentIndex: 5
sp-container  | [SETTLE]   Tokens consumed: 5
sp-container  | [SETTLE]   Remaining tokens: 0
sp-container  | [AUDIT] SETTLEMENT_ACCEPTED{chainId=a4f67f53-f8e3-47eb-b402-c3545de80f55, oldIndex=0, newIndex=5, tokensSpent=5, reservationId=916ebf59-372b-4441-8549-9ec3a67720f9}
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] M3.4: Generating Cryptographically Verifiable Receipt
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] Canonical Receipt Data:
sp-container  | [SETTLE]   receiptId=a48a378f-a830-4801-acce-521fc9e5a5bf|chainId=a4f67f53-f8e3-47eb-b402-c3545de80f55|reservationId=916ebf59-372b-4441-8549-9ec3a67720f9|availabilityId=340f449d-d405-49ec-b2e4-9606f78a2a69|y=5|newLastSpentIndex=5|timestamp=2025-12-25T23:02:23.172762881Z|hoIdentity=HomeOwner
sp-container  | [SETTLE] ✓ Receipt signed with SP private key (RSA-2048)
sp-container  | [SETTLE]   Algorithm: SHA256withRSA
sp-container  | [SETTLE]   Signature length: 256 bytes
sp-container  | [SETTLE] ✓ SP certificate fingerprint: 964EF3CA95A091FFFAB1632C031D6F1F...
sp-container  | [SETTLE] ✓✓✓ PAYMENT RECEIPT GENERATED ✓✓✓
sp-container  | [SETTLE]   Receipt ID: a48a378f-a830-4801-acce-521fc9e5a5bf
sp-container  | [SETTLE]   Non-repudiation: SP signature binds finality to payment
sp-container  | [SETTLE]   Auditability: Receipt enables offline third-party verification
sp-container  | [AUDIT] RECEIPT_GENERATED{receiptId=a48a378f-a830-4801-acce-521fc9e5a5bf, chainId=a4f67f53-f8e3-47eb-b402-c3545de80f55, reservationId=916ebf59-372b-4441-8549-9ec3a67720f9}
sp-container  | Sent response: {
sp-container  |   "reservationId": "916ebf59-372b-4441-8549-9ec3a67720f9",
sp-container  |   "chainId": "a4f67f53-f8e3-47eb-b402-c3545de80f55",
sp-container  |   "remainingTokens": 0,
sp-container  |   "acceptedLastSpentIndex": 5,
sp-container  |   "tokensConsumed": 5,
sp-container  |   "paymentReceipt": {
sp-container  |     "hoIdentity": "HomeOwner",
sp-container  |     "reservationId": "916ebf59-372b-4441-8549-9ec3a67720f9",
sp-container  |     "signatureAlg": "SHA256withRSA",
sp-container  |     "chainId": "a4f67f53-f8e3-47eb-b402-c3545de80f55",
sp-container  |     "availabilityId": "340f449d-d405-49ec-b2e4-9606f78a2a69",
sp-container  |     "newLastSpentIndex": 5,
sp-container  |     "spCertFingerprint": "964EF3CA95A091FFFAB1632C031D6F1FDD957539DBAFCF361A7B265A2B2D4961",
sp-container  |     "y": 5,
sp-container  |     "receiptId": "a48a378f-a830-4801-acce-521fc9e5a5bf",
sp-container  |     "canonicalReceipt": "receiptId=a48a378f-a830-4801-acce-521fc9e5a5bf|chainId=a4f67f53-f8e3-47eb-b402-c3545de80f55|reservationId=916ebf59-372b-4441-8549-9ec3a67720f9|availabilityId=340f449d-d405-49ec-b2e4-9606f78a2a69|y=5|newLastSpentIndex=5|timestamp=2025-12-25T23:02:23.172762881Z|hoIdentity=HomeOwner",
sp-container  |     "receiptSignature": "oCys1Qv3zopSXvizf7dc+JRG0v/3Q30I/zIiqKd5XunwWlPZE+uWdYdfw3r5iuj86DZZvk1xWSSfvd9IoDhGzKiDkB53Gq36dj0UCDlWRYYjQZ+YWcUoMxOFW6evA22E3hgAlOkj0e6GQimbvMFm3779nf3z/8R9IoFXq6edfsUX7mdpUQNDbh4RxCPe2gmK7qT217LmXpYEY3TwtHoSXA+dk80YB1YWNWQu6oxro3JclegywjT8mEXTprEjLq3nrCBZ18CZktUqppAVCvnHOGWQ74qMpzgb+rR/uF54ltHtW6czH5A/KmPDjC1c6bwFGTK97YDTxe4URX5S5ghk/Q==",
sp-container  |     "timestamp": "2025-12-25T23:02:23.172762881Z"
sp-container  |   },
sp-container  |   "message": "Settlement accepted",
sp-container  |   "status": "success",
sp-container  |   "timestamp": "2025-12-25T23:02:23.172762881Z"
sp-container  | }
sp-container  | 
sp-container  | HomeOwner disconnected
