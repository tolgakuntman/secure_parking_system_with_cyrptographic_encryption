ho-container  | 
ho-container  | === Inbound Reservation Request ===
ho-container  | 
ho-container  | ║   CO AUTHENTICATED VIA mTLS               ║
ho-container  | CO CN: CarOwner
ho-container  | CO address: /172.20.0.13:33794
ho-container  | CO certificate subject: C=BE,O=Parking System,CN=CarOwner
ho-container  | CO certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
ho-container  | CO certificate serial: 566F389741FA013C23384A518B2EC6F8
ho-container  | 
ho-container  | TLS Session Details:
ho-container  |   Protocol: TLSv1.3
ho-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
ho-container  | ═══════════════════════════════════════════
ho-container  | 
ho-container  | Received request from CarOwner:
ho-container  | {
ho-container  |   "priceTokens": 5,
ho-container  |   "method": "requestReservation",
ho-container  |   "availabilityId": "4de265e1-73a6-473e-8ff0-9e927153a2d4",
ho-container  |   "spotId": "SPOT-A1",
ho-container  |   "validFrom": "2025-12-25T22:54:11.920735980Z",
ho-container  |   "validTo": "2025-12-26T06:54:11.920735980Z",
ho-container  |   "coIdentity": "CarOwner"
ho-container  | }
ho-container  | 
ho-container  | === Processing Reservation Request (Milestone 2.4) ===
ho-container  |   Availability ID: 4de265e1-73a6-473e-8ff0-9e927153a2d4
ho-container  |   Spot ID: SPOT-A1
ho-container  |   Valid: 2025-12-25T22:54:11.920735980Z to 2025-12-26T06:54:11.920735980Z
ho-container  |   Price: 5 tokens
ho-container  |   Requested CO Identity: CarOwner
ho-container  | ✓ CO identity verified: CarOwner
ho-container  | ✓ Availability ID matches published availability
ho-container  | Generated Reservation ID: 86e82aff-de48-4292-9f8c-9ac2659dbff5
ho-container  | 
ho-container  | ─ Generating Cryptographic Signature ─
ho-container  | Canonical data to sign:
ho-container  |   reservationId=86e82aff-de48-4292-9f8c-9ac2659dbff5|verdict=OK|availabilityId=4de265e1-73a6-473e-8ff0-9e927153a2d4|spotId=SPOT-A1|validFrom=2025-12-25T22:54:11.920735980Z|validTo=2025-12-26T06:54:11.920735980Z|priceTokens=5|coIdentity=CarOwner
ho-container  | ✓ Signature generated with HO private key
ho-container  |   Algorithm: SHA256withRSA
ho-container  |   Signature length: 256 bytes
ho-container  |   Signature (Base64): BfUd7Shpm9cpewYhRUWBBe/2WjnneblJ...
ho-container  | 
ho-container  | ╔═══════════════════════════════════════════════════════════╗
ho-container  | ║   RESERVATION DECISION: OK
ho-container  | ╚═══════════════════════════════════════════════════════════╝
ho-container  | Reservation ID: 86e82aff-de48-4292-9f8c-9ac2659dbff5
ho-container  | CO Identity: CarOwner
ho-container  | ✓ Cryptographic signature binds HO to this decision
ho-container  | ✓ Non-repudiable authorization established
ho-container  | 
ho-container  | Sent signed reservation response:
ho-container  | {
ho-container  |   "hoIdentity": "HomeOwner",
ho-container  |   "reservationId": "86e82aff-de48-4292-9f8c-9ac2659dbff5",
ho-container  |   "signatureAlg": "SHA256withRSA",
ho-container  |   "signature": "BfUd7Shpm9cpewYhRUWBBe/2WjnneblJOd3FBMCI5GGhbbo3t2V/v4FtC9GVgUqYfUXPij+sdWL/k77nkYwrlZ98Bnt9rNFD/qPEDRtnwk3zm7bXo9DbhUdP+hE8uUJGHbDtca9OJ7GLWvNs7ysstDSQzty1DJrMfawbPm0f6NwO9N822YiwMdXl8jIk+jLDFhRsAWa8Jg3qwg1pnAd4IR5cBeAyFCK0twCW9EmkMc9mpTR8w2HYSqauPPA5TnI/oraPqq9hy259UEmOBMALUCAMVkfguLbvap7jOPVXKFbKThnILik6lfUcQjM60whaV/4+bVt2fiDjIh2tDcPwXg==",
ho-container  |   "signedData": "reservationId=86e82aff-de48-4292-9f8c-9ac2659dbff5|verdict=OK|availabilityId=4de265e1-73a6-473e-8ff0-9e927153a2d4|spotId=SPOT-A1|validFrom=2025-12-25T22:54:11.920735980Z|validTo=2025-12-26T06:54:11.920735980Z|priceTokens=5|coIdentity=CarOwner",
ho-container  |   "verdict": "OK",
ho-container  |   "status": "success"
ho-container  | }
ho-container  | 
ho-container  | CarOwner disconnected
ho-container  | 
ho-container  | 
ho-container  | === Inbound Reservation Request ===
ho-container  | 
ho-container  | ║   CO AUTHENTICATED VIA mTLS               ║
ho-container  | CO CN: CarOwner
ho-container  | CO address: /172.20.0.13:33800
ho-container  | CO certificate subject: C=BE,O=Parking System,CN=CarOwner
ho-container  | CO certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
ho-container  | CO certificate serial: 566F389741FA013C23384A518B2EC6F8
ho-container  | 
ho-container  | TLS Session Details:
ho-container  |   Protocol: TLSv1.3
ho-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
ho-container  | ═══════════════════════════════════════════
ho-container  | 
ho-container  | Received request from CarOwner:
ho-container  | {
ho-container  |   "startIndex": 0,
ho-container  |   "method": "pay",
ho-container  |   "reservationId": "86e82aff-de48-4292-9f8c-9ac2659dbff5",
ho-container  |   "chainId": "c122d7a2-3e12-4f04-8f58-48fc89854f91",
ho-container  |   "rootSignature": "X7rccwvYum8CPOaeflXw/EXVfKcCMXbjftZ79cNqip5gxchhCYIb5EkSAhjLNsmST6NdeRMoZ0bzrfnJsNxQZioL+hotFuxdcCKFWzRL37Q1g45cPRLJMrmReaqjgf3BhglUY/RDrKAg1roIawCEflQ16uMc36Kqqn/+eRMWOrYbTYPTBzpSmrvraRRJQAnki2bWHidWaO1G5twuwpgB0sAlmMA771i5cvPaAGv+U2Er2kkPfykepZXyeJC0zx0Vq//ipvcolGop2y2TXezZ/aFM3SKFR+9vRY3gAbYSPT1ozraKUKwms4k45JLv/2cB74P4W06tEAwU5w/F/45ZrQ==",
ho-container  |   "root": "KqOmLP35ZSJQD9f2feMKsZYKFK4z3BXH7mNxzvdyJ4E=",
ho-container  |   "x": 5,
ho-container  |   "tokensToSpend": [
ho-container  |     "yMhaSUrD40j+O8zk9lDC80T2L3ql87UYhru0NRWO/Wg=",
ho-container  |     "EckH1v4IoA0/aNuBz9PzWVi1AABdZC8Z5uU3KtqlYb4=",
ho-container  |     "0IGVVUGM6BZ7rGNkCnZzqcvbE3anepxBlKB72GicUTs=",
ho-container  |     "ghAz/ewgoVknHfDPWpa/RTOIKAIP1/Z6UT/xlFiW3qk=",
ho-container  |     "KqOmLP35ZSJQD9f2feMKsZYKFK4z3BXH7mNxzvdyJ4E="
ho-container  |   ]
ho-container  | }
ho-container  | [M3.2] root signature verified via cached SP public key
ho-container  | [M3.2] policy checks passed (reservation verdict OK, token count matches)
ho-container  | [M4] REJECTED: adjacency check failed at i=0 (possible token tampering)
ho-container  | 
ho-container  | Sent pay response:
ho-container  | {
ho-container  |   "reason": "security_violation",
ho-container  |   "code": "token_tampering_detected",
ho-container  |   "message": "adjacency check failed at i=0 - possible token tampering",
ho-container  |   "status": "error"
ho-container  | }
ho-container  | 
ho-container  | CarOwner disconnected
ho-container  | 
