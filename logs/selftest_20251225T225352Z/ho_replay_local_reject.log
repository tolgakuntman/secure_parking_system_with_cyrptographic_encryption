ho-container  | Waiting for CAuth and SP to start...
ho-container  | 
ho-container  | === Home Owner (HO) Starting ===
ho-container  | Found existing certificate, loading from keystore...
ho-container  | ✓ Certificate validity period verified
ho-container  | 
ho-container  | ╔═══════════════════════════════════════════╗
ho-container  | ║   HO CRYPTOGRAPHIC IDENTITY ESTABLISHED   ║
ho-container  | ╚═══════════════════════════════════════════╝
ho-container  | Subject: CN=HomeOwner,O=Parking System,C=BE
ho-container  | Issuer: CN=172.20.0.10,O=Private Parking,C=BE
ho-container  | Valid from: Thu Dec 25 22:53:11 UTC 2025
ho-container  | Valid until: Fri Dec 25 22:54:11 UTC 2026
ho-container  | 
ho-container  | === Publishing Parking Availability to SP ===
ho-container  | ✓ mTLS connection to SP established
ho-container  |   Protocol: TLSv1.3
ho-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
ho-container  |   SP certificate: C=BE,O=Parking System,CN=ServiceProvider
ho-container  | [M3.2] SP public key cached from mTLS handshake
ho-container  | 
ho-container  | → Publishing availability to SP...
ho-container  |   Spot ID: SPOT-A1
ho-container  |   Valid from: 2025-12-25T22:54:48.700832152Z
ho-container  |   Valid to: 2025-12-26T06:54:48.700832152Z
ho-container  |   Price: 5 tokens
ho-container  |   Location: Downtown-North
ho-container  | 
ho-container  | ← Received response from SP
ho-container  | 
ho-container  | ╔═══════════════════════════════════════════╗
ho-container  | ║   AVAILABILITY PUBLISHED SUCCESSFULLY     ║
ho-container  | ╚═══════════════════════════════════════════╝
ho-container  | Availability ID: 73a60274-8fc9-4869-aa4d-10ec379b7a42
ho-container  | Message: Parking availability published successfully
ho-container  | 
ho-container  | === Starting HO Reservation & Payment Server ===
ho-container  | 
ho-container  | ╔═══════════════════════════════════════════════════════════╗
ho-container  | ║   HO RESERVATION SERVER CRYPTOGRAPHIC BASELINE           ║
ho-container  | ╚═══════════════════════════════════════════════════════════╝
ho-container  | Version: 2025-12-22 (Milestone 2.4 - Reservation Handshake)
ho-container  | ✓ Enabled TLS protocols: [TLSv1.3, TLSv1.2]
ho-container  | ✓ Mutual TLS (mTLS) REQUIRED - client certificates enforced
ho-container  | 
ho-container  | === HO Reservation Server Configuration ===
ho-container  | Server listening on port: 8445
ho-container  | Server certificate subject: CN=HomeOwner,O=Parking System,C=BE
ho-container  | Server certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
ho-container  | RSA key size: 2048 bits
ho-container  | Signature algorithm: SHA256withRSA
ho-container  | mTLS enforcement: ENABLED (CO certificates REQUIRED)
ho-container  | 
ho-container  | ✓ HO Reservation Server ready to accept secure connections
ho-container  | ==========================================
ho-container  | 
ho-container  | 
ho-container  | === Inbound Reservation Request ===
ho-container  | 
ho-container  | ║   CO AUTHENTICATED VIA mTLS               ║
ho-container  | CO CN: CarOwner
ho-container  | CO address: /172.20.0.13:50824
ho-container  | CO certificate subject: C=BE,O=Parking System,CN=CarOwner
ho-container  | CO certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
ho-container  | CO certificate serial: 566F389741FA013C23384A518B2EC6F8
ho-container  | 
ho-container  | TLS Session Details:
ho-container  |   Protocol: TLSv1.3
ho-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
ho-container  | ═══════════════════════════════════════════
ho-container  | 
ho-container  | Received request from CarOwner:
ho-container  | {
ho-container  |   "priceTokens": 5,
ho-container  |   "method": "requestReservation",
ho-container  |   "availabilityId": "4de265e1-73a6-473e-8ff0-9e927153a2d4",
ho-container  |   "spotId": "SPOT-A1",
ho-container  |   "validFrom": "2025-12-25T22:54:11.920735980Z",
ho-container  |   "validTo": "2025-12-26T06:54:11.920735980Z",
ho-container  |   "coIdentity": "CarOwner"
ho-container  | }
ho-container  | 
ho-container  | === Processing Reservation Request (Milestone 2.4) ===
ho-container  |   Availability ID: 4de265e1-73a6-473e-8ff0-9e927153a2d4
ho-container  |   Spot ID: SPOT-A1
ho-container  |   Valid: 2025-12-25T22:54:11.920735980Z to 2025-12-26T06:54:11.920735980Z
ho-container  |   Price: 5 tokens
ho-container  |   Requested CO Identity: CarOwner
ho-container  | ✓ CO identity verified: CarOwner
ho-container  | ⚠ Availability ID does not match published availability
ho-container  | Generated Reservation ID: 2dc81a7e-d8a4-45d4-a7d6-2e8b41873dcf
ho-container  | 
ho-container  | ─ Generating Cryptographic Signature ─
ho-container  | Canonical data to sign:
ho-container  |   reservationId=2dc81a7e-d8a4-45d4-a7d6-2e8b41873dcf|verdict=NOT_OK|availabilityId=4de265e1-73a6-473e-8ff0-9e927153a2d4|spotId=SPOT-A1|validFrom=2025-12-25T22:54:11.920735980Z|validTo=2025-12-26T06:54:11.920735980Z|priceTokens=5|coIdentity=CarOwner
ho-container  | ✓ Signature generated with HO private key
ho-container  |   Algorithm: SHA256withRSA
ho-container  |   Signature length: 256 bytes
ho-container  |   Signature (Base64): WdxGx2HqpW0XimoNqFQCappXszBTloHe...
ho-container  | 
ho-container  | ╔═══════════════════════════════════════════════════════════╗
ho-container  | ║   RESERVATION DECISION: NOT_OK
ho-container  | ╚═══════════════════════════════════════════════════════════╝
ho-container  | Reservation ID: 2dc81a7e-d8a4-45d4-a7d6-2e8b41873dcf
ho-container  | CO Identity: CarOwner
ho-container  | ✓ Cryptographic signature binds HO to this decision
ho-container  | ✓ Non-repudiable authorization established
ho-container  | 
ho-container  | Sent signed reservation response:
ho-container  | {
ho-container  |   "hoIdentity": "HomeOwner",
ho-container  |   "reservationId": "2dc81a7e-d8a4-45d4-a7d6-2e8b41873dcf",
ho-container  |   "signatureAlg": "SHA256withRSA",
ho-container  |   "signature": "WdxGx2HqpW0XimoNqFQCappXszBTloHeLUCAe0SjNEHWenSoBWJ63az7cYG1xCjuf+LDATVze1s6Xbcqxy9h0QEUivXsT/ZgF1fd70nS2ZrfHShM6o96maGf0hfJoGVv0s6bcvDrxPuXzpWweooUVyiPERYc3tfOdrTq1LLx4U3Df3Nh2aC6KUL/6VtvvE9Th4UV1zciGO+KIit1QddhoFrvLHcLi+9gtllxgwEEIhwo/IgaL8VtE5Zz3Z5VnSexV+ZlaAJ47hphi5yKC9FFk5ja320ktqC0g/5ek5YcKRPBB023CTNTmxJnmvSU0PKzClBGw1o51os9ehR6O+OEbw==",
ho-container  |   "signedData": "reservationId=2dc81a7e-d8a4-45d4-a7d6-2e8b41873dcf|verdict=NOT_OK|availabilityId=4de265e1-73a6-473e-8ff0-9e927153a2d4|spotId=SPOT-A1|validFrom=2025-12-25T22:54:11.920735980Z|validTo=2025-12-26T06:54:11.920735980Z|priceTokens=5|coIdentity=CarOwner",
ho-container  |   "verdict": "NOT_OK",
ho-container  |   "status": "success"
ho-container  | }
ho-container  | 
ho-container  | CarOwner disconnected
ho-container  | 
ho-container  | 
ho-container  | === Inbound Reservation Request ===
ho-container  | 
ho-container  | ║   CO AUTHENTICATED VIA mTLS               ║
ho-container  | CO CN: CarOwner
ho-container  | CO address: /172.20.0.13:50836
ho-container  | CO certificate subject: C=BE,O=Parking System,CN=CarOwner
ho-container  | CO certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
ho-container  | CO certificate serial: 566F389741FA013C23384A518B2EC6F8
ho-container  | 
ho-container  | TLS Session Details:
ho-container  |   Protocol: TLSv1.3
ho-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
ho-container  | ═══════════════════════════════════════════
ho-container  | 
ho-container  | Received request from CarOwner:
ho-container  | {
ho-container  |   "startIndex": 0,
ho-container  |   "method": "pay",
ho-container  |   "reservationId": "2dc81a7e-d8a4-45d4-a7d6-2e8b41873dcf",
ho-container  |   "chainId": "a9c82995-479f-44d6-a81c-312d7f82ad9d",
ho-container  |   "rootSignature": "oXepO9w/3Oc+zUjFWWdlYAGUXad4DsOW+nWJbxu69LjPEzwxNR6cBcbkGKyHkeTOtdT5hde6ytzZT9x62JWEZjLAn1kmvJtDYaQZi1ukF3/CVvkgXSaLU7W8O1dSJ5CGac9kpS+yrOzhySR/K8xTEo1khCoeD70OKi46XyfHkuzSXe695GSqxepioCYuKpHnpzIO45bpDN9TxI+aBFYBikQqF9eZ66BPlzSEfJFn/eBJ6ugDDXVxqUVrPjXh8WUA2+AAoB0xofk0qVOGnsWvlqpmMW2g95cT9AB3IMtWuTwWDQC8FLhbhGVSqqV1dcpDL+1nc81OkTomS+kxi/7PWQ==",
ho-container  |   "root": "WSbga/KTCRFGXNHBgeEGOA5oBLQCRngJY7lx/dDVuvc=",
ho-container  |   "x": 5,
ho-container  |   "tokensToSpend": [
ho-container  |     "GhvC3UrKS03YczcFpz9VEU9FRZTNtlkf1c7xMeOprQk=",
ho-container  |     "oNnkofymMffLJaH9ODV+ea0boWj5OY3ASG58u+Wm6sY=",
ho-container  |     "EFPm1eN87o1CkPsdZ6+I5hhDYF2a1zywmkXqWmXZvBE=",
ho-container  |     "bzXoH3gGNBHW0P6Gv+8fz1jwkCNLZh6GhE1uRQeLQ4A=",
ho-container  |     "WSbga/KTCRFGXNHBgeEGOA5oBLQCRngJY7lx/dDVuvc="
ho-container  |   ]
ho-container  | }
ho-container  | [M3.2] root signature verified via cached SP public key
ho-container  | [PAY] SECURITY FAILURE: Reservation verdict != OK
ho-container  | 
ho-container  | Sent pay response:
ho-container  | {
ho-container  |   "reason": "security_violation",
ho-container  |   "message": "Reservation verdict != OK",
ho-container  |   "status": "error"
ho-container  | }
ho-container  | 
ho-container  | CarOwner disconnected
ho-container  | 
ho-container  | 
ho-container  | === Inbound Reservation Request ===
ho-container  | 
ho-container  | ║   CO AUTHENTICATED VIA mTLS               ║
ho-container  | CO CN: CarOwner
ho-container  | CO address: /172.20.0.13:50844
ho-container  | CO certificate subject: C=BE,O=Parking System,CN=CarOwner
ho-container  | CO certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
ho-container  | CO certificate serial: 566F389741FA013C23384A518B2EC6F8
ho-container  | 
ho-container  | TLS Session Details:
ho-container  |   Protocol: TLSv1.3
ho-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
ho-container  | ═══════════════════════════════════════════
ho-container  | 
ho-container  | Received request from CarOwner:
ho-container  | {
ho-container  |   "startIndex": 0,
ho-container  |   "method": "pay",
ho-container  |   "reservationId": "2dc81a7e-d8a4-45d4-a7d6-2e8b41873dcf",
ho-container  |   "chainId": "a9c82995-479f-44d6-a81c-312d7f82ad9d",
ho-container  |   "rootSignature": "oXepO9w/3Oc+zUjFWWdlYAGUXad4DsOW+nWJbxu69LjPEzwxNR6cBcbkGKyHkeTOtdT5hde6ytzZT9x62JWEZjLAn1kmvJtDYaQZi1ukF3/CVvkgXSaLU7W8O1dSJ5CGac9kpS+yrOzhySR/K8xTEo1khCoeD70OKi46XyfHkuzSXe695GSqxepioCYuKpHnpzIO45bpDN9TxI+aBFYBikQqF9eZ66BPlzSEfJFn/eBJ6ugDDXVxqUVrPjXh8WUA2+AAoB0xofk0qVOGnsWvlqpmMW2g95cT9AB3IMtWuTwWDQC8FLhbhGVSqqV1dcpDL+1nc81OkTomS+kxi/7PWQ==",
ho-container  |   "root": "WSbga/KTCRFGXNHBgeEGOA5oBLQCRngJY7lx/dDVuvc=",
ho-container  |   "x": 5,
ho-container  |   "tokensToSpend": [
ho-container  |     "GhvC3UrKS03YczcFpz9VEU9FRZTNtlkf1c7xMeOprQk=",
ho-container  |     "oNnkofymMffLJaH9ODV+ea0boWj5OY3ASG58u+Wm6sY=",
ho-container  |     "EFPm1eN87o1CkPsdZ6+I5hhDYF2a1zywmkXqWmXZvBE=",
ho-container  |     "bzXoH3gGNBHW0P6Gv+8fz1jwkCNLZh6GhE1uRQeLQ4A=",
ho-container  |     "WSbga/KTCRFGXNHBgeEGOA5oBLQCRngJY7lx/dDVuvc="
ho-container  |   ]
ho-container  | }
ho-container  | [PAY] SECURITY FAILURE: Reservation verdict != OK
ho-container  | [M3.2] root signature verified via cached SP public key
ho-container  | 
ho-container  | Sent pay response:
ho-container  | {
ho-container  |   "reason": "security_violation",
ho-container  |   "message": "Reservation verdict != OK",
ho-container  |   "status": "error"
ho-container  | }
ho-container  | 
ho-container  | CarOwner disconnected
ho-container  | 
