sp-container  | Waiting for CAuth to start...
sp-container  | 
sp-container  | === Service Provider Starting ===
sp-container  | Initializing cryptographic baseline...
sp-container  | 
sp-container  | No existing certificate found, enrolling with CAuth...
sp-container  | Step 1: Generating RSA key pair...
sp-container  | ✓ RSA-2048 key pair generated successfully
sp-container  | 
sp-container  | Step 2: Creating Certificate Signing Request (CSR)...
sp-container  | ✓ CSR created with subject: CN=ServiceProvider, O=Parking System, C=BE
sp-container  | 
sp-container  | Step 3: Connecting to CAuth server over TLS...
sp-container  | ✓ TLS connection established to CAuth
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   CAuth certificate verified:
sp-container  |     Subject: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  |     Issuer: CN=Root CA,O=National Authority,C=Country Code
sp-container  | 
sp-container  | → Sending CSR to CAuth for signing...
sp-container  | Received CA certificate from CAuth.
sp-container  | Received Root CA certificate from CAuth.
sp-container  | Certificate signed by CAuth!
sp-container  | ✓ Certificate received from CAuth
sp-container  | 
sp-container  | Step 4: Validating received certificate...
sp-container  |   ✓ Certificate is within validity period
sp-container  |     Valid from: Fri Dec 26 10:12:12 UTC 2025
sp-container  |     Valid until: Sat Dec 26 10:13:12 UTC 2026
sp-container  |   ✓ Certificate public key matches generated key pair
sp-container  |   Validating certificate chain (3 certificates):
sp-container  |     [0] C=BE,O=Parking System,CN=ServiceProvider
sp-container  |         Issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  |         ✓ Signature verified by issuer
sp-container  |     [1] CN=172.20.0.10,O=Private Parking,C=BE
sp-container  |         Issuer: CN=Root CA,O=National Authority,C=Country Code
sp-container  |         ✓ Signature verified by issuer
sp-container  |     [2] CN=Root CA,O=National Authority,C=Country Code
sp-container  |         Issuer: CN=Root CA,O=National Authority,C=Country Code
sp-container  |   ✓ Chain terminates at trusted Root CA: root_ca
sp-container  |   ✓ Certificate chain validation complete
sp-container  | ✓ Certificate chain validation successful
sp-container  | 
sp-container  | Step 5: Storing certificate and private key securely...
sp-container  | Storing certificate chain with 3 certificate(s)
sp-container  |   [0] C=BE,O=Parking System,CN=ServiceProvider
sp-container  |   [1] CN=172.20.0.10,O=Private Parking,C=BE
sp-container  |   [2] CN=Root CA,O=National Authority,C=Country Code
sp-container  | ✓ Credentials stored in ./keystore/sp_keystore.p12
sp-container  | 
sp-container  | ╔═══════════════════════════════════════════╗
sp-container  | ║   CRYPTOGRAPHIC IDENTITY ESTABLISHED     ║
sp-container  | ╚═══════════════════════════════════════════╝
sp-container  | Subject: C=BE,O=Parking System,CN=ServiceProvider
sp-container  | Issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Valid from: Fri Dec 26 10:12:12 UTC 2025
sp-container  | Valid until: Sat Dec 26 10:13:12 UTC 2026
sp-container  | Serial: E40AC8C68EF17C245CDFF7B1ADE2A1FF
sp-container  | ✓ Certificate and private key verified
sp-container  | 
sp-container  | === Starting SP Server ===
sp-container  | 
sp-container  | === SP CRYPTOGRAPHIC BASELINE ESTABLISHED ===
sp-container  | Version: 2025-12-22 (Hardened TLS with mTLS enforcement)
sp-container  | ✓ Enabled TLS protocols: [TLSv1.3, TLSv1.2]
sp-container  | ✓ Strong cipher suites configured: 9 suites
sp-container  |  Mutual TLS (mTLS) REQUIRED - client certificates enforced
sp-container  | 
sp-container  | === TLS Server Configuration ===
sp-container  | Server listening on port: 8444
sp-container  | Server certificate subject: C=BE,O=Parking System,CN=ServiceProvider
sp-container  | Server certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Certificate serial: E40AC8C68EF17C245CDFF7B1ADE2A1FF
sp-container  | Certificate algorithm: SHA256withRSA
sp-container  | Public key algorithm: RSA
sp-container  | RSA key size: 2048 bits
sp-container  | mTLS enforcement: ENABLED (client certificates REQUIRED)
sp-container  | 
sp-container  | ✓ SP Server ready to accept secure connections
sp-container  | ==========================================
sp-container  | 
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  5E1C09951680F9EA76109D48D18E5A33
sp-container  | [SP]   SHA-256: 7AAF33BEAD7E3C114B2D2482AC52BD2C...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: HomeOwner
sp-container  | Client address: /172.20.0.12:44128
sp-container  | Client certificate subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 5E1C09951680F9EA76109D48D18E5A33
sp-container  | Certificate valid from: Fri Dec 26 10:12:15 UTC 2025
sp-container  | Certificate valid until: Sat Dec 26 10:13:15 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: 10E1E1489C3E5FDE...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from HomeOwner: {
sp-container  |   "priceTokens": 5,
sp-container  |   "metadata": {
sp-container  |     "spotType": "residential",
sp-container  |     "autoRenewal": false,
sp-container  |     "maxDuration": "8h"
sp-container  |   },
sp-container  |   "method": "publishAvailability",
sp-container  |   "spotId": "SPOT-A1",
sp-container  |   "locationZone": "Downtown-North",
sp-container  |   "homeOwnerId": "HO-001",
sp-container  |   "validFrom": "2025-12-26T10:13:15.281856542Z",
sp-container  |   "validTo": "2025-12-26T18:13:15.281856542Z"
sp-container  | }
sp-container  | 
sp-container  | === Publishing Parking Availability from HomeOwner ===
sp-container  |   Home Owner: HO-001
sp-container  |   Spot ID: SPOT-A1
sp-container  |   Valid: 2025-12-26T10:13:15.281856542Z to 2025-12-26T18:13:15.281856542Z
sp-container  |   Price: 5 tokens
sp-container  |   Location: Downtown-North
sp-container  | ✓ Availability stored with ID: 65cb0872-654f-4702-947d-d902d6d0e59d
sp-container  | ✓ Total availabilities in system: 1
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "publishedAt": "2025-12-26T10:13:15.342841459Z",
sp-container  |   "availabilityId": "65cb0872-654f-4702-947d-d902d6d0e59d",
sp-container  |   "spotId": "SPOT-A1",
sp-container  |   "message": "Parking availability published successfully",
sp-container  |   "status": "success"
sp-container  | }
sp-container  | 
sp-container  | HomeOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  E4DB9AF26D5A82F6014787DB530F67F9
sp-container  | [SP]   SHA-256: F65DFBBA109A9D7E80312454928B1A61...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: CarOwner
sp-container  | Client address: /172.20.0.13:36524
sp-container  | Client certificate subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: E4DB9AF26D5A82F6014787DB530F67F9
sp-container  | Certificate valid from: Fri Dec 26 10:12:19 UTC 2025
sp-container  | Certificate valid until: Sat Dec 26 10:13:19 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: CFB6EB0DC6DB8E24...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from CarOwner: {"method": "getAvailability"}
sp-container  | 
sp-container  | === Availability Discovery Request from CarOwner ===
sp-container  |   Total availabilities in system: 1
sp-container  |   [65cb0872-654f-4702-947d-d902d6d0e59d] SPOT-A1 - 5 tokens (HO: HomeOwner)
sp-container  | ✓ Returned 1 availability record(s) to CarOwner
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "availabilities": [{
sp-container  |     "priceTokens": 5,
sp-container  |     "hoIdentity": "HomeOwner",
sp-container  |     "hoCertFingerprint": "7AAF33BEAD7E3C114B2D2482AC52BD2CA680453BD5334DDE8F01FB11261CA907",
sp-container  |     "availabilityId": "65cb0872-654f-4702-947d-d902d6d0e59d",
sp-container  |     "spotId": "SPOT-A1",
sp-container  |     "locationZone": "Downtown-North",
sp-container  |     "homeOwnerId": "HO-001",
sp-container  |     "hoCertificate": "-----BEGIN CERTIFICATE-----\nMIIEgDCCAmigAwIBAgIQXhwJlRaA+ep2EJ1I0Y5aMzANBgkqhkiG9w0BAQsFADA9\nMQswCQYDVQQGEwJCRTEYMBYGA1UEChMPUHJpdmF0ZSBQYXJraW5nMRQwEgYDVQQD\nEwsxNzIuMjAuMC4xMDAeFw0yNTEyMjYxMDEyMTVaFw0yNjEyMjYxMDEzMTVaMDox\nCzAJBgNVBAYTAkJFMRcwFQYDVQQKDA5QYXJraW5nIFN5c3RlbTESMBAGA1UEAwwJ\nSG9tZU93bmVyMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAt1poDyRy\nizvtpasiTP1ZBzpNXYSVwM6PEXc+RqhcMRtouq0ewwuGm4d5g+j3Vlng2RlROUf2\neIBEe6nRu2nL5ZwKFQsNDhNDDVAYkXxt+bp9WLlzlcIP0U3b+zHVPVaOPJhyKPLs\nEfwCNc+5+ZkITUeSnxEovCiRUUcVWz4vIaeB/aZkUjPWbcSe1z6tZ9c4n7y65kMA\nyaEbyvgU81o84FU9l3Y3O24LiFAKQ8tMYKGaZA1Hue5uVDwVBTwOh1E/pMbSmkl6\nUZW3x8ZL3CJybM0ldgXq9pjEK0B9qEk4hSurjp3nYSQ4h35blme39yzIN3PNTeaG\nZpm+GC5GCgol3QIDAQABo38wfTAMBgNVHRMBAf8EAjAAMA4GA1UdDwEB/wQEAwIF\noDAdBgNVHSUEFjAUBggrBgEFBQcDAQYIKwYBBQUHAwIwHQYDVR0OBBYEFHYmtwC7\nVp5huRs6Qz0go1/LUWqOMB8GA1UdIwQYMBaAFMkcn65FDxCLoejj3tyrE1Khh6KK\nMA0GCSqGSIb3DQEBCwUAA4ICAQBV9F/EatyzuPhlLn1tXRttWy09R3Eg3ThLhWGJ\nU2vWXegUNQUPOiDGIGoD5VXr7tuAL3RNw7DlXEk9RC6l5F1mUDBdTAt2Act6R6jh\nvs/NDfz/I2jbQ76r9Y5VAsj6GZQK9osnowf6YyOmn+Phe0zkfru81klKATvkJUCo\nsnltgHvNb3Mn6I669Yijch600sA7riToBldoqCP48kxyMRCLVQYzDAjOgN/wTqfE\nsPRyOOfTtlteJw9VXKnegj6cA9hF1XZfq6dQZ1itMa1R4LHbb/g4EKidfa0PtWZX\nnrvA2jLt1zovGn+aPtAOKb09kNRYm95qZozANV50Fl7ag1YVraSmD0PgWcijaBVX\nRzRxFGrRPUl/TjZPbHJRz8fuFiQz1MEWJvt3THVtpvNQhuqyw+DMsTP/bLxmBnnl\nl0pGteC/B2LYBvnIyevD9FDPRRwqODzk7+bzU9jXVFJnSU+jW3F9J3CkeXmQBARp\nXskuWtItwU3QTnUfzyUSDq7R2J6tNsrZ/xEcecOZAWYU0DyKiSCnvp35V5/hDK8R\n7BmoMFEpEjijvssJasyylxLBV1qbL4CD4pBeFY6eROB6K2hrRAQYHfvIoQybTlBj\n8rE7XmyIoFOgd+f4wzyxFddzWg6SWE6/+x0nm83aax5ZY+X7MUdYo575ec/vMQKe\n6cKIBg==\n-----END CERTIFICATE-----\n",
sp-container  |     "validFrom": "2025-12-26T10:13:15.281856542Z",
sp-container  |     "validTo": "2025-12-26T18:13:15.281856542Z"
sp-container  |   }],
sp-container  |   "count": 1,
sp-container  |   "status": "success",
sp-container  |   "timestamp": "2025-12-26T10:13:19.515225753Z"
sp-container  | }
sp-container  | 
sp-container  | CarOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  E4DB9AF26D5A82F6014787DB530F67F9
sp-container  | [SP]   SHA-256: F65DFBBA109A9D7E80312454928B1A61...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: CarOwner
sp-container  | Client address: /172.20.0.13:36538
sp-container  | Client certificate subject: C=BE,O=Parking System,CN=CarOwner
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: E4DB9AF26D5A82F6014787DB530F67F9
sp-container  | Certificate valid from: Fri Dec 26 10:12:19 UTC 2025
sp-container  | Certificate valid until: Sat Dec 26 10:13:19 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: F2BD9733BF6BACDD...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from CarOwner: {
sp-container  |   "method": "requestTokens",
sp-container  |   "count": 5
sp-container  | }
sp-container  | 
sp-container  | === Generating 5 payment tokens for CarOwner ===
sp-container  | ✓ Generated secret s (32 bytes)
sp-container  | ✓ Generated hash chain of length 5
sp-container  |   Root H^5(s): 2F9B9E1E14316FD1...
sp-container  | ✓ Signed root with SP private key (256 bytes)
sp-container  | ✓ Stored chain metadata (ID: 71c6a792-9607-4d5d-a726-0c0a08a3a059)
sp-container  | ✓ Token batch ready to send to CarOwner
sp-container  | ══════════════════════════════════════════════════
sp-container  | Sent response: {
sp-container  |   "tokenHashAlg": "SHA-256",
sp-container  |   "signatureAlg": "SHA256withRSA",
sp-container  |   "chainId": "71c6a792-9607-4d5d-a726-0c0a08a3a059",
sp-container  |   "rootSignature": "vGTPWcamws2UDa/LPUd4E5Jk5i2zEG+Yo6dxymeZH5ijgiFJdRp8YecuQQc3/xY9l26hdP3Kqnu8CLSUlo44KT8PsJ+cvf3LXRICLPSlBpaQYcDT7u6URCLEwt9pyoDmi2VHXFNusDvta/WohoQEFkGaBdZ1jVPntqCgdHvOV6Uxi4gRMC8XbHnb/VhshAHa1xmEulhN+bfIIkavu/zA7QViDmnLeaafo2doteN6BlVgpJLqjwZGRjzChG/QnAl36v56o54L34EpjS26QK30hz1I6nveVmR8L1d5pa0zoA8/yqtbbyXsfEArzIhYxlOrCBKyAjjL0ILTy4xM7U69rQ==",
sp-container  |   "root": "L5ueHhQxb9GsM73EGbTO4gnR3oy+ShRr9SPqJtDkxIs=",
sp-container  |   "x": 5,
sp-container  |   "tokens": [
sp-container  |     "N9GtAwXCiWEgBUvRtpWSuoZjbsPfcMEwrGIBS/i1bok=",
sp-container  |     "OIfrJMiZuYSHJwvMqabilklfxLlHQ+5FlWbRiKajQ9E=",
sp-container  |     "yAOr17wqO18CZbbQu8Urnwlr5GTJtoMvdgl0l61lic4=",
sp-container  |     "uptCoEeMCObjavl9gAZx4L1uVf5hNmuyfF3KXv1zBM4=",
sp-container  |     "L5ueHhQxb9GsM73EGbTO4gnR3oy+ShRr9SPqJtDkxIs="
sp-container  |   ],
sp-container  |   "status": "success"
sp-container  | }
sp-container  | 
sp-container  | CarOwner disconnected
sp-container  | 
sp-container  | === Inbound Connection ===
sp-container  | [SP] ✓ Client certificate received and validated:
sp-container  | [SP]   Subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | [SP]   Issuer:  CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | [SP]   Serial:  5E1C09951680F9EA76109D48D18E5A33
sp-container  | [SP]   SHA-256: 7AAF33BEAD7E3C114B2D2482AC52BD2C...
sp-container  | 
sp-container  | ║   CLIENT AUTHENTICATED VIA mTLS           ║
sp-container  | Client CN: HomeOwner
sp-container  | Client address: /172.20.0.12:54516
sp-container  | Client certificate subject: CN=HomeOwner,O=Parking System,C=BE
sp-container  | Client certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
sp-container  | Client certificate serial: 5E1C09951680F9EA76109D48D18E5A33
sp-container  | Certificate valid from: Fri Dec 26 10:12:15 UTC 2025
sp-container  | Certificate valid until: Sat Dec 26 10:13:15 UTC 2026
sp-container  | 
sp-container  | TLS Session Details:
sp-container  |   Protocol: TLSv1.3
sp-container  |   Cipher suite: TLS_AES_256_GCM_SHA384
sp-container  |   Session ID: 6B1B2CBB830F55FB...
sp-container  | ═══════════════════════════════════════════
sp-container  | 
sp-container  | 
sp-container  | Received from HomeOwner: {
sp-container  |   "startIndex": 0,
sp-container  |   "lastTokenSpent": "L5ueHhQxb9GsM73EGbTO4gnR3oy+ShRr9SPqJtDkxIs=",
sp-container  |   "method": "settle",
sp-container  |   "reservationId": "61ce8026-f34f-48df-92ac-b922a98a4d0e",
sp-container  |   "chainId": "71c6a792-9607-4d5d-a726-0c0a08a3a059",
sp-container  |   "availabilityId": "65cb0872-654f-4702-947d-d902d6d0e59d",
sp-container  |   "rootSignature": "vGTPWcamws2UDa/LPUd4E5Jk5i2zEG+Yo6dxymeZH5ijgiFJdRp8YecuQQc3/xY9l26hdP3Kqnu8CLSUlo44KT8PsJ+cvf3LXRICLPSlBpaQYcDT7u6URCLEwt9pyoDmi2VHXFNusDvta/WohoQEFkGaBdZ1jVPntqCgdHvOV6Uxi4gRMC8XbHnb/VhshAHa1xmEulhN+bfIIkavu/zA7QViDmnLeaafo2doteN6BlVgpJLqjwZGRjzChG/QnAl36v56o54L34EpjS26QK30hz1I6nveVmR8L1d5pa0zoA8/yqtbbyXsfEArzIhYxlOrCBKyAjjL0ILTy4xM7U69rQ==",
sp-container  |   "root": "L5ueHhQxb9GsM73EGbTO4gnR3oy+ShRr9SPqJtDkxIs=",
sp-container  |   "newLastSpentIndex": 5,
sp-container  |   "x": 5,
sp-container  |   "y": 5,
sp-container  |   "firstTokenSpent": "N9GtAwXCiWEgBUvRtpWSuoZjbsPfcMEwrGIBS/i1bok="
sp-container  | }
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] Settlement Request Received from HomeOwner
sp-container  | [SETTLE]   chainId: 71c6a792-9607-4d5d-a726-0c0a08a3a059
sp-container  | [SETTLE]   reservationId: 61ce8026-f34f-48df-92ac-b922a98a4d0e
sp-container  | [SETTLE]   availabilityId: 65cb0872-654f-4702-947d-d902d6d0e59d
sp-container  | [SETTLE]   y (tokens spent): 5
sp-container  | [SETTLE]   newLastSpentIndex: 5
sp-container  | [SETTLE]   x (chain length): 5
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] ✓ Cryptographic proof verified: token hashes to root
sp-container  | [SETTLE]   (hashed 0 times from last spent token to reach root)
sp-container  | [SETTLE] ✓✓✓ SETTLEMENT ACCEPTED ✓✓✓
sp-container  | [SETTLE]   chainId: 71c6a792-9607-4d5d-a726-0c0a08a3a059
sp-container  | [SETTLE]   reservationId: 61ce8026-f34f-48df-92ac-b922a98a4d0e
sp-container  | [SETTLE]   Previous lastSpentIndex: 0
sp-container  | [SETTLE]   Updated lastSpentIndex: 5
sp-container  | [SETTLE]   Tokens consumed: 5
sp-container  | [SETTLE]   Remaining tokens: 0
sp-container  | [AUDIT] SETTLEMENT_ACCEPTED{chainId=71c6a792-9607-4d5d-a726-0c0a08a3a059, oldIndex=0, newIndex=5, tokensSpent=5, reservationId=61ce8026-f34f-48df-92ac-b922a98a4d0e}
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] M3.4: Generating Cryptographically Verifiable Receipt
sp-container  | [SETTLE] ═══════════════════════════════════════════════════
sp-container  | [SETTLE] Canonical Receipt Data:
sp-container  | [SETTLE]   receiptId=3f3709e0-a0af-4698-83d4-3fb3386b21e1|chainId=71c6a792-9607-4d5d-a726-0c0a08a3a059|reservationId=61ce8026-f34f-48df-92ac-b922a98a4d0e|availabilityId=65cb0872-654f-4702-947d-d902d6d0e59d|y=5|newLastSpentIndex=5|timestamp=2025-12-26T10:13:20.030522586Z|hoIdentity=HomeOwner
sp-container  | [SETTLE] ✓ Receipt signed with SP private key (RSA-2048)
sp-container  | [SETTLE]   Algorithm: SHA256withRSA
sp-container  | [SETTLE]   Signature length: 256 bytes
sp-container  | [SETTLE] ✓ SP certificate fingerprint: 2CD1D4B77C5262DB298833E252A95C51...
sp-container  | [SETTLE] ✓✓✓ PAYMENT RECEIPT GENERATED ✓✓✓
sp-container  | [SETTLE]   Receipt ID: 3f3709e0-a0af-4698-83d4-3fb3386b21e1
sp-container  | [SETTLE]   Non-repudiation: SP signature binds finality to payment
sp-container  | [SETTLE]   Auditability: Receipt enables offline third-party verification
sp-container  | [AUDIT] RECEIPT_GENERATED{receiptId=3f3709e0-a0af-4698-83d4-3fb3386b21e1, chainId=71c6a792-9607-4d5d-a726-0c0a08a3a059, reservationId=61ce8026-f34f-48df-92ac-b922a98a4d0e}
sp-container  | Sent response: {
sp-container  |   "reservationId": "61ce8026-f34f-48df-92ac-b922a98a4d0e",
sp-container  |   "chainId": "71c6a792-9607-4d5d-a726-0c0a08a3a059",
sp-container  |   "remainingTokens": 0,
sp-container  |   "acceptedLastSpentIndex": 5,
sp-container  |   "tokensConsumed": 5,
sp-container  |   "paymentReceipt": {
sp-container  |     "hoIdentity": "HomeOwner",
sp-container  |     "reservationId": "61ce8026-f34f-48df-92ac-b922a98a4d0e",
sp-container  |     "signatureAlg": "SHA256withRSA",
sp-container  |     "chainId": "71c6a792-9607-4d5d-a726-0c0a08a3a059",
sp-container  |     "availabilityId": "65cb0872-654f-4702-947d-d902d6d0e59d",
sp-container  |     "newLastSpentIndex": 5,
sp-container  |     "spCertFingerprint": "2CD1D4B77C5262DB298833E252A95C51E5D2F2D47A6CAB3A6116A447CF18E37B",
sp-container  |     "y": 5,
sp-container  |     "receiptId": "3f3709e0-a0af-4698-83d4-3fb3386b21e1",
sp-container  |     "canonicalReceipt": "receiptId=3f3709e0-a0af-4698-83d4-3fb3386b21e1|chainId=71c6a792-9607-4d5d-a726-0c0a08a3a059|reservationId=61ce8026-f34f-48df-92ac-b922a98a4d0e|availabilityId=65cb0872-654f-4702-947d-d902d6d0e59d|y=5|newLastSpentIndex=5|timestamp=2025-12-26T10:13:20.030522586Z|hoIdentity=HomeOwner",
sp-container  |     "receiptSignature": "dkRux81Ux0vild8WOotzTh125LKrqLup39wJ0TAOUmfJd0D+KeUMrcS480zm6TIdnN6ncqU2PveXyJ6h0XNCSSxgTyj0oNqSWVZDIT5F1P884muVKKw7LMoADEtcEmnio2sjnU5z55rC/g3/axCnum57tAEPKwdsfwWf1yUxbN/Uc+xPokiVQTDDbWm6IaqCRIHTqSOm5rhOWO2HHx0nFwKUYDOSWzVJC1N4tgI9yk1b9pLeqrZKgePqIvLz7VVW0P6055w1eqi5U70x+goEtZjojbLfGWXw3VMIZCOZpdNoXtrjNfUppbUchwix0ccvgt5JSgvZPlL0OdiJZBnr1w==",
sp-container  |     "timestamp": "2025-12-26T10:13:20.030522586Z"
sp-container  |   },
sp-container  |   "message": "Settlement accepted",
sp-container  |   "status": "success",
sp-container  |   "timestamp": "2025-12-26T10:13:20.030522586Z"
sp-container  | }
sp-container  | 
sp-container  | HomeOwner disconnected
