[HO][INFO][NONE] Waiting for CAuth and SP to start...
[HO][INFO][NONE] 
=== Home Owner (HO) Starting ===
[HO][INFO][NONE] Found existing certificate, loading from keystore...
[HO][INFO][NONE] ...
[HO][INFO][NONE] 
╔═══════════════════════════════════════════╗
[HO][INFO][NONE] ║   HO CRYPTOGRAPHIC IDENTITY ESTABLISHED   ║
[HO][INFO][NONE] ╚═══════════════════════════════════════════╝
[HO][INFO][NONE] Subject: CN=HomeOwner,O=Parking System,C=BE
[HO][INFO][NONE] Issuer: CN=172.20.0.10,O=Private Parking,C=BE
[HO][INFO][NONE] Valid from: Wed Dec 24 22:22:43 UTC 2025
[HO][INFO][NONE] Valid until: Thu Dec 24 22:23:43 UTC 2026
[HO][INFO][NONE] 
=== Publishing Parking Availability to SP ===
[HO][INFO][NONE] ...
[HO][INFO][NONE]   Protocol: TLSv1.3
[HO][INFO][NONE]   Cipher suite: TLS_AES_256_GCM_SHA384
[HO][INFO][NONE]   SP certificate: C=BE,O=Parking System,CN=ServiceProvider
[HO][INFO][NONE] [M3.2] SP public key cached from mTLS handshake
[HO][INFO][NONE] 
→ Publishing availability to SP...
[HO][INFO][NONE]   Spot ID: SPOT-A1
[HO][INFO][NONE]   Valid from: 2025-12-24T22:33:15.876009381Z
[HO][INFO][NONE]   Valid to: 2025-12-25T06:33:15.876009381Z
[HO][INFO][NONE]   Price: 5 tokens
[HO][INFO][NONE]   Location: Downtown-North
[HO][INFO][NONE] 
← Received response from SP
[HO][INFO][NONE] 
╔═══════════════════════════════════════════╗
[HO][INFO][NONE] ║   AVAILABILITY PUBLISHED SUCCESSFULLY     ║
[HO][INFO][NONE] ╚═══════════════════════════════════════════╝
[HO][INFO][NONE] Availability ID: 631f02f1-c3de-45e1-8356-4024642d5e2f
[HO][INFO][NONE] Message: Parking availability published successfully
[HO][INFO][NONE] 
=== Starting HO Reservation & Payment Server ===
[HO][INFO][NONE] 
╔═══════════════════════════════════════════════════════════╗
[HO][INFO][NONE] ║   HO RESERVATION SERVER CRYPTOGRAPHIC BASELINE           ║
[HO][INFO][NONE] ╚═══════════════════════════════════════════════════════════╝
[HO][INFO][NONE] Version: 2025-12-22 (Milestone 2.4 - Reservation Handshake)
[HO][INFO][NONE] ✓ Enabled TLS protocols: [TLSv1.3, TLSv1.2]
[HO][INFO][NONE] ...
[HO][INFO][NONE] 
[HO][INFO][NONE] === HO Reservation Server Configuration ===
[HO][INFO][NONE] Server listening on port: 8445
[HO][INFO][NONE] Server certificate subject: CN=HomeOwner,O=Parking System,C=BE
[HO][INFO][NONE] Server certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
[HO][INFO][NONE] RSA key size: 2048 bits
[HO][INFO][NONE] Signature algorithm: SHA256withRSA
[HO][INFO][NONE] mTLS enforcement: ENABLED (CO certificates REQUIRED)
[HO][INFO][NONE] 
[HO][INFO][NONE] ...
[HO][INFO][NONE] ==========================================

[HO][INFO][NONE] Waiting for CAuth and SP to start...
[HO][INFO][NONE] 
=== Home Owner (HO) Starting ===
[HO][INFO][NONE] Found existing certificate, loading from keystore...
[HO][INFO][NONE] ...
[HO][INFO][NONE] 
╔═══════════════════════════════════════════╗
[HO][INFO][NONE] ║   HO CRYPTOGRAPHIC IDENTITY ESTABLISHED   ║
[HO][INFO][NONE] ╚═══════════════════════════════════════════╝
[HO][INFO][NONE] Subject: CN=HomeOwner,O=Parking System,C=BE
[HO][INFO][NONE] Issuer: CN=172.20.0.10,O=Private Parking,C=BE
[HO][INFO][NONE] Valid from: Wed Dec 24 22:22:43 UTC 2025
[HO][INFO][NONE] Valid until: Thu Dec 24 22:23:43 UTC 2026
[HO][INFO][NONE] 
=== Publishing Parking Availability to SP ===
[HO][INFO][NONE] ...
[HO][INFO][NONE]   Protocol: TLSv1.3
[HO][INFO][NONE]   Cipher suite: TLS_AES_256_GCM_SHA384
[HO][INFO][NONE]   SP certificate: C=BE,O=Parking System,CN=ServiceProvider
[HO][INFO][NONE] [M3.2] SP public key cached from mTLS handshake
[HO][INFO][NONE] 
→ Publishing availability to SP...
[HO][INFO][NONE]   Spot ID: SPOT-A1
[HO][INFO][NONE]   Valid from: 2025-12-24T22:33:28.828315429Z
[HO][INFO][NONE]   Valid to: 2025-12-25T06:33:28.828315429Z
[HO][INFO][NONE]   Price: 5 tokens
[HO][INFO][NONE]   Location: Downtown-North
[HO][INFO][NONE] 
← Received response from SP
[HO][INFO][NONE] 
╔═══════════════════════════════════════════╗
[HO][INFO][NONE] ║   AVAILABILITY PUBLISHED SUCCESSFULLY     ║
[HO][INFO][NONE] ╚═══════════════════════════════════════════╝
[HO][INFO][NONE] Availability ID: 191001f5-0052-4ce1-ad30-d01579fb3c63
[HO][INFO][NONE] Message: Parking availability published successfully
[HO][INFO][NONE] 
=== Starting HO Reservation & Payment Server ===
[HO][INFO][NONE] 
╔═══════════════════════════════════════════════════════════╗
[HO][INFO][NONE] ║   HO RESERVATION SERVER CRYPTOGRAPHIC BASELINE           ║
[HO][INFO][NONE] ╚═══════════════════════════════════════════════════════════╝
[HO][INFO][NONE] Version: 2025-12-22 (Milestone 2.4 - Reservation Handshake)
[HO][INFO][NONE] ✓ Enabled TLS protocols: [TLSv1.3, TLSv1.2]
[HO][INFO][NONE] ...
[HO][INFO][NONE] 
[HO][INFO][NONE] === HO Reservation Server Configuration ===
[HO][INFO][NONE] Server listening on port: 8445
[HO][INFO][NONE] Server certificate subject: CN=HomeOwner,O=Parking System,C=BE
[HO][INFO][NONE] Server certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
[HO][INFO][NONE] RSA key size: 2048 bits
[HO][INFO][NONE] Signature algorithm: SHA256withRSA
[HO][INFO][NONE] mTLS enforcement: ENABLED (CO certificates REQUIRED)
[HO][INFO][NONE] 
[HO][INFO][NONE] ...
[HO][INFO][NONE] ==========================================

[HO][INFO][NONE] 
=== Inbound Reservation Request ===
[HO][INFO][NONE] 
║   CO AUTHENTICATED VIA mTLS               ║
[HO][INFO][NONE] CO CN: CarOwner
[HO][INFO][NONE] CO address: /172.20.0.13:55832
[HO][INFO][NONE] CO certificate subject: C=BE,O=Parking System,CN=CarOwner
[HO][INFO][NONE] CO certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
[HO][INFO][NONE] CO certificate serial: E16365A585488AD2430B4CEFF780C6AB
[HO][INFO][NONE] 
[HO][INFO][NONE] TLS Session Details:
[HO][INFO][NONE]   Protocol: TLSv1.3
[HO][INFO][NONE]   Cipher suite: TLS_AES_256_GCM_SHA384
[HO][INFO][NONE] ═══════════════════════════════════════════

[HO][INFO][NONE] Received request from CarOwner:
[HO][INFO][NONE] {
  "priceTokens": 5,
  "method": "requestReservation",
  "availabilityId": "191001f5-0052-4ce1-ad30-d01579fb3c63",
  "spotId": "SPOT-A1",
  "validFrom": "2025-12-24T22:33:28.828315429Z",
  "validTo": "2025-12-25T06:33:28.828315429Z",
  "coIdentity": "CarOwner"
}
[HO][INFO][NONE] 
=== Processing Reservation Request (Milestone 2.4) ===
[HO][INFO][NONE]   Availability ID: 191001f5-0052-4ce1-ad30-d01579fb3c63
[HO][INFO][NONE]   Spot ID: SPOT-A1
[HO][INFO][NONE]   Valid: 2025-12-24T22:33:28.828315429Z to 2025-12-25T06:33:28.828315429Z
[HO][INFO][NONE]   Price: 5 tokens
[HO][INFO][NONE]   Requested CO Identity: CarOwner
[HO][INFO][NONE] ✓ CO identity verified: CarOwner
[HO][INFO][NONE] ...
[HO][INFO][NONE] Generated Reservation ID: ece90d1d-9b7a-4259-b1f5-97f1571e42dc
[HO][INFO][NONE] 
─ Generating Cryptographic Signature ─
[HO][INFO][NONE] Canonical data to sign:
[HO][INFO][NONE]   reservationId=ece90d1d-9b7a-4259-b1f5-97f1571e42dc|verdict=OK|availabilityId=191001f5-0052-4ce1-ad30-d01579fb3c63|spotId=SPOT-A1|validFrom=2025-12-24T22:33:28.828315429Z|validTo=2025-12-25T06:33:28.828315429Z|priceTokens=5|coIdentity=CarOwner
[HO][INFO][NONE] ...
[HO][INFO][NONE]   Algorithm: SHA256withRSA
[HO][INFO][NONE]   Signature length: 256 bytes
[HO][INFO][NONE]   Signature (Base64): bwxXhW/ltaVrYVInrmABSaJGdh+I6ru1...
[HO][INFO][NONE] 
╔═══════════════════════════════════════════════════════════╗
[HO][INFO][NONE] ║   RESERVATION DECISION: OK
[HO][INFO][NONE] ╚═══════════════════════════════════════════════════════════╝
[HO][INFO][NONE] Reservation ID: ece90d1d-9b7a-4259-b1f5-97f1571e42dc
[HO][INFO][NONE] CO Identity: CarOwner
[HO][INFO][NONE] ...
[HO][INFO][NONE] ...
[HO][INFO][NONE] 
Sent signed reservation response:
[HO][INFO][NONE] {
  "hoIdentity": "HomeOwner",
  "reservationId": "ece90d1d-9b7a-4259-b1f5-97f1571e42dc",
  "signatureAlg": "SHA256withRSA",
  "signature": "bwxXhW/ltaVrYVInrmABSaJGdh+I6ru14B24Pgo4mTl3Mt8xHD/bKeKsYa2C/ihsGuZ5K9FzPQhPYtQp7M7kUsA4LvFCQwl/TcSCDeL1WNgUeq+EgW6PDtFPyGiogdvTUN2p0PRe+kRU9kiWQf3pFpjIaRLquerTmS0ttn8MXyMOlg0HMd7FLL7C5UzL6EI1TNvK14V/6OgBZvWxApvOAh/jev9Brbw4MSB+Gye/KYPQEI4EwltF14VZWGTNdem9WJ/Uj7r5jCgM7aZOFWoioXNhMNdhb410MpAII6oYP6Gtg2Ol3ODOUPVQo6DCQNcv9TFjG2808f04mKTH6wOP2w==",
  "signedData": "reservationId=ece90d1d-9b7a-4259-b1f5-97f1571e42dc|verdict=OK|availabilityId=191001f5-0052-4ce1-ad30-d01579fb3c63|spotId=SPOT-A1|validFrom=2025-12-24T22:33:28.828315429Z|validTo=2025-12-25T06:33:28.828315429Z|priceTokens=5|coIdentity=CarOwner",
  "verdict": "OK",
  "status": "success"
}
[HO][INFO][NONE] 
CarOwner disconnected

[HO][INFO][NONE] 
=== Inbound Reservation Request ===
[HO][INFO][NONE] 
║   CO AUTHENTICATED VIA mTLS               ║
[HO][INFO][NONE] CO CN: CarOwner
[HO][INFO][NONE] CO address: /172.20.0.13:55834
[HO][INFO][NONE] CO certificate subject: C=BE,O=Parking System,CN=CarOwner
[HO][INFO][NONE] CO certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
[HO][INFO][NONE] CO certificate serial: E16365A585488AD2430B4CEFF780C6AB
[HO][INFO][NONE] 
[HO][INFO][NONE] TLS Session Details:
[HO][INFO][NONE]   Protocol: TLSv1.3
[HO][INFO][NONE]   Cipher suite: TLS_AES_256_GCM_SHA384
[HO][INFO][NONE] ═══════════════════════════════════════════

[HO][INFO][NONE] Received request from CarOwner:
[HO][INFO][NONE] {
  "startIndex": 0,
  "method": "pay",
  "reservationId": "ece90d1d-9b7a-4259-b1f5-97f1571e42dc",
  "chainId": "6bc5619a-0d52-45fc-80f6-fe4153235fd0",
  "rootSignature": "H3wapsMSOIzOhwJ/rYsMcctev35T9L4DpJjjzEUk57yd++eZq2quhvULAOaCAOD5HbHKKpkZR+pLsBypO6QACf7zUZVNPafgWk4qUHbe3Qxlq7s85wVDqPMMWnb0hcz2lUogwGd0fC+EgrlFyHNj64R7K8lw7V/DH3x1SfgRsRBcJkqtJigGDl+o4RIKj3UxXhFE4W6p8eCNkCYr2/0xmWbHr1i/BxMcFzYOnKENWVM/qbn6kZXc/RVknPQnZ3fOPAJgUfmBNHzBqhR1ISmhpCZimVVRPUruCmRdd3L0in5YIY+ae+qS1ctwxLpLKqWdAeJ5ElZng3TKWOKfGi2rzg==",
  "root": "cRbaod5Tx6mtONh8eCVxY899QQPPvnZsue+H0Jiwufk=",
  "x": 5,
  "tokensToSpend": [
    "d5PlzzNQOHcJujJxpLxCmnXeuRNPlcxrSuzUyjiAWRs=",
    "Wc+006xwP+DI3lM4hFSbmCbxsSxbgu9vF2wjKSXIjTw=",
    "/9yvmPAeFJ4nKj9lnD9aDisHB5/FjKsOGUfQL/6XPCA=",
    "epNw4Kx1FowkvHO1Pf2vm9zW2MGJLRgF2xht397fnPM=",
    "cRbaod5Tx6mtONh8eCVxY899QQPPvnZsue+H0Jiwufk="
  ]
}
[HO][INFO][NONE] [M3.2] root signature verified via cached SP public key
[HO][INFO][NONE] [M3.2] policy checks passed (reservation verdict OK, token count matches)
[HO][INFO][NONE] [PAY] received from CarOwner
[HO][INFO][NONE] [PAY]   reservationId=ece90d1d-9b7a-4259-b1f5-97f1571e42dc
[HO][INFO][NONE] [PAY]   chainId=6bc5619a-0d52-45fc-80f6-fe4153235fd0
[HO][INFO][NONE] [PAY]   tokenCount=5
[HO][INFO][NONE] [PAY]   startIndex=0
[HO][INFO][NONE] [PAY]   x=5
[HO][INFO][NONE] [PAY]   Hash-chain verification: SUCCESS
[HO][INFO][NONE] [SETTLE] ═══════════════════════════════════════════════════
[HO][INFO][NONE] [SETTLE] Preparing Settlement Request to SP
[HO][INFO][NONE] [SETTLE]   chainId: 6bc5619a-0d52-45fc-80f6-fe4153235fd0
[HO][INFO][NONE] [SETTLE]   reservationId: ece90d1d-9b7a-4259-b1f5-97f1571e42dc
[HO][INFO][NONE] [SETTLE]   y (tokens spent): 5
[HO][INFO][NONE] [SETTLE]   newLastSpentIndex: 5
[HO][INFO][NONE] [SETTLE]   x (chain length): 5
[HO][INFO][NONE] [SETTLE] ═══════════════════════════════════════════════════
[HO][INFO][NONE] [SETTLE] ✓ TLS hardening applied (TLS 1.3/1.2, AEAD ciphers only)
[HO][INFO][NONE] [SETTLE] Initiating explicit TLS handshake...
[HO][INFO][NONE] [SETTLE] ✓ TLS handshake completed successfully
[HO][INFO][NONE] [SETTLE]   Protocol: TLSv1.3
[HO][INFO][NONE] [SETTLE]   Cipher Suite: TLS_AES_256_GCM_SHA384
[HO][INFO][NONE] [SETTLE] ✓ SP certificate verified: C=BE,O=Parking System,CN=ServiceProvider
[HO][INFO][NONE] [SETTLE] → Settlement request sent to SP
[HO][INFO][NONE] [SETTLE] ✓✓✓ SP SETTLEMENT ACCEPTED ✓✓✓
[HO][INFO][NONE] [SETTLE]   chainId: 6bc5619a-0d52-45fc-80f6-fe4153235fd0
[HO][INFO][NONE] [SETTLE]   acceptedLastSpentIndex: 5
[HO][INFO][NONE] [SETTLE]   tokensConsumed: 5
[HO][INFO][NONE] [SETTLE]   remainingTokens: 0
[HO][INFO][NONE] [SETTLE]   timestamp: 2025-12-24T22:33:36.714413433Z
[HO][INFO][NONE] [SETTLE] ═══════════════════════════════════════════════════
[HO][INFO][NONE] [SETTLE] M3.4: Verifying SP Payment Receipt
[HO][INFO][NONE] [SETTLE] ═══════════════════════════════════════════════════
[HO][INFO][NONE] [M3.4-VERIFY] Verifying receipt signature...
[HO][INFO][NONE] [M3.4-VERIFY]   Canonical receipt: receiptId=fe34213f-a253-4eef-b0ff-e48465aaca5f|chainId=6bc5619a-0d52-45fc-80f6-fe4153235fd0|reservationId=ece90d1d-9b7a-4259-b1f5-97f1571e42dc|availabilityId=191001f5-0052-4ce1-ad30-d01579fb3c63|y=5|newLastSpentIndex=5|timestamp=2025-12-24T22:33:36.714413433Z|hoIdentity=HomeOwner
[HO][INFO][NONE] [M3.4-VERIFY]   Signature algorithm: SHA256withRSA
[HO][INFO][NONE] [M3.4-VERIFY] ✓ SP signature verified successfully (RSA-2048, SHA256withRSA)
[HO][INFO][NONE] [M3.4-VERIFY] ✓ Non-repudiation: SP cannot deny issuing this receipt
[HO][INFO][NONE] [M3.4-VERIFY] ✓ Payment finality established
[HO][INFO][NONE] [SETTLE] ✓ Receipt signature verified successfully
[HO][INFO][NONE] [M3.4-PERSIST] ✓ Receipt persisted: /app/keystore/receipts/receipt_fe34213f-a253-4eef-b0ff-e48465aaca5f.json
[HO][INFO][NONE] [M3.4-PERSIST] ✓ Immutable proof of settlement stored
[HO][INFO][NONE] [M3.4-PERSIST] ✓ Available for offline third-party verification
[HO][INFO][NONE] [SETTLE] ✓✓✓ PAYMENT RECEIPT VERIFIED AND PERSISTED ✓✓✓
[HO][INFO][NONE] [SETTLE]   Receipt ID: fe34213f-a253-4eef-b0ff-e48465aaca5f
[HO][INFO][NONE] [SETTLE]   Payment finality established via SP signature
[HO][INFO][NONE] [SETTLE]   Receipt ready for CO forwarding
[HO][INFO][NONE] [PAY] ⚠️  TEST_DOUBLE_SPEND enabled - storing settlement for replay
[HO][INFO][NONE] [PAY] ✓ Payment receipt included in response for CO
[HO][INFO][NONE] [PAY] Payment ACCEPTED. newLastSpentIndex=4
[HO][INFO][NONE] 
Sent pay response:
[HO][INFO][NONE] {
  "startIndex": 0,
  "reservationId": "ece90d1d-9b7a-4259-b1f5-97f1571e42dc",
  "chainId": "6bc5619a-0d52-45fc-80f6-fe4153235fd0",
  "spentCount": 5,
  "newLastSpentIndex": 4,
  "paymentReceipt": {
    "hoIdentity": "HomeOwner",
    "reservationId": "ece90d1d-9b7a-4259-b1f5-97f1571e42dc",
    "signatureAlg": "SHA256withRSA",
    "chainId": "6bc5619a-0d52-45fc-80f6-fe4153235fd0",
    "availabilityId": "191001f5-0052-4ce1-ad30-d01579fb3c63",
    "newLastSpentIndex": 5,
    "spCertFingerprint": "EFE01135BDB60FC06BEF53E7A8B58CC7FC00724291BB7E8C064D2670011E5346",
    "y": 5,
    "receiptId": "fe34213f-a253-4eef-b0ff-e48465aaca5f",
    "canonicalReceipt": "receiptId=fe34213f-a253-4eef-b0ff-e48465aaca5f|chainId=6bc5619a-0d52-45fc-80f6-fe4153235fd0|reservationId=ece90d1d-9b7a-4259-b1f5-97f1571e42dc|availabilityId=191001f5-0052-4ce1-ad30-d01579fb3c63|y=5|newLastSpentIndex=5|timestamp=2025-12-24T22:33:36.714413433Z|hoIdentity=HomeOwner",
    "receiptSignature": "MchmFE3gIosfkmKSAgHleMEP6Xc4IgbOW/aBhCklRnynFJwvb3uH4hRSdhRo97A0mdHz5NsR3yxZUe/VslqfecTPfNc1N3toWK8umh7kIIcwVRPPWrg+qKfHld52K3tAw6htL//l7EmGJ6Y94ByaciJGG9iaUVgYQjJKCJTwKd1UxwBT+2/S0QHPnBCgCI3Rg+Felo6OxG+OAdpmipiS/Eqv8kN4laLThOCn0qfHzPJrjJCDe6qk3s6uCWUtwq+6ImAJaaqwJHm7W76lFU1hdpox4a4mi0d9x8Qmmbns0p/RaqLlhZv8Hu/y9KVeEv/ouzFHs2r0HGyco+l6eqmxmg==",
    "timestamp": "2025-12-24T22:33:36.714413433Z"
  },
  "message": "payment accepted",
  "status": "success",
  "timestamp": "2025-12-24T22:33:36.753416516Z"
}
[HO][INFO][NONE] 
CarOwner disconnected

[HO][INFO][NONE] 
=== Inbound Reservation Request ===
[HO][INFO][NONE] 
║   CO AUTHENTICATED VIA mTLS               ║
[HO][INFO][NONE] CO CN: CarOwner
[HO][INFO][NONE] CO address: /172.20.0.13:55838
[HO][INFO][NONE] CO certificate subject: C=BE,O=Parking System,CN=CarOwner
[HO][INFO][NONE] CO certificate issuer: CN=172.20.0.10,O=Private Parking,C=BE
[HO][INFO][NONE] CO certificate serial: E16365A585488AD2430B4CEFF780C6AB
[HO][INFO][NONE] 
[HO][INFO][NONE] TLS Session Details:
[HO][INFO][NONE]   Protocol: TLSv1.3
[HO][INFO][NONE]   Cipher suite: TLS_AES_256_GCM_SHA384
[HO][INFO][NONE] ═══════════════════════════════════════════

[HO][INFO][NONE] Received request from CarOwner:
[HO][INFO][NONE] {
  "startIndex": 0,
  "method": "pay",
  "reservationId": "ece90d1d-9b7a-4259-b1f5-97f1571e42dc",
  "chainId": "6bc5619a-0d52-45fc-80f6-fe4153235fd0",
  "rootSignature": "H3wapsMSOIzOhwJ/rYsMcctev35T9L4DpJjjzEUk57yd++eZq2quhvULAOaCAOD5HbHKKpkZR+pLsBypO6QACf7zUZVNPafgWk4qUHbe3Qxlq7s85wVDqPMMWnb0hcz2lUogwGd0fC+EgrlFyHNj64R7K8lw7V/DH3x1SfgRsRBcJkqtJigGDl+o4RIKj3UxXhFE4W6p8eCNkCYr2/0xmWbHr1i/BxMcFzYOnKENWVM/qbn6kZXc/RVknPQnZ3fOPAJgUfmBNHzBqhR1ISmhpCZimVVRPUruCmRdd3L0in5YIY+ae+qS1ctwxLpLKqWdAeJ5ElZng3TKWOKfGi2rzg==",
  "root": "cRbaod5Tx6mtONh8eCVxY899QQPPvnZsue+H0Jiwufk=",
  "x": 5,
  "tokensToSpend": [
    "d5PlzzNQOHcJujJxpLxCmnXeuRNPlcxrSuzUyjiAWRs=",
    "Wc+006xwP+DI3lM4hFSbmCbxsSxbgu9vF2wjKSXIjTw=",
    "/9yvmPAeFJ4nKj9lnD9aDisHB5/FjKsOGUfQL/6XPCA=",
    "epNw4Kx1FowkvHO1Pf2vm9zW2MGJLRgF2xht397fnPM=",
    "cRbaod5Tx6mtONh8eCVxY899QQPPvnZsue+H0Jiwufk="
  ]
}
[HO][INFO][NONE] [M3.2] root signature verified via cached SP public key
[HO][INFO][NONE] [M3.2] policy checks passed (reservation verdict OK, token count matches)
[HO][INFO][NONE] [PAY] [M4.2] REPLAY_TEST_MODE: allowing duplicate chain spend (startIndex=0, lastSpentIndex=4)
[HO][INFO][NONE] [PAY] received from CarOwner
[HO][INFO][NONE] [PAY]   reservationId=ece90d1d-9b7a-4259-b1f5-97f1571e42dc
[HO][INFO][NONE] [PAY]   chainId=6bc5619a-0d52-45fc-80f6-fe4153235fd0
[HO][INFO][NONE] [PAY]   tokenCount=5
[HO][INFO][NONE] [PAY]   startIndex=0
[HO][INFO][NONE] [PAY]   x=5
[HO][INFO][NONE] [PAY]   Hash-chain verification: SUCCESS
[HO][INFO][NONE] [SETTLE] ═══════════════════════════════════════════════════
[HO][INFO][NONE] [SETTLE] Preparing Settlement Request to SP
[HO][INFO][NONE] [SETTLE]   chainId: 6bc5619a-0d52-45fc-80f6-fe4153235fd0
[HO][INFO][NONE] [SETTLE]   reservationId: ece90d1d-9b7a-4259-b1f5-97f1571e42dc
[HO][INFO][NONE] [SETTLE]   y (tokens spent): 5
[HO][INFO][NONE] [SETTLE]   newLastSpentIndex: 5
[HO][INFO][NONE] [SETTLE]   x (chain length): 5
[HO][INFO][NONE] [SETTLE] ═══════════════════════════════════════════════════
[HO][INFO][NONE] [SETTLE] ✓ TLS hardening applied (TLS 1.3/1.2, AEAD ciphers only)
[HO][INFO][NONE] [SETTLE] Initiating explicit TLS handshake...
[HO][INFO][NONE] [SETTLE] ✓ TLS handshake completed successfully
[HO][INFO][NONE] [SETTLE]   Protocol: TLSv1.3
[HO][INFO][NONE] [SETTLE]   Cipher Suite: TLS_AES_256_GCM_SHA384
[HO][INFO][NONE] [SETTLE] ✓ SP certificate verified: C=BE,O=Parking System,CN=ServiceProvider
[HO][INFO][NONE] [SETTLE] → Settlement request sent to SP
[HO][ERR][NONE] [SETTLE] ❌❌❌ SP SETTLEMENT REJECTED ❌❌❌
[HO][ERR][NONE] [SETTLE]   Reason: double_spend
[HO][ERR][NONE] [SETTLE]   Message: DOUBLE_SPEND_DETECTED: attempting to reuse already-spent tokens
[HO][ERR][NONE] [SETTLE] ⚠️  DOUBLE_SPEND_DETECTED by SP
[HO][ERR][NONE] [SETTLE]   currentLastSpentIndex: 5
[HO][ERR][NONE] [SETTLE]   rejectedNewIndex: 5
[HO][INFO][NONE] [PAY] Payment REJECTED: SP settlement failed
[HO][INFO][NONE] 
Sent pay response:
[HO][INFO][NONE] {
  "reason": "settlement_failed",
  "message": "Settlement with SP failed - payment not accepted",
  "status": "error"
}
[HO][INFO][NONE] 
CarOwner disconnected

